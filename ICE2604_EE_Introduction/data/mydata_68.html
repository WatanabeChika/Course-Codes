<!DOCTYPE html>
<html>
<head>
<title>AVL_tree</title>
</head>
<body>
<div class="mw-parser-output"><style data-mw-deduplicate="TemplateStyles:r1097763485">.mw-parser-output .ambox{border:1px solid #a2a9b1;border-left:10px solid #36c;background-color:#fbfbfb;box-sizing:border-box}.mw-parser-output .ambox+link+.ambox,.mw-parser-output .ambox+link+style+.ambox,.mw-parser-output .ambox+link+link+.ambox,.mw-parser-output .ambox+.mw-empty-elt+link+.ambox,.mw-parser-output .ambox+.mw-empty-elt+link+style+.ambox,.mw-parser-output .ambox+.mw-empty-elt+link+link+.ambox{margin-top:-1px}html body.mediawiki .mw-parser-output .ambox.mbox-small-left{margin:4px 1em 4px 0;overflow:hidden;width:238px;border-collapse:collapse;font-size:88%;line-height:1.25em}.mw-parser-output .ambox-speedy{border-left:10px solid #b32424;background-color:#fee7e6}.mw-parser-output .ambox-delete{border-left:10px solid #b32424}.mw-parser-output .ambox-content{border-left:10px solid #f28500}.mw-parser-output .ambox-style{border-left:10px solid #fc3}.mw-parser-output .ambox-move{border-left:10px solid #9932cc}.mw-parser-output .ambox-protection{border-left:10px solid #a2a9b1}.mw-parser-output .ambox .mbox-text{border:none;padding:0.25em 0.5em;width:100%}.mw-parser-output .ambox .mbox-image{border:none;padding:2px 0 2px 0.5em;text-align:center}.mw-parser-output .ambox .mbox-imageright{border:none;padding:2px 0.5em 2px 0;text-align:center}.mw-parser-output .ambox .mbox-empty-cell{border:none;padding:0;width:1px}.mw-parser-output .ambox .mbox-image-div{width:52px}html.client-js body.skin-minerva .mw-parser-output .mbox-text-span{margin-left:23px!important}@media(min-width:720px){.mw-parser-output .ambox{margin:0 10%}}</style><table class="box-MOS plainlinks metadata ambox ambox-style ambox-mos" role="presentation"><tbody><tr><td class="mbox-image"></td><td class="mbox-text"></td></tr></tbody></table>

<style data-mw-deduplicate="TemplateStyles:r1066479718">.mw-parser-output .infobox-subbox{padding:0;border:none;margin:-3px;width:auto;min-width:100%;font-size:100%;clear:none;float:none;background-color:transparent}.mw-parser-output .infobox-3cols-child{margin:auto}.mw-parser-output .infobox .navbar{font-size:100%}body.skin-minerva .mw-parser-output .infobox-header,body.skin-minerva .mw-parser-output .infobox-subheader,body.skin-minerva .mw-parser-output .infobox-above,body.skin-minerva .mw-parser-output .infobox-title,body.skin-minerva .mw-parser-output .infobox-image,body.skin-minerva .mw-parser-output .infobox-full-data,body.skin-minerva .mw-parser-output .infobox-below{text-align:center}</style><table class="infobox"><tbody><tr><th class="infobox-above" colspan="2">AVL tree</th></tr><tr><th class="infobox-label" scope="row">Type</th><td class="infobox-data">Tree</td></tr><tr><th class="infobox-label" scope="row">Invented</th><td class="infobox-data">1962</td></tr><tr><th class="infobox-label" scope="row">Invented by</th><td class="infobox-data">Georgy Adelson-Velsky and Evgenii Landis</td></tr><tr><th class="infobox-header" colspan="2">Time complexity in big O notation</th></tr><tr><td class="infobox-full-data" colspan="2"><link href="mw-data:TemplateStyles:r1066479718" rel="mw-deduplicated-inline-style"/><table class="infobox-subbox infobox-3cols-child"><tbody><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Algorithm</th><td class="infobox-data infobox-data-a">
<b>Average</b></td><td class="infobox-data infobox-data-b">
<b>Worst case</b></td></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Space</th><td class="infobox-data infobox-data-a">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{Θ}}(n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>Θ</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{Θ}}(n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{Θ}}(n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/49432031ac47081b3be3dcb7d738f4677a48f934" style="vertical-align: -0.838ex; width:5.012ex; height:2.843ex;"/></span></td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{O}}(n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>O</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{O}}(n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{O}}(n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/702926ecf22593fa2c82e6ba19fcb3d9f3efd6d2" style="vertical-align: -0.838ex; width:5.012ex; height:2.843ex;"/></span></td></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Search</th><td class="infobox-data infobox-data-a">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{Θ}}(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>Θ</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{Θ}}(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{Θ}}(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5e6dac3b64b9665275c8d848c0005ba46bfbd3a3" style="vertical-align: -0.838ex; width:8.371ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-0">[1]</sup></td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{O}}(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>O</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{O}}(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{O}}(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/67697a0b44080bbf967c00d60bf4aac79f9ce385" style="vertical-align: -0.838ex; width:8.371ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-1">[1]</sup></td></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Insert</th><td class="infobox-data infobox-data-a">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{Θ}}(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>Θ</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{Θ}}(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{Θ}}(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5e6dac3b64b9665275c8d848c0005ba46bfbd3a3" style="vertical-align: -0.838ex; width:8.371ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-2">[1]</sup></td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{O}}(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>O</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{O}}(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{O}}(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/67697a0b44080bbf967c00d60bf4aac79f9ce385" style="vertical-align: -0.838ex; width:8.371ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-3">[1]</sup></td></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Delete</th><td class="infobox-data infobox-data-a">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{Θ}}(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>Θ</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{Θ}}(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{Θ}}(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5e6dac3b64b9665275c8d848c0005ba46bfbd3a3" style="vertical-align: -0.838ex; width:8.371ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-4">[1]</sup></td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{O}}(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>O</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{O}}(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{O}}(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/67697a0b44080bbf967c00d60bf4aac79f9ce385" style="vertical-align: -0.838ex; width:8.371ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-5">[1]</sup></td></tr></tbody></table></td></tr></tbody></table>


<p>In computer science, an <b>AVL tree</b> (named after inventors <b>A</b>delson-<b>V</b>elsky and <b>L</b>andis) is a self-balancing binary search tree. It was the first such data structure to be invented.<sup class="reference" id="cite_ref-2">[2]</sup> In an AVL tree, the heights of the two child subtrees of any node differ by at most one; if at any time they differ by more than one, rebalancing is done to restore this property. Lookup, insertion, and deletion all take <span class="texhtml">O(log <i>n</i>)</span> time in both the average and worst cases, where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> is the number of nodes in the tree prior to the operation. Insertions and deletions may require the tree to be rebalanced by one or more tree rotations.
</p><p>The AVL tree is named after its two Soviet inventors, Georgy Adelson-Velsky and Evgenii Landis, who published it in their 1962 paper "An algorithm for the organization of information".<sup class="reference" id="cite_ref-3">[3]</sup>
</p><p>AVL trees are often compared with red–black trees because both support the same set of operations and take <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{O}}(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>O</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{O}}(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{O}}(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/67697a0b44080bbf967c00d60bf4aac79f9ce385" style="vertical-align: -0.838ex; width:8.371ex; height:2.843ex;"/></span> time for the basic operations. For lookup-intensive applications, AVL trees are faster than red–black trees because they are more strictly balanced.<sup class="reference" id="cite_ref-Pfaff1_4-0">[4]</sup> Similar to red–black trees, AVL trees are height-balanced. Both are, in general, neither weight-balanced nor <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \mu }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>μ<!-- μ --></mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
</semantics>
</math></span><img alt="\mu " aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;"/></span>-balanced for any <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \mu \leq {\tfrac {1}{2}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>μ<!-- μ --></mi>
<mo>≤<!-- ≤ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mn>1</mn>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \mu \leq {\tfrac {1}{2}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \mu \leq {\tfrac {1}{2}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2e5641d5a805f727ffe5bb450abd59582f57b729" style="vertical-align: -1.171ex; width:6.158ex; height:3.509ex;"/></span>;<sup class="reference" id="cite_ref-5">[5]</sup> that is, sibling nodes can have hugely differing numbers of descendants.
</p>

<h2><span class="mw-headline" id="Definition">Definition</span><span class="mw-editsection"></span></h2>
<h3><span class="mw-headline" id="Balance_factor">Balance factor</span><span class="mw-editsection"></span></h3>
<p>In a binary tree the <i>balance factor</i> of a node X is defined to be the height difference
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{BF}}(X):={\text{Height}}({\text{RightSubtree}}(X))-{\text{Height}}({\text{LeftSubtree}}(X))}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>BF</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>X</mi>
<mo stretchy="false">)</mo>
<mo>:=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mtext>Height</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mtext>RightSubtree</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>X</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">)</mo>
<mo>−<!-- − --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mtext>Height</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mtext>LeftSubtree</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>X</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{BF}}(X):={\text{Height}}({\text{RightSubtree}}(X))-{\text{Height}}({\text{LeftSubtree}}(X))}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{BF}}(X):={\text{Height}}({\text{RightSubtree}}(X))-{\text{Height}}({\text{LeftSubtree}}(X))}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ecc2a8ba2cb5c14abf4d0cb0ffee1f09b2f515fa" style="vertical-align: -0.838ex; width:63.635ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-Knuth_6-0">[6]</sup><sup class="reference nowrap"><span title="Page / location: 459">: 459 </span></sup></dd></dl>
<p>of its two child sub-trees. A binary tree is defined to be an <i>AVL tree</i> if the invariant
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{BF}}(X)\in {\{-1,0,1\}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>BF</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>X</mi>
<mo stretchy="false">)</mo>
<mo>∈<!-- ∈ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">{</mo>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo>,</mo>
<mn>0</mn>
<mo>,</mo>
<mn>1</mn>
<mo fence="false" stretchy="false">}</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{BF}}(X)\in {\{-1,0,1\}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{BF}}(X)\in {\{-1,0,1\}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f6b21012e9c7ec87fac3673a5a3c82cf74376458" style="vertical-align: -0.838ex; width:19.482ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-7">[7]</sup></dd></dl>
<p>holds for every node X in the tree.
</p><p>A node X with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{BF}}(X)&lt;0}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>BF</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>X</mi>
<mo stretchy="false">)</mo>
<mo>&lt;</mo>
<mn>0</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{BF}}(X)&lt;0}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{BF}}(X)&lt;0}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/71c90ed04a884f420ade0813e54cf9198eea1ed4" style="vertical-align: -0.838ex; width:11.214ex; height:2.843ex;"/></span> is called "left-heavy", one with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{BF}}(X)&gt;0}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>BF</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>X</mi>
<mo stretchy="false">)</mo>
<mo>&gt;</mo>
<mn>0</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{BF}}(X)&gt;0}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{BF}}(X)&gt;0}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c734f86938f93a517d974cb08080deabfba4f090" style="vertical-align: -0.838ex; width:11.214ex; height:2.843ex;"/></span> is called "right-heavy", and one with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{BF}}(X)=0}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>BF</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>X</mi>
<mo stretchy="false">)</mo>
<mo>=</mo>
<mn>0</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{BF}}(X)=0}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{BF}}(X)=0}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/490d6a1c82801a264f9a81da99919572d6310435" style="vertical-align: -0.838ex; width:11.214ex; height:2.843ex;"/></span> is sometimes simply called "balanced".
</p>
<h3><span class="mw-headline" id="Properties">Properties</span><span class="mw-editsection"></span></h3>
<p>Balance factors can be kept up-to-date by knowing the previous balance factors and the change in height – it is not necessary to know the absolute height. For holding the AVL balance information, two bits per node are sufficient.<sup class="reference" id="cite_ref-8">[8]</sup>
</p><p>The height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> (counted as the maximal number of levels) of an AVL tree with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> nodes lies in the interval:<sup class="reference" id="cite_ref-Knuth_6-1">[6]</sup><sup class="reference nowrap"><span title="Page / location: 460">: 460 </span></sup>
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \log _{2}(n+1)\leq h&lt;\log _{\varphi }(n+2)+b}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mo>≤<!-- ≤ --></mo>
<mi>h</mi>
<mo>&lt;</mo>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>φ<!-- φ --></mi>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mn>2</mn>
<mo stretchy="false">)</mo>
<mo>+</mo>
<mi>b</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \log _{2}(n+1)\leq h&lt;\log _{\varphi }(n+2)+b}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \log _{2}(n+1)\leq h&lt;\log _{\varphi }(n+2)+b}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2fd9a7db05780c8576235500834aa15b0d341dfd" style="vertical-align: -1.171ex; width:34.092ex; height:3.176ex;"/></span></dd></dl>
<p>where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \varphi :={\tfrac {1+{\sqrt {5}}}{2}}\approx 1.618}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>φ<!-- φ --></mi>
<mo>:=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mrow>
<mn>1</mn>
<mo>+</mo>
<mrow class="MJX-TeXAtom-ORD">
<msqrt>
<mn>5</mn>
</msqrt>
</mrow>
</mrow>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
<mo>≈<!-- ≈ --></mo>
<mn>1.618</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \varphi :={\tfrac {1+{\sqrt {5}}}{2}}\approx 1.618}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \varphi :={\tfrac {1+{\sqrt {5}}}{2}}\approx 1.618}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/48d4e4826360b780d733e8a0fa97caf8452423a4" style="vertical-align: -1.171ex; width:18.788ex; height:4.176ex;"/></span>  is the golden ratio and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle b:={\frac {\log _{2}5}{2\log _{2}\varphi }}-2\approx \;-0.3277.}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>b</mi>
<mo>:=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mfrac>
<mrow>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mn>5</mn>
</mrow>
<mrow>
<mn>2</mn>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mi>φ<!-- φ --></mi>
</mrow>
</mfrac>
</mrow>
<mo>−<!-- − --></mo>
<mn>2</mn>
<mo>≈<!-- ≈ --></mo>
<mspace width="thickmathspace"></mspace>
<mo>−<!-- − --></mo>
<mn>0.3277.</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle b:={\frac {\log _{2}5}{2\log _{2}\varphi }}-2\approx \;-0.3277.}</annotation>
</semantics>
</math></span><img alt="{\displaystyle b:={\frac {\log _{2}5}{2\log _{2}\varphi }}-2\approx \;-0.3277.}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6a2f6b70e5bdce693c11fc1adeaa86e37b87373f" style="vertical-align: -2.505ex; width:29.722ex; height:6.176ex;"/></span>
This is because an AVL tree of height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> contains at least <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle F_{h}-1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>F</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
</mrow>
</msub>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle F_{h}-1}</annotation>
</semantics>
</math></span><img alt="{\displaystyle F_{h}-1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3501751499e3cb1efe0101cd7764eec5cac37bfd" style="vertical-align: -0.671ex; width:6.676ex; height:2.509ex;"/></span> nodes where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \{F_{n}\}_{n\in \mathbb {N} }}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo fence="false" stretchy="false">{</mo>
<msub>
<mi>F</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
</mrow>
</msub>
<msub>
<mo fence="false" stretchy="false">}</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>∈<!-- ∈ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="double-struck">N</mi>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \{F_{n}\}_{n\in \mathbb {N} }}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \{F_{n}\}_{n\in \mathbb {N} }}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5d4c26770bdfae8e3102d1f96418c4d2380070ee" style="vertical-align: -0.838ex; width:8.539ex; height:2.843ex;"/></span> is the Fibonacci sequence with the seed values <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle F_{1}=F_{2}=1.}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>F</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>=</mo>
<msub>
<mi>F</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>=</mo>
<mn>1.</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle F_{1}=F_{2}=1.}</annotation>
</semantics>
</math></span><img alt="{\displaystyle F_{1}=F_{2}=1.}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/12fe8fa5eea968e7d0e72ec5e604074aca6215f6" style="vertical-align: -0.671ex; width:13.104ex; height:2.509ex;"/></span>
</p>
<h2><span class="mw-headline" id="Operations">Operations</span><span class="mw-editsection"></span></h2>
<p>Read-only operations of an AVL tree involve carrying out the same actions as would be carried out on an unbalanced binary search tree, but modifications have to observe and restore the height balance of the sub-trees.
</p>
<h3><span class="mw-headline" id="Searching">Searching</span><span class="mw-editsection"></span></h3>
<p>Searching for a specific key in an AVL tree can be done the same way as that of any balanced or unbalanced binary search tree.<sup class="reference" id="cite_ref-dixit-mastering-data-structures_9-0">[9]</sup><sup class="reference nowrap"><span title="Page / location: ch. 8">: ch. 8 </span></sup> In order for search to work effectively it has to employ a comparison function which establishes a total order (or at least a total preorder) on the set of keys.<sup class="reference" id="cite_ref-brass-advanced-data-structures_10-0">[10]</sup><sup class="reference nowrap"><span title="Page / location: 23">: 23 </span></sup> The number of comparisons required for successful search is limited by the height <span class="texhtml"><i>h</i></span> and for unsuccessful search is very close to <span class="texhtml"><i>h</i></span>, so both are in <span class="texhtml">O(log <i>n</i>)</span>.<sup class="reference" id="cite_ref-hubbard-outline-theory-problems_11-0">[11]</sup><sup class="reference nowrap"><span title="Page / location: 216">: 216 </span></sup>
</p>
<h3><span class="mw-headline" id="Traversal">Traversal</span><span class="mw-editsection"></span></h3>
<p>As a read-only operation the traversal of an AVL tree functions the same way as on any other binary tree. Exploring all <span class="texhtml"><i>n</i></span> nodes of the tree visits each link exactly twice: one downward visit to enter the subtree rooted by that node, another visit upward to leave that node's subtree after having explored it.
</p><p>Once a node has been found in an AVL tree, the <i>next</i> or <i>previous</i> node can be accessed in amortized constant time.<sup class="reference" id="cite_ref-Pfaff_12-0">[12]</sup><sup class="reference nowrap"><span title="Page / location: 58">: 58 </span></sup> Some instances of exploring these "nearby" nodes require traversing up to <span class="texhtml"><i>h</i> ∝ log(<i>n</i>)</span> links (particularly when navigating from the rightmost leaf of the root's left subtree to the root or from the root to the leftmost leaf of the root's right subtree; in the AVL tree of figure 1, navigating from node P to the next-to-the-right node Q takes 3 steps). Since there are <span class="texhtml"><i>n</i>−1</span> links in any tree, the amortized cost is <span class="texhtml">2×(<i>n</i>−1)/<i>n</i></span>, or approximately 2.
</p>
<h3><span class="mw-headline" id="Insert">Insert</span><span class="mw-editsection"></span></h3>
<p>When inserting a node into an AVL tree, you initially follow the same process as inserting into a Binary Search Tree. If the tree is empty, then the node is inserted as the root of the tree. If the tree is not empty, then we go down the root, and recursively go down the tree searching for the location to insert the new node. This traversal is guided by the comparison function. In this case, the node always replaces a NULL reference (left or right) of an external node in the tree i.e., the node is either made a left-child or a right-child of the external node.
</p><p>After this insertion, if a tree becomes unbalanced, only ancestors of the newly inserted node are unbalanced. This is because only those nodes have their sub-trees altered.<sup class="reference" id="cite_ref-13">[13]</sup> So it is necessary to check each of the node's ancestors for consistency with the invariants of AVL trees: this is called "retracing". This is achieved by considering the balance factor of each node.<sup class="reference" id="cite_ref-Knuth_6-2">[6]</sup><sup class="reference nowrap"><span title="Page / location: 458–481">: 458–481 </span></sup> <sup class="reference" id="cite_ref-Pfaff_12-1">[12]</sup><sup class="reference nowrap"><span title="Page / location: 108">: 108 </span></sup>
</p><p>Since with a single insertion the height of an AVL subtree cannot increase by more than one, the temporary balance factor of a node after an insertion will be in the range <span class="nowrap">[–2,+2].</span> For each node checked, if the temporary balance factor remains in the range from –1 to +1 then only an update of the balance factor and no rotation is necessary. However, if the temporary balance factor is ±2, the subtree rooted at this node is AVL unbalanced, and a rotation is needed.<sup class="reference" id="cite_ref-brass-advanced-data-structures_10-1">[10]</sup><sup class="reference nowrap"><span title="Page / location: 52">: 52 </span></sup> With insertion as the code below shows, the adequate rotation immediately perfectly rebalances the tree.
</p><p>In figure 1, by inserting the new node Z as a child of node X the height of that subtree Z increases from 0 to 1.
</p>
<dl><dt>Invariant of the retracing loop for an insertion</dt></dl>
<p>The height of the subtree rooted by Z has increased by 1. It is already in AVL shape.
</p>

<p>In order to update the balance factors of all nodes, first observe that all nodes requiring correction lie from child to parent along the path of the inserted leaf. If the above procedure is applied to nodes along this path, starting from the leaf, then every node in the tree will again have a balance factor of −1, 0, or 1.
</p><p>The retracing can stop if the balance factor becomes 0 implying that the height of that subtree remains unchanged.
</p><p>If the balance factor becomes ±1 then the height of the subtree increases by one and the retracing needs to continue.
</p><p>If the balance factor temporarily becomes ±2, this has to be repaired by an appropriate rotation after which the subtree has the same height as before (and its root the balance factor 0).
</p><p>The time required is <span class="texhtml">O(log <i>n</i>)</span> for lookup, plus a maximum of <span class="texhtml">O(log <i>n</i>)</span> retracing levels (<span class="texhtml">O(1)</span> on average) on the way back to the root, so the operation can be completed in <span class="texhtml">O(log <i>n</i>)</span> time.<sup class="reference" id="cite_ref-brass-advanced-data-structures_10-2">[10]</sup><sup class="reference nowrap"><span title="Page / location: 53">: 53 </span></sup>
</p>
<h3><span class="mw-headline" id="Delete">Delete</span><span class="mw-editsection"></span></h3>
<p>The preliminary steps for deleting a node are described in section Binary search tree#Deletion.
There, the effective deletion of the subject node or the replacement node decreases the height of the corresponding child tree either from 1 to 0 or from 2 to 1, if that node had a child.
</p><p>Starting at this subtree, it is necessary to check each of the ancestors for consistency with the invariants of AVL trees. This is called "retracing".
</p><p>Since with a single deletion the height of an AVL subtree cannot decrease by more than one, the temporary balance factor of a node will be in the range from −2 to +2.
If the balance factor remains in the range from −1 to +1 it can be adjusted in accord with the AVL rules. If it becomes ±2 then the subtree is unbalanced and needs to be rotated. (Unlike insertion where a rotation always balances the tree, after delete, there may be BF(Z) ≠ 0 (see figures 2 and 3), so that after the appropriate single or double rotation the height of the rebalanced subtree decreases by one meaning that the tree has to be rebalanced again on the next higher level.) The various cases of rotations are described in section Rebalancing.
</p>
<dl><dt>Invariant of the retracing loop for a deletion</dt></dl>
<p>The height of the subtree rooted by N has decreased by 1. It is already in AVL shape.
</p>

<p>The retracing can stop if the balance factor becomes ±1 (it must have been 0) meaning that the height of that subtree remains unchanged.
</p><p>If the balance factor becomes 0 (it must have been ±1) then the height of the subtree decreases by one and the retracing needs to continue.
</p><p>If the balance factor temporarily becomes ±2, this has to be repaired by an appropriate rotation. It depends on the balance factor of the sibling Z (the higher child tree in figure 2) whether the height of the subtree decreases by one –and the retracing needs to continue– or does not change (if Z has the balance factor 0) and the whole tree is in AVL-shape.
</p><p>The time required is <span class="texhtml">O(log <i>n</i>)</span> for lookup, plus a maximum of <span class="texhtml">O(log <i>n</i>)</span> retracing levels (<span class="texhtml">O(1)</span> on average) on the way back to the root, so the operation can be completed in <span class="texhtml">O(log <i>n</i>)</span> time.
</p>
<h3><span class="mw-headline" id="Set_operations_and_bulk_operations">Set operations and bulk operations</span><span class="mw-editsection"></span></h3>
<p>In addition to the single-element insert, delete and lookup operations, several set operations have been defined on AVL trees: union, intersection and set difference. Then fast <i>bulk</i> operations on insertions or deletions can be implemented based on these set functions. These set operations rely on two helper operations, <i>Split</i> and <i>Join</i>. With the new operations, the implementation of AVL trees can be more efficient and highly-parallelizable.<sup class="reference" id="cite_ref-join-based_14-0">[14]</sup>
</p><p>The function <i>Join</i> on two AVL trees <span class="texhtml"><i>t</i><sub>1</sub></span> and <span class="texhtml"><i>t</i><sub>2</sub></span> and a key <span class="texhtml mvar" style="font-style:italic;">k</span> will return a tree containing all elements in <span class="texhtml"><i>t</i><sub>1</sub></span>, <span class="texhtml"><i>t</i><sub>2</sub></span> as well as <span class="texhtml mvar" style="font-style:italic;">k</span>. It requires <span class="texhtml mvar" style="font-style:italic;">k</span> to be greater than all keys in <span class="texhtml"><i>t</i><sub>1</sub></span> and smaller than all keys in <span class="texhtml"><i>t</i><sub>2</sub></span>. If the two trees differ by height at most one, <i>Join</i> simply create a new node with left subtree <span class="texhtml"><i>t</i><sub>1</sub></span>, root <span class="texhtml mvar" style="font-style:italic;">k</span> and right subtree <span class="texhtml"><i>t</i><sub>2</sub></span>. Otherwise, suppose that <span class="texhtml"><i>t</i><sub>1</sub></span> is higher than <span class="texhtml"><i>t</i><sub>2</sub></span> for more than one (the other case is symmetric). <i>Join</i> follows the right spine of <span class="texhtml"><i>t</i><sub>1</sub></span> until a node <span class="texhtml mvar" style="font-style:italic;">c</span> which is balanced with <span class="texhtml"><i>t</i><sub>2</sub></span>. At this point a new node with left child <span class="texhtml mvar" style="font-style:italic;">c</span>, root <span class="texhtml mvar" style="font-style:italic;">k</span> and right child <span class="texhtml"><i>t</i><sub>2</sub></span> is created to replace c. The new node satisfies the AVL invariant, and its height is one greater than <span class="texhtml mvar" style="font-style:italic;">c</span>. The increase in height can increase the height of its ancestors, possibly invalidating the AVL invariant of those nodes. This can be fixed either with a double rotation if invalid at the parent or a single left rotation if invalid higher in the tree, in both cases restoring the height for any further ancestor nodes. <i>Join</i> will therefore require at most two rotations. The cost of this function is the difference of the heights between the two input trees.
</p>

<p>To split an AVL tree into two smaller trees, those smaller than key <span class="texhtml mvar" style="font-style:italic;">k</span>, and those larger than key <span class="texhtml mvar" style="font-style:italic;">k</span>, first draw a path from the root by inserting <span class="texhtml mvar" style="font-style:italic;">k</span> into the AVL. After this insertion, all values less than <span class="texhtml mvar" style="font-style:italic;">k</span> will be found on the left of the path, and all values greater than <span class="texhtml mvar" style="font-style:italic;">k</span> will be found on the right. By applying <i>Join</i>, all the subtrees on the left side are merged bottom-up using keys on the path as intermediate nodes from bottom to top to form the left tree, and the right part is asymmetric. The cost of <i>Split</i> is <span class="texhtml">O(log <i>n</i>)</span>, order of the height of the tree.
</p>

<p>The union of two AVL trees <span class="texhtml"><i>t</i><sub>1</sub></span> and <span class="texhtml"><i>t</i><sub>2</sub></span> representing sets <span class="texhtml mvar" style="font-style:italic;">A</span> and <span class="texhtml mvar" style="font-style:italic;">B</span>, is an AVL <span class="texhtml mvar" style="font-style:italic;"><i>t</i></span> that represents <span class="texhtml"><i>A</i> ∪ <i>B</i></span>.
</p>

<p>The algorithm for intersection or difference is similar, but requires the <i>Join2</i> helper routine that is the same as <i>Join</i> but without the middle key. Based on the new functions for union, intersection or difference, either one key or multiple keys can be inserted to or deleted from the AVL tree. Since <i>Split</i> calls <i>Join</i> but does not deal with the balancing criteria of AVL trees directly, such an implementation is usually called the "join-based" implementation.
</p><p>The complexity of each of union, intersection and difference is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{O}}\left(m\log \left({n \over m}+1\right)\right)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>O</mtext>
</mrow>
<mrow>
<mo>(</mo>
<mrow>
<mi>m</mi>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow class="MJX-TeXAtom-ORD">
<mfrac>
<mi>n</mi>
<mi>m</mi>
</mfrac>
</mrow>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{O}}\left(m\log \left({n \over m}+1\right)\right)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{O}}\left(m\log \left({n \over m}+1\right)\right)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/28e1b08290893e7c422b3c1f9fd947d702537019" style="vertical-align: -1.838ex; width:20.025ex; height:4.843ex;"/></span> for AVL trees of sizes <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>m</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m}</annotation>
</semantics>
</math></span><img alt="m" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0a07d98bb302f3856cbabc47b2b9016692e3f7bc" style="vertical-align: -0.338ex; width:2.04ex; height:1.676ex;"/></span> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n\;(\geq m)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
<mspace width="thickmathspace"></mspace>
<mo stretchy="false">(</mo>
<mo>≥<!-- ≥ --></mo>
<mi>m</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n\;(\geq m)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle n\;(\geq m)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3a50642fb35bf03f2b430fa54c5a3838978b45f1" style="vertical-align: -0.838ex; width:8.343ex; height:2.843ex;"/></span>. More importantly, since the recursive calls to union, intersection or difference are independent of each other, they can be executed in parallel with a parallel depth <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{O}}(\log m\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>O</mtext>
</mrow>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>m</mi>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{O}}(\log m\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{O}}(\log m\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f671b33d469696e8cc69445987eeedce0f5dff21" style="vertical-align: -0.838ex; width:14.157ex; height:2.843ex;"/></span>.<sup class="reference" id="cite_ref-join-based_14-1">[14]</sup> When <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m=1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>m</mi>
<mo>=</mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m=1}</annotation>
</semantics>
</math></span><img alt="m=1" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b6100c5ebd48c6fd848709f2be624465203eb173" style="vertical-align: -0.338ex; width:6.301ex; height:2.176ex;"/></span>, the join-based implementation has the same computational DAG as single-element insertion and deletion.
</p>
<h2><span class="mw-headline" id="Rebalancing">Rebalancing</span><span class="mw-editsection"></span></h2>
<p>If during a modifying operation the height difference between two child subtrees changes, this may, as long as it is &lt; 2, be reflected by an adaption of the balance information at the parent. During insert and delete operations a (temporary) height difference of 2 may arise, which means that the parent subtree has to be "rebalanced". The given repair tools are the so-called tree rotations, because they move the keys only "vertically", so that the ("horizontal") in-order sequence of the keys is fully preserved (which is essential for a binary-search tree).<sup class="reference" id="cite_ref-Knuth_6-3">[6]</sup><sup class="reference nowrap"><span title="Page / location: 458–481">: 458–481 </span></sup> <sup class="reference" id="cite_ref-Pfaff_12-2">[12]</sup><sup class="reference nowrap"><span title="Page / location: 33">: 33 </span></sup>
</p><p>Let X be the node that has a (temporary) balance factor of −2 or +2. Its left or right subtree was modified. Let Z be the higher child (see figures 2 and 3). Note that both children are in AVL shape by induction hypothesis.
</p><p>In case of insertion this insertion has happened to one of Z's children in a way that Z's height has increased.
In case of deletion this deletion has happened to the sibling t<sub>1</sub> of Z in a way so that t<sub>1</sub>'s height being already lower has decreased. (This is the only case where Z's balance factor may also be 0.)
</p><p>There are four possible variants of the violation:
</p>
<table>
<tbody><tr>
<td style="width:1em"></td>
<td>Right Right</td>
<td>⟹ Z is a <i>right</i></td>
<td>child of its parent X and BF(Z) ≥ 0
</td></tr>
<tr>
<td></td>
<td>Left Left</td>
<td>⟹ Z is a <i>left</i></td>
<td>child of its parent X and BF(Z) ≤ 0
</td></tr>
<tr>
<td></td>
<td>Right Left</td>
<td>⟹ Z is a <i>right</i></td>
<td>child of its parent X and BF(Z) &lt; 0
</td></tr>
<tr>
<td></td>
<td>Left Right</td>
<td>⟹ Z is a <i>left</i></td>
<td>child of its parent X and BF(Z) &gt; 0
</td></tr></tbody></table>
<p>And the rebalancing is performed differently:
</p>
<table>
<tbody><tr>
<td style="width:1em"></td>
<td>Right Right</td>
<td>⟹ X is rebalanced with a</td>
<td>simple</td>
<td>rotation <code>rotate_Left</code></td>
<td>(see figure 2)
</td></tr>
<tr>
<td></td>
<td>Left Left</td>
<td>⟹ X is rebalanced with a</td>
<td>simple</td>
<td>rotation <code>rotate_Right</code></td>
<td>(mirror-image of figure 2)
</td></tr>
<tr>
<td></td>
<td>Right Left</td>
<td>⟹ X is rebalanced with a</td>
<td>double</td>
<td>rotation <code>rotate_RightLeft</code></td>
<td>(see figure 3)
</td></tr>
<tr>
<td></td>
<td>Left Right</td>
<td>⟹ X is rebalanced with a</td>
<td>double</td>
<td>rotation <code>rotate_LeftRight</code></td>
<td>(mirror-image of figure 3)
</td></tr></tbody></table>
<p>Thereby, the situations are denoted as <span class="nowrap"><i>C B</i>,</span> where <i>C</i> (= child direction) and <i>B</i> (= balance) come from the set <span class="nowrap">{ <i>Left</i>, <i>Right</i> </span>} with <span class="nowrap"><i>Right</i> := −<i>Left</i>.</span> The balance violation of case <span class="nowrap"><i>C</i> == <i>B</i></span> is repaired by a simple rotation <span class="nowrap"><code>rotate_</code>(−<i>C</i>),</span> whereas the case <span class="nowrap"><i>C</i> != <i>B</i></span> is repaired by a double rotation <span class="nowrap"><code>rotate_</code><i>CB</i>.</span>
</p><p>The cost of a rotation, either simple or double, is constant.
</p>
<h3><span class="mw-headline" id="Simple_rotation">Simple rotation</span><span class="mw-editsection"></span></h3>
<p>Figure 2 shows a Right Right situation. In its upper half, node X has two child trees with a balance factor of <span style="color:#FF0000;">+2</span>. Moreover, the inner child t<sub>23</sub> of Z (i.e., left child when Z is right child resp. right child when Z is left child) is not higher than its sibling t<sub>4</sub>. This can happen by a height increase of subtree t<sub>4</sub> or by a height decrease of subtree t<sub>1</sub>. In the latter case, also the pale situation where t<sub>23</sub> has the same height as t<sub>4</sub> may occur.
</p><p>The result of the left rotation is shown in the lower half of the figure. Three links (thick edges in figure 2) and two balance factors are to be updated.
</p><p>As the figure shows, before an insertion, the leaf layer was at level h+1, temporarily at level h+2 and after the rotation again at level h+1. In case of a deletion, the leaf layer was at level h+2, where it is again, when t<sub>23</sub> and t<sub>4</sub> were of same height. Otherwise the leaf layer reaches level h+1, so that the height of the rotated tree decreases.
</p>

<dl><dt>Code snippet of a simple left rotation</dt></dl>
<table>
<tbody><tr>
<td style="width:4em;">Input:</td>
<td>X = root of subtree to be rotated left
</td></tr>
<tr>
<td></td>
<td>Z = right child of X, Z is right-heavy
</td></tr>
<tr>
<td></td>
<td>    with height == <span class="texhtml">Height(LeftSubtree(</span>X<span class="texhtml">))+2</span>
</td></tr>
<tr>
<td>Result:</td>
<td>new root of rebalanced subtree
</td></tr></tbody></table>

<h3><span class="mw-headline" id="Double_rotation">Double rotation</span><span class="mw-editsection"></span></h3>
<p>Figure 3 shows a Right Left situation. In its upper third, node X has two child trees with a balance factor of <span style="color:#FF0000;">+2</span>. But unlike figure 2, the inner child Y of Z is higher than its sibling t<sub>4</sub>. This can happen by the insertion of Y itself or a height increase of one of its subtrees t<sub>2</sub> or t<sub>3</sub> (with the consequence that they are of different height) or by a height decrease of subtree t<sub>1</sub>. In the latter case, it may also occur that t<sub>2</sub> and t<sub>3</sub> are of the same height.
</p><p>The result of the first, the right, rotation is shown in the middle third of the figure. (With respect to the balance factors, this rotation is not of the same kind as the other AVL single rotations, because the height difference between Y and t<sub>4</sub> is only 1.) The result of the final left rotation is shown in the lower third of the figure. Five links (thick edges in figure 3) and three balance factors are to be updated.
</p><p>As the figure shows, before an insertion, the leaf layer was at level h+1, temporarily at level h+2 and after the double rotation again at level h+1. In case of a deletion, the leaf layer was at level h+2 and after the double rotation it is at level h+1, so that the height of the rotated tree decreases.
</p>

<dl><dt>Code snippet of a right-left double rotation</dt></dl>
<table>
<tbody><tr>
<td style="width:4em;">Input:</td>
<td>X = root of subtree to be rotated
</td></tr>
<tr>
<td></td>
<td>Z = its right child, left-heavy
</td></tr>
<tr>
<td></td>
<td>    with height == <span class="texhtml">Height(LeftSubtree(</span>X<span class="texhtml">))+2</span>
</td></tr>
<tr>
<td>Result:</td>
<td>new root of rebalanced subtree
</td></tr></tbody></table>

<h2><span class="mw-headline" id="Comparison_to_other_structures">Comparison to other structures</span><span class="mw-editsection"></span></h2>
<p>Both AVL trees and red–black (RB) trees are self-balancing binary search trees and they are related mathematically. Indeed, every AVL tree can be colored red–black,<sup class="reference" id="cite_ref-15">[15]</sup> but there are RB trees which are not AVL balanced. For maintaining the AVL resp. RB tree's invariants, rotations play an important role. In the worst case, even without rotations, AVL or RB insertions or deletions require <span class="texhtml">O(log <i>n</i>)</span> inspections and/or updates to AVL balance factors resp. RB colors. RB insertions and deletions and AVL insertions require from zero to three tail-recursive rotations and run in amortized <span class="texhtml">O(1)</span> time,<sup class="reference" id="cite_ref-16">[16]</sup><sup class="reference nowrap"><span title="Page / location: pp.165, 158">: pp.165, 158 </span></sup> <sup class="reference" id="cite_ref-Dinesh_17-0">[17]</sup> thus equally constant on average. AVL deletions requiring <span class="texhtml">O(log <i>n</i>)</span> rotations in the worst case are also <span class="texhtml">O(1)</span> on average. RB trees require storing one bit of information (the color) in each node, while AVL trees mostly use two bits for the balance factor, although, when stored at the children, one bit with meaning «lower than sibling» suffices. The bigger difference between the two data structures is their height limit.
</p><p>For a tree of size <span class="texhtml"><i>n</i> ≥ 1</span>
</p>
<ul><li>an AVL tree's height is at most
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\begin{array}{ll}h&amp;\leqq \;c\log _{2}(n+d)+b\\&amp;&lt;\;c\log _{2}(n+2)+b\end{array}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtable columnalign="left left" columnspacing="1em" rowspacing="4pt">
<mtr>
<mtd>
<mi>h</mi>
</mtd>
<mtd>
<mo>≦<!-- ≦ --></mo>
<mspace width="thickmathspace"></mspace>
<mi>c</mi>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mi>d</mi>
<mo stretchy="false">)</mo>
<mo>+</mo>
<mi>b</mi>
</mtd>
</mtr>
<mtr>
<mtd></mtd>
<mtd>
<mo>&lt;</mo>
<mspace width="thickmathspace"></mspace>
<mi>c</mi>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mn>2</mn>
<mo stretchy="false">)</mo>
<mo>+</mo>
<mi>b</mi>
</mtd>
</mtr>
</mtable>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\begin{array}{ll}h&amp;\leqq \;c\log _{2}(n+d)+b\\&amp;&lt;\;c\log _{2}(n+2)+b\end{array}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\begin{array}{ll}h&amp;\leqq \;c\log _{2}(n+d)+b\\&amp;&lt;\;c\log _{2}(n+2)+b\end{array}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/09edfe84ed94719e98bad3af597203ffc1803f77" style="vertical-align: -2.505ex; width:24.03ex; height:6.176ex;"/></span></dd></dl></li></ul>
<dl><dd>where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \varphi :={\tfrac {1+{\sqrt {5}}}{2}}\approx 1.618}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>φ<!-- φ --></mi>
<mo>:=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mrow>
<mn>1</mn>
<mo>+</mo>
<mrow class="MJX-TeXAtom-ORD">
<msqrt>
<mn>5</mn>
</msqrt>
</mrow>
</mrow>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
<mo>≈<!-- ≈ --></mo>
<mn>1.618</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \varphi :={\tfrac {1+{\sqrt {5}}}{2}}\approx 1.618}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \varphi :={\tfrac {1+{\sqrt {5}}}{2}}\approx 1.618}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/48d4e4826360b780d733e8a0fa97caf8452423a4" style="vertical-align: -1.171ex; width:18.788ex; height:4.176ex;"/></span>  the golden ratio, <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle c:={\tfrac {1}{\log _{2}\varphi }}\approx 1.440,}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>c</mi>
<mo>:=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mn>1</mn>
<mrow>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mi>φ<!-- φ --></mi>
</mrow>
</mfrac>
</mstyle>
</mrow>
<mo>≈<!-- ≈ --></mo>
<mn>1.440</mn>
<mo>,</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle c:={\tfrac {1}{\log _{2}\varphi }}\approx 1.440,}</annotation>
</semantics>
</math></span><img alt="{\displaystyle c:={\tfrac {1}{\log _{2}\varphi }}\approx 1.440,}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f957081e84565e9d8dd4862c0a6749c4ac7304cf" style="vertical-align: -1.671ex; width:19.025ex; height:4.009ex;"/></span>   <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle b:={\tfrac {c}{2}}\log _{2}5-2\approx \;-0.328,}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>b</mi>
<mo>:=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mi>c</mi>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mn>5</mn>
<mo>−<!-- − --></mo>
<mn>2</mn>
<mo>≈<!-- ≈ --></mo>
<mspace width="thickmathspace"></mspace>
<mo>−<!-- − --></mo>
<mn>0.328</mn>
<mo>,</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle b:={\tfrac {c}{2}}\log _{2}5-2\approx \;-0.328,}</annotation>
</semantics>
</math></span><img alt="{\displaystyle b:={\tfrac {c}{2}}\log _{2}5-2\approx \;-0.328,}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d8345e477024d6067c86e02b45b4bea4b985da54" style="vertical-align: -1.171ex; width:27.862ex; height:3.176ex;"/></span> and  <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle d:=1+{\tfrac {1}{\varphi ^{4}{\sqrt {5}}}}\approx 1.065}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>d</mi>
<mo>:=</mo>
<mn>1</mn>
<mo>+</mo>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mn>1</mn>
<mrow>
<msup>
<mi>φ<!-- φ --></mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>4</mn>
</mrow>
</msup>
<mrow class="MJX-TeXAtom-ORD">
<msqrt>
<mn>5</mn>
</msqrt>
</mrow>
</mrow>
</mfrac>
</mstyle>
</mrow>
<mo>≈<!-- ≈ --></mo>
<mn>1.065</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle d:=1+{\tfrac {1}{\varphi ^{4}{\sqrt {5}}}}\approx 1.065}</annotation>
</semantics>
</math></span><img alt="{\displaystyle d:=1+{\tfrac {1}{\varphi ^{4}{\sqrt {5}}}}\approx 1.065}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f89769f886c02e13ca20417916612b37fefbcd85" style="vertical-align: -1.838ex; width:22.293ex; height:4.176ex;"/></span>.</dd></dl>
<ul><li>a RB tree's height is at most
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\begin{array}{ll}h&amp;\leqq \;2\log _{2}(n+1)\end{array}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtable columnalign="left left" columnspacing="1em" rowspacing="4pt">
<mtr>
<mtd>
<mi>h</mi>
</mtd>
<mtd>
<mo>≦<!-- ≦ --></mo>
<mspace width="thickmathspace"></mspace>
<mn>2</mn>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mtd>
</mtr>
</mtable>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\begin{array}{ll}h&amp;\leqq \;2\log _{2}(n+1)\end{array}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\begin{array}{ll}h&amp;\leqq \;2\log _{2}(n+1)\end{array}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6b6a5f7b037429ded219b161bd1b07a495c03450" style="vertical-align: -0.838ex; width:20.294ex; height:2.843ex;"/></span> .<sup class="reference" id="cite_ref-18">[18]</sup></dd></dl></li></ul>
<p>AVL trees are more rigidly balanced than RB trees with an asymptotic relation AVL/RB ≈0.720 of the maximal heights. For insertions and deletions, Ben Pfaff shows in 79 measurements a relation of AVL/RB between 0.677 and 1.077 with median ≈0.947 and geometric mean ≈0.910.<sup class="reference" id="cite_ref-Pfaff1_4-1">[4]</sup>
</p>
<h2><span class="mw-headline" id="See_also">See also</span><span class="mw-editsection"></span></h2>
<ul><li>Trees</li>
<li>Tree rotation</li>
<li>WAVL tree</li>
<li>Red–black tree</li>
<li>Splay tree</li>
<li>Scapegoat tree</li>
<li>B-tree</li>
<li>T-tree</li>
<li>List of data structures</li></ul>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"></span></h2>

<h2><span class="mw-headline" id="Further_reading">Further reading</span><span class="mw-editsection"></span></h2>
<ul><li>Donald Knuth. <i>The Art of Computer Programming</i>, Volume 3: <i>Sorting and Searching</i>, Third Edition. Addison-Wesley, 1997. <link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/>ISBN 0-201-89685-0. Pages 458–475 of section 6.2.3: Balanced Trees.</li>
<li><span class="anchor" id="Haeupler"></span><link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation cs2" id="CITEREFHaeuplerSenTarjan2015">Haeupler, Bernhard; Sen, Siddhartha; Tarjan, Robert E. (2015), "Rank-balanced trees" <span class="cs1-format">(PDF)</span>, <i>ACM Transactions on Algorithms</i>, <b>11</b> (4): Art. 30, 26, doi:10.1145/2689412, MR 3361215, S2CID 1407290</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=ACM+Transactions+on+Algorithms&amp;rft.atitle=Rank-balanced+trees&amp;rft.volume=11&amp;rft.issue=4&amp;rft.pages=Art.+30%2C+26&amp;rft.date=2015&amp;rft_id=%2F%2Fmathscinet.ams.org%2Fmathscinet-getitem%3Fmr%3D3361215%23id-name%3DMR&amp;rft_id=https%3A%2F%2Fapi.semanticscholar.org%2FCorpusID%3A1407290%23id-name%3DS2CID&amp;rft_id=info%3Adoi%2F10.1145%2F2689412&amp;rft.aulast=Haeupler&amp;rft.aufirst=Bernhard&amp;rft.au=Sen%2C+Siddhartha&amp;rft.au=Tarjan%2C+Robert+E.&amp;rft_id=http%3A%2F%2Fsidsen.azurewebsites.net%2Fpapers%2Frb-trees-talg.pdf&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AAVL+tree"></span>.</li></ul>
<h2><span class="mw-headline" id="External_links">External links</span><span class="mw-editsection"></span></h2>
<style data-mw-deduplicate="TemplateStyles:r1097025294">.mw-parser-output .side-box{margin:4px 0;box-sizing:border-box;border:1px solid #aaa;font-size:88%;line-height:1.25em;background-color:#f9f9f9}.mw-parser-output .side-box-abovebelow,.mw-parser-output .side-box-text{padding:0.25em 0.9em}.mw-parser-output .side-box-image{padding:2px 0 2px 0.9em;text-align:center}.mw-parser-output .side-box-imageright{padding:2px 0.9em 2px 0;text-align:center}@media(min-width:500px){.mw-parser-output .side-box-flex{display:flex;align-items:center}.mw-parser-output .side-box-text{flex:1}}@media(min-width:720px){.mw-parser-output .side-box{width:238px}.mw-parser-output .side-box-right{clear:right;float:right;margin-left:1em}.mw-parser-output .side-box-left{margin-right:1em}}</style>
<link href="mw-data:TemplateStyles:r1097025294" rel="mw-deduplicated-inline-style"/>
<ul><li><img alt="Public Domain" class="noviewer" data-file-height="196" data-file-width="196" decoding="async" height="12" src="//upload.wikimedia.org/wikipedia/en/thumb/6/62/PD-icon.svg/12px-PD-icon.svg.png" srcset="//upload.wikimedia.org/wikipedia/en/thumb/6/62/PD-icon.svg/18px-PD-icon.svg.png 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/6/62/PD-icon.svg/24px-PD-icon.svg.png 2x" width="12"/> This article incorporates public domain material from <link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation cs1" id="CITEREFPaul_E._Black">Paul E. Black. "AVL Tree". <i>Dictionary of Algorithms and Data Structures</i>. NIST.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Dictionary+of+Algorithms+and+Data+Structures&amp;rft.atitle=AVL+Tree&amp;rft.au=Paul+E.+Black&amp;rft_id=https%3A%2F%2Fxlinux.nist.gov%2Fdads%2FHTML%2Favltree.html&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AAVL+tree"></span></li></ul>


<!-- 
NewPP limit report
Parsed by mw2406
Cached time: 20221220213151
Cache expiry: 1814400
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.602 seconds
Real time usage: 1.000 second
Preprocessor visited node count: 8278/1000000
Post‐expand include size: 96479/2097152 bytes
Template argument size: 6963/2097152 bytes
Highest expansion depth: 17/100
Expensive parser function count: 6/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 114155/5000000 bytes
Lua time usage: 0.258/10.000 seconds
Lua memory usage: 7954574/52428800 bytes
Number of Wikibase entities loaded: 0/400
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  526.175      1 -total
 13.83%   72.747     13 Template:Rp
 13.72%   72.187      4 Template:Cite_web
 13.06%   68.740     13 Template:R/superscript
  9.68%   50.954      1 Template:MOS
  7.85%   41.298      2 Template:Navbox
  7.84%   41.238      1 Template:CS-Trees
  7.29%   38.355     42 Template:Math
  6.93%   36.463      1 Template:Infobox_data_structure
  6.82%   35.908      1 Template:Short_description
-->
<!-- Saved in parser cache with key enwiki:pcache:idhash:2118-0!canonical and timestamp 20221220213150 and revision id 1123360561.
 -->
</div></body>
</html>