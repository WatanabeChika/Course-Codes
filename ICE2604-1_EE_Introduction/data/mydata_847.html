<!DOCTYPE html>
<html>
<head>
<title>red-black_tree</title>
</head>
<body>
<div class="mw-parser-output">
<style data-mw-deduplicate="TemplateStyles:r1066479718">.mw-parser-output .infobox-subbox{padding:0;border:none;margin:-3px;width:auto;min-width:100%;font-size:100%;clear:none;float:none;background-color:transparent}.mw-parser-output .infobox-3cols-child{margin:auto}.mw-parser-output .infobox .navbar{font-size:100%}body.skin-minerva .mw-parser-output .infobox-header,body.skin-minerva .mw-parser-output .infobox-subheader,body.skin-minerva .mw-parser-output .infobox-above,body.skin-minerva .mw-parser-output .infobox-title,body.skin-minerva .mw-parser-output .infobox-image,body.skin-minerva .mw-parser-output .infobox-full-data,body.skin-minerva .mw-parser-output .infobox-below{text-align:center}</style><table class="infobox"><tbody><tr><th class="infobox-above" colspan="2">Red–black tree</th></tr><tr><th class="infobox-label" scope="row">Type</th><td class="infobox-data">Tree</td></tr><tr><th class="infobox-label" scope="row">Invented</th><td class="infobox-data">1972</td></tr><tr><th class="infobox-label" scope="row">Invented by</th><td class="infobox-data">Rudolf Bayer</td></tr><tr><th class="infobox-header" colspan="2">Complexities in big O notation</th></tr><tr><td class="infobox-full-data" colspan="2"><link href="mw-data:TemplateStyles:r1066479718" rel="mw-deduplicated-inline-style"/><table class="infobox-subbox infobox-3cols-child"><tbody><tr><th class="infobox-header" colspan="4">Space complexity</th></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Space</th><td class="infobox-data infobox-data-a">
</td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(n)}</annotation>
</semantics>
</math></span><img alt="O(n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/34109fe397fdcff370079185bfdb65826cb5565a" style="vertical-align: -0.838ex; width:4.977ex; height:2.843ex;"/></span></td><td class="infobox-data infobox-data-c">
</td></tr><tr><th class="infobox-header" colspan="4">Time complexity</th></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Function</th><td class="infobox-data infobox-data-a">
</td><td class="infobox-data infobox-data-b">
<b>Amortized</b></td><td class="infobox-data infobox-data-c">
<b>Worst Case</b></td></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Search</th><td class="infobox-data infobox-data-a">
</td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-0">[1]</sup></td><td class="infobox-data infobox-data-c">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-1">[1]</sup></td></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Insert</th><td class="infobox-data infobox-data-a">
</td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(1)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(1)}</annotation>
</semantics>
</math></span><img alt="O(1)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e66384bc40452c5452f33563fe0e27e803b0cc21" style="vertical-align: -0.838ex; width:4.745ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-InfoBU_2-0">[2]</sup></td><td class="infobox-data infobox-data-c">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-2">[1]</sup></td></tr><tr><th class="infobox-label" scope="row" style="white-space:nowrap;">Delete</th><td class="infobox-data infobox-data-a">
</td><td class="infobox-data infobox-data-b">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(1)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(1)}</annotation>
</semantics>
</math></span><img alt="O(1)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e66384bc40452c5452f33563fe0e27e803b0cc21" style="vertical-align: -0.838ex; width:4.745ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-InfoBU_2-1">[2]</sup></td><td class="infobox-data infobox-data-c">
<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span><sup class="reference" id="cite_ref-wiscurl_1-3">[1]</sup></td></tr></tbody></table></td></tr></tbody></table>
<p>In computer science, a <b>red–black tree</b> is a kind of self-balancing binary search tree. Each node stores an extra bit representing "color" ("red" or "black"), used to ensure that the tree remains balanced during insertions and deletions.<sup class="reference" id="cite_ref-Cormen2001_3-0">[3]</sup>
</p><p>When the tree is modified, the new tree is rearranged and "repainted" to restore the coloring properties that constrain how unbalanced the tree can become in the worst case. The properties are designed such that this rearranging and recoloring can be performed efficiently.
</p><p>The re-balancing is not perfect, but guarantees searching in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span> time, where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> is the number of entries. The insert and delete operations, along with the tree rearrangement and recoloring, are also performed in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span> time.<sup class="reference" id="cite_ref-4">[4]</sup>
</p><p>Tracking the color of each node requires only one bit of information per node because there are only two colors. The tree does not contain any other data specific to it being a red–black tree, so its memory footprint is almost identical to that of a classic (uncolored) binary search tree. In many cases, the additional bit of information can be stored at no additional memory cost.
</p>
<style data-mw-deduplicate="TemplateStyles:r886046785">.mw-parser-output .toclimit-2 .toclevel-1 ul,.mw-parser-output .toclimit-3 .toclevel-2 ul,.mw-parser-output .toclimit-4 .toclevel-3 ul,.mw-parser-output .toclimit-5 .toclevel-4 ul,.mw-parser-output .toclimit-6 .toclevel-5 ul,.mw-parser-output .toclimit-7 .toclevel-6 ul{display:none}</style>
<h2><span class="mw-headline" id="History">History</span><span class="mw-editsection"></span></h2>
<p>In 1972, Rudolf Bayer<sup class="reference" id="cite_ref-Bayer72_5-0">[5]</sup> invented a data structure that was a special order-4 case of a B-tree. These trees maintained all paths from root to leaf with the same number of nodes, creating perfectly balanced trees. However, they were not <i>binary</i> search trees. Bayer called them a "symmetric binary B-tree" in his paper and later they became popular as 2–3–4 trees or just 2–4 trees.<sup class="reference" id="cite_ref-6">[6]</sup>
</p><p>In a 1978 paper, "A Dichromatic Framework for Balanced Trees",<sup class="reference" id="cite_ref-GS78_7-0">[7]</sup> Leonidas J. Guibas and Robert Sedgewick derived the red–black tree from the symmetric binary B-tree.<sup class="reference" id="cite_ref-8">[8]</sup> The color "red" was chosen because it was the best-looking color produced by the color laser printer available to the authors while working at Xerox PARC.<sup class="reference" id="cite_ref-Sedgewick12_9-0">[9]</sup> Another response from Guibas states that it was because of the red and black pens available to them to draw the trees.<sup class="reference" id="cite_ref-10">[10]</sup>
</p><p>In 1993, Arne Andersson introduced the idea of a right leaning tree to simplify insert and delete operations.<sup class="reference" id="cite_ref-11">[11]</sup>
</p><p>In 1999, Chris Okasaki showed how to make the insert operation purely functional. Its balance function needed to take care of only 4 unbalanced cases and one default balanced case.<sup class="reference" id="cite_ref-12">[12]</sup>
</p><p>The original algorithm used 8 unbalanced cases, but Cormen et al. (2001) reduced that to 6 unbalanced cases.<sup class="reference" id="cite_ref-Cormen2001_3-1">[3]</sup> Sedgewick showed that the insert operation can be implemented in just 46 lines of Java code.<sup class="reference" id="cite_ref-Algs1_13-0">[13]</sup><sup class="reference" id="cite_ref-14">[14]</sup>
In 2008, Sedgewick proposed the left-leaning red–black tree, leveraging Andersson’s idea that simplified the insert and delete operations. Sedgewick originally allowed nodes whose two children are red, making his trees more like 2–3–4 trees, but later this restriction was added, making new trees more like 2–3 trees. Sedgewick implemented the insert algorithm in just 33 lines, significantly shortening his original 46 lines of code.<sup class="reference" id="cite_ref-15">[15]</sup><sup class="reference" id="cite_ref-Algs4_16-0">[16]</sup>
</p>
<h2><span class="mw-headline" id="Terminology">Terminology</span><span class="mw-editsection"></span></h2>
<style data-mw-deduplicate="TemplateStyles:r1096954695/mw-parser-output/.tmulti">.mw-parser-output .tmulti .multiimageinner{display:flex;flex-direction:column}.mw-parser-output .tmulti .trow{display:flex;flex-direction:row;clear:left;flex-wrap:wrap;width:100%;box-sizing:border-box}.mw-parser-output .tmulti .tsingle{margin:1px;float:left}.mw-parser-output .tmulti .theader{clear:both;font-weight:bold;text-align:center;align-self:center;background-color:transparent;width:100%}.mw-parser-output .tmulti .thumbcaption{background-color:transparent}.mw-parser-output .tmulti .text-align-left{text-align:left}.mw-parser-output .tmulti .text-align-right{text-align:right}.mw-parser-output .tmulti .text-align-center{text-align:center}@media all and (max-width:720px){.mw-parser-output .tmulti .thumbinner{width:100%!important;box-sizing:border-box;max-width:none!important;align-items:center}.mw-parser-output .tmulti .trow{justify-content:center}.mw-parser-output .tmulti .tsingle{float:none!important;max-width:100%!important;box-sizing:border-box;text-align:center}.mw-parser-output .tmulti .tsingle .thumbcaption{text-align:left}.mw-parser-output .tmulti .trow>.thumbcaption{text-align:center}}</style>
<p>A red–black tree is a special type of binary search tree, used in computer science to organize pieces of comparable data, such as text fragments or numbers (as e.g. the numbers in figures 1 and 2). The nodes carrying keys and/or data are frequently called "internal nodes", but in order to make this very specific they are also called non-NIL nodes in this article.
</p><p>The leaf nodes of red–black trees (<span style="background:black"> <span style="color:white">NIL</span> </span> in figure 1) do not contain keys or data. These "leaves" need not be explicit individuals in computer memory: a NULL pointer can —as in all binary tree data structures— encode the fact that there is no child node at this position in the (parent) node. Nevertheless, by their position in the tree, these objects are in relation to other nodes that is relevant to the RB-structure, it may have parent, sibling (i.e., the other child of the parent), uncle, even nephew node; and may be child—but never parent of another node.
It is not really necessary to attribute a "color" to these end-of-path objects, because the condition "is <code>NIL</code> or <code>BLACK</code>" is implied by the condition "is <code>NIL</code>" (see also this remark).
</p><p>Figure 2 shows the conceptually same red–black tree without these NIL leaves. In order to arrive at the same notion of a path, one has to notice that e.g. 3 paths run through the node <b>1</b>, namely a path through <b>1</b><sub>left</sub> plus 2 additional paths through <b>1</b><sub>right</sub>, namely the paths through <b>6</b><sub>left</sub> and <b>6</b><sub>right</sub>. This way, these ends of the paths are also docking points for new nodes to be inserted, fully equivalent to the NIL leaves of figure 1.
</p><p>On the other hand, in order to save a marginal amount of execution time, these (possibly many) NIL leaves may be implemented as pointers to one unique (and black) sentinel node (instead of pointers of value NULL).
</p><p>As a conclusion, the fact that a child does not exist (is not a true node, does not contain data) can in all occurrences be specified by the very same NULL pointer or as the very same pointer to a sentinel node. Throughout this article, either choice is called NIL node and has the constant value <code>NIL</code>.
</p><p>The <b>black depth</b> of a node is defined as the number of black nodes from the root to that node (i.e. the number of black ancestors). The <b>black height</b> of a red–black tree is the number of black nodes in any path from the root to the leaves, which, by requirement 4, is constant (alternatively, it could be defined as the black depth of any leaf node).<sup class="reference" id="cite_ref-Mehlhorn2008_17-0">[17]</sup><sup class="reference nowrap"><span title="Page / location: 154–165">: 154–165 </span></sup>
The black height of a node is the black height of the subtree rooted by it. In this article, the black height of a NIL node shall be set to 0, because its subtree is empty as suggested by figure 2, and its tree height is also 0.
</p>
<h2><span class="mw-headline" id="Properties">Properties</span><span class="mw-editsection"></span></h2>
<p>In addition to the requirements imposed on a binary search tree the following must be satisfied by a <span class="nowrap">red–black tree:<sup class="reference" id="cite_ref-Cormen2009_18-0">[18]</sup></span>
</p>
<ol><li>Every node is either red or black.</li>
<li><span class="anchor" id="consideredBlack"></span>All NIL nodes (figure 1) are considered black.</li>
<li><span class="anchor" id="req3"></span>A red node does not have a red child.</li>
<li><span class="anchor" id="req4"></span>Every path from a given node to any of its descendant NIL nodes goes through the same number of black nodes.</li></ol>
<p>Some authors, e.g. Cormen &amp; al.,<sup class="reference" id="cite_ref-Cormen2009_18-1">[18]</sup> claim "the root is black" as fifth requirement; but not Mehlhorn &amp; Sanders<sup class="reference" id="cite_ref-Mehlhorn2008_17-1">[17]</sup> or Sedgewick &amp; Wayne.<sup class="reference" id="cite_ref-Algs4_16-1">[16]</sup><sup class="reference nowrap"><span title="Page / location: 432–447">: 432–447 </span></sup> Since the root can always be changed from red to black, this rule has little effect on analysis.
This article also omits it, because it slightly disturbs the recursive algorithms and proofs.
</p><p>As an example, every perfect binary tree that consists only of black nodes is a red–black tree.
</p><p>The read-only operations, such as search or tree traversal, do not affect any of the requirements. On the other hand, the modifying operations insert and delete easily maintain requirements 1 and 2, but with respect to the other requirements some extra effort has to be taken, in order to avoid the introduction of a violation of requirement 3, called a <span class="anchor" id="ViolR"></span><b>red-violation</b>, or of requirement 4, called a <span class="anchor" id="ViolB"></span><b>black-violation</b>.
</p><p>The requirements enforce a critical property of red–black trees: <i>the path from the root to the farthest leaf is no more than twice as long as the path from the root to the nearest leaf</i>. The result is that the tree is height-balanced. Since operations such as inserting, deleting, and finding values require worst-case time proportional to the height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> of the tree, this upper bound on the height allows red–black trees to be efficient in the worst case, namely logarithmic in the number <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> of entries, i.e. <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h\in O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h\in O(\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle h\in O(\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fdb711098e2e947667de03803c495c3b8bd142c4" style="vertical-align: -0.838ex; width:12.516ex; height:2.843ex;"/></span>, which is not the case for ordinary binary search trees. For a mathematical proof see section Proof of bounds.
</p><p>Red–black trees, like all binary search trees, allow quite efficient sequential access (e.g. in-order traversal, that is: in the order Left–Root–Right) of their elements. But they support also asymptotically optimal direct access via a traversal from root to leaf, resulting in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span> search time.
</p>
<h2><span class="mw-headline" id="Analogy_to_B-trees_of_order_4">Analogy to B-trees of order 4</span><span class="mw-editsection"></span></h2>

<p>A red–black tree is similar in structure to a B-tree of order<sup class="reference" id="cite_ref-19">[19]</sup> 4, where each node can contain between 1 and 3 values and (accordingly) between 2 and 4 child pointers. In such a B-tree, each node will contain only one value matching the value in a black node of the red–black tree, with an optional value before and/or after it in the same node, both matching an equivalent red node of the red–black tree.
</p><p>One way to see this equivalence is to "move up" the red nodes in a graphical representation of the red–black tree, so that they align horizontally with their parent black node, by creating together a horizontal cluster. In the B-tree, or in the modified graphical representation of the red–black tree, all leaf nodes are at the same depth.
</p><p>The red–black tree is then structurally equivalent to a B-tree of order 4, with a minimum fill factor of 33% of values per cluster with a maximum capacity of 3 values.
</p><p>This B-tree type is still more general than a red–black tree though, as it allows ambiguity in a red–black tree conversion—multiple red–black trees can be produced from an equivalent B-tree of order 4 (see figure 3). If a B-tree cluster contains only 1 value, it is the minimum, black, and has two child pointers. If a cluster contains 3 values, then the central value will be black and each value stored on its sides will be red. If the cluster contains two values, however, either one can become the black node in the red–black tree (and the other one will be red).
</p><p>So the order-4 B-tree does not maintain which of the values contained in each cluster is the root black tree for the whole cluster and the parent of the other values in the same cluster. Despite this, the operations on red–black trees are more economical in time because you don’t have to maintain the vector of values.<sup class="reference" id="cite_ref-20">[20]</sup> It may be costly if values are stored directly in each node rather than being stored by reference. B-tree nodes, however, are more economical in space because you don’t need to store the color attribute for each node. Instead, you have to know which slot in the cluster vector is used. If values are stored by reference, e.g. objects, null references can be used and so the cluster can be represented by a vector containing 3 slots for value pointers plus 4 slots for child references in the tree. In that case, the B-tree can be more compact in memory, improving data locality.
</p><p>The same analogy can be made with B-trees with larger orders that can be structurally equivalent to a colored binary tree: you just need more colors. Suppose that you add blue, then the blue–red–black tree defined like red–black trees but with the additional constraint that no two successive nodes in the hierarchy will be blue and all blue nodes will be children of a red node, then it becomes equivalent to a B-tree whose clusters will have at most 7 values in the following colors: blue, red, blue, black, blue, red, blue (For each cluster, there will be at most 1 black node, 2 red nodes, and 4 blue nodes).
</p><p>For moderate volumes of values, insertions and deletions in a colored binary tree are faster compared to B-trees because colored trees don’t attempt to maximise the fill factor of each horizontal cluster of nodes (only the minimum fill factor is guaranteed in colored binary trees, limiting the number of splits or junctions of clusters). B-trees will be faster for performing rotations (because rotations will frequently occur within the same cluster rather than with multiple separate nodes in a colored binary tree). For storing large volumes, however, B-trees will be much faster as they will be more compact by grouping several children in the same cluster where they can be accessed locally.
</p><p>All optimizations possible in B-trees to increase the average fill factors of clusters are possible in the equivalent multicolored binary tree. Notably, maximizing the average fill factor in a structurally equivalent B-tree is the same as reducing the total height of the multicolored tree, by increasing the number of non-black nodes. The worst case occurs when all nodes in a colored binary tree are black, the best case occurs when only a third of them are black (and the other two thirds are red nodes).
</p>
<h2><span class="mw-headline" id="Applications_and_related_data_structures">Applications and related data structures</span><span class="mw-editsection"></span></h2>
<p>Red–black trees offer worst-case guarantees for insertion time, deletion time, and search time. Not only does this make them valuable in time-sensitive applications such as real-time applications, but it makes them valuable building blocks in other data structures that provide worst-case guarantees; for example, many data structures used in computational geometry can be based on red–black trees, and the Completely Fair Scheduler used in current Linux kernels and epoll system call implementation<sup class="reference" id="cite_ref-21">[21]</sup> uses red–black trees.
</p><p>The AVL tree is another structure supporting <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span> search, insertion, and removal. AVL trees can be colored red–black, thus are a subset of RB trees. Worst-case height is 0.720 times the worst-case height of RB trees, so AVL trees are more rigidly balanced. The performance measurements of Ben Pfaff with realistic test cases in 79 runs find AVL to RB ratios between 0.677 and 1.077, median at 0.947, and geometric mean 0.910.<sup class="reference" id="cite_ref-22">[22]</sup> WAVL trees have a performance in between those two.
</p><p>Red–black trees are also particularly valuable in functional programming, where they are one of the most common persistent data structures, used to construct associative arrays and sets that can retain previous versions after mutations. The persistent version of red–black trees requires <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span> space for each insertion or deletion, in addition to time.
</p><p>For every 2–4 tree, there are corresponding red–black trees with data elements in the same order. The insertion and deletion operations on 2–4 trees are also equivalent to color-flipping and rotations in red–black trees. This makes 2–4 trees an important tool for understanding the logic behind red–black trees, and this is why many introductory algorithm texts introduce 2–4 trees just before red–black trees, even though 2–4 trees are not often used in practice.
</p><p>In 2008, Sedgewick introduced a simpler version of the red–black tree called the left-leaning red–black tree<sup class="reference" id="cite_ref-LLRB_23-0">[23]</sup> by eliminating a previously unspecified degree of freedom in the implementation. The LLRB maintains an additional invariant that all red links must lean left except during inserts and deletes. Red–black trees can be made isometric to either 2–3 trees,<sup class="reference" id="cite_ref-24">[24]</sup> or 2–4 trees,<sup class="reference" id="cite_ref-LLRB_23-1">[23]</sup> for any sequence of operations. The 2–4 tree isometry was described in 1978 by Sedgewick.<sup class="reference" id="cite_ref-GS78_7-1">[7]</sup> With 2–4 trees, the isometry is resolved by a "color flip," corresponding to a split, in which the red color of two children nodes leaves the children and moves to the parent node.
</p><p>The original description of the tango tree, a type of tree optimised for fast searches, specifically uses red–black trees as part of its data structure.<sup class="reference" id="cite_ref-DHIP_25-0">[25]</sup>
</p><p>As of Java 8, the HashMap has been modified such that instead of using a LinkedList to store different elements with colliding hashcodes, a red–black tree is used. This results in the improvement of time complexity of searching such an element from <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(m)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>m</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(m)}</annotation>
</semantics>
</math></span><img alt="O(m)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a0ffd498cf521ce19814e6b7053f1f8ebb1d3c88" style="vertical-align: -0.838ex; width:5.623ex; height:2.843ex;"/></span> to <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log m)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>m</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log m)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle O(\log m)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/01cc8bc56e37299e3f7da69f923f11e601030fd6" style="vertical-align: -0.838ex; width:8.982ex; height:2.843ex;"/></span> where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>m</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m}</annotation>
</semantics>
</math></span><img alt="m" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0a07d98bb302f3856cbabc47b2b9016692e3f7bc" style="vertical-align: -0.338ex; width:2.04ex; height:1.676ex;"/></span> is the number of elements with colliding hashcodes.<sup class="reference" id="cite_ref-26">[26]</sup>
</p>
<h2><span class="mw-headline" id="Operations">Operations</span><span class="mw-editsection"></span></h2>
<p>The read-only operations, such as search or tree traversal, on a red–black tree require no modification from those used for binary search trees, because every red–black tree is a special case of a simple binary search tree. However, the immediate result of an insertion or removal may violate the properties of a red–black tree, the restoration of which is called <i>rebalancing</i> so that red–black trees become self-balancing.
<span class="anchor" id="amortized"></span>It requires in the <i>worst case</i> a small number, <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n)}</annotation>
</semantics>
</math></span><img alt="O(\log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aae0f22048ba6b7c05dbae17b056bfa16e21807d" style="vertical-align: -0.838ex; width:8.336ex; height:2.843ex;"/></span> in Big O notation, where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> is the number of objects in the tree, on average or <i>amortized</i> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(1)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(1)}</annotation>
</semantics>
</math></span><img alt="O(1)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e66384bc40452c5452f33563fe0e27e803b0cc21" style="vertical-align: -0.838ex; width:4.745ex; height:2.843ex;"/></span>, a constant number,<sup class="reference" id="cite_ref-tarjan_27-0">[27]</sup><sup class="reference nowrap"><span title="Page / location: 310">: 310 </span></sup> <sup class="reference" id="cite_ref-Mehlhorn2008_17-2">[17]</sup><sup class="reference nowrap"><span title="Page / location: 158">: 158 </span></sup> of color changes (which are very quick in practice); and no more than three tree rotations<sup class="reference" id="cite_ref-28">[28]</sup> (two for insertion).
</p><p>If the example implementation below is not suitable, other implementations with explanations may be found in Ben Pfaff’s<sup class="reference" id="cite_ref-29">[29]</sup> annotated C library GNU libavl (v2.0.3 as of June 2019).
</p><p>The details of the insert and removal operations will be demonstrated with example C++ code. The example code uses the type definitions and macros below, as well as the helper function for rotations:
</p>



<p><span class="anchor" id="explan"></span>
</p>
<h3><span class="mw-headline" id="Notes_to_the_sample_code_and_diagrams_of_insertion_and_removal">Notes to the sample code and diagrams of insertion and removal</span><span class="mw-editsection"></span></h3>
<p>The proposal breaks down both, insertion and removal (not mentioning some very simple cases), into six constellations of nodes, edges and colors, which are called cases. The code repairing (rebalancing) a case sometimes uses code of a subsequent case. The proposal contains for both, insertion and removal, exactly one case that advances one black level closer to the root and loops, the other five cases rebalance the tree of their own. The more complicated cases are pictured in a diagram.
</p>
<ul><li>The variable <code>N</code> denotes the current node, which is labeled <b>N</b> in the diagrams.</li>
<li><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" style="vertical-align: baseline" width="13"/> symbolises a red node and <img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" style="vertical-align: baseline" width="13"/> a (non-NIL) black node (of black height ≥ 1), <img alt="RedOrBlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/13px-RedOrBlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/20px-RedOrBlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/26px-RedOrBlackNode.svg.png 2x" style="vertical-align: baseline" width="13"/> symbolises the color red or black of a non-NIL node, but the same color throughout the same diagram. NIL nodes are not represented in the diagrams.</li>
<li>A diagram contains three columns and two to four actions. The left column shows the first iteration, the right column the higher iterations, the middle column shows the segmentation of a case into its different actions.<sup class="reference" id="cite_ref-pullout_30-0">[30]</sup></li></ul>
<ol><li>The action "entry" shows the constellation of nodes with their colors which defines a case and mostly violates some of the requirements.<br/>A blue border rings the current node <b>N</b> and the other nodes are labeled according to their relation to <b>N</b>.</li>
<li>If a rotation is considered useful, this is pictured in the next action, which is labeled "rotation".</li>
<li>If some recoloring is considered useful, this is pictured in the next action, which is labeled "color".<sup class="reference" id="cite_ref-31">[31]</sup></li>
<li>If there is still some need to repair, the cases make use of code of other cases and this after a reassignment of the current node <b>N</b>, which then again carries a blue ring and relative to which other nodes may have to be reassigned as well. This action is labeled "reassign".<br/>For both, insert and delete, there is (exactly) one case which iterates one black level closer to the root; then the reassigned constellation satisfies the respective loop invariant.</li></ol>
<ul><li>A possibly numbered triangle with a black circle atop <img alt="TriangleTop.svg" data-file-height="13" data-file-width="10" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/e/e0/TriangleTop.svg/10px-TriangleTop.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/e/e0/TriangleTop.svg/15px-TriangleTop.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/e/e0/TriangleTop.svg/20px-TriangleTop.svg.png 2x" style="vertical-align: baseline" width="10"/> represents a red–black subtree (connected to its parent according to requirement 3) with a black height equal to the iteration level minus one, i.e. zero in the first iteration. Its root may be red or black.<br/>A possibly numbered triangle <img alt="TriangleSubtree.svg" data-file-height="13" data-file-width="11" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3a/TriangleSubtree.svg/11px-TriangleSubtree.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/3/3a/TriangleSubtree.svg/17px-TriangleSubtree.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/3/3a/TriangleSubtree.svg/22px-TriangleSubtree.svg.png 2x" style="vertical-align: baseline" width="11"/> represents a red–black subtree with a black height one less, i.e. its parent has black height zero in the second iteration.</li></ul>
<p><span class="anchor" id="C-eval"></span>
</p>
<dl><dt>Remark</dt>
<dd>For simplicity, the sample code uses the disjunction:
<dl><dd><code>U == NIL || U-&gt;color == BLACK <i>// considered black</i></code></dd></dl></dd>
<dd>and the conjunction:
<dl><dd><code>U != NIL &amp;&amp; U-&gt;color == RED   <i>// not considered black</i></code></dd></dl></dd>
<dd>Thereby, it has to be kept in mind that both statements are <i>not</i> evaluated in total, if <code>U == NIL</code>. Then in both cases <code>U-&gt;color</code> is not touched (see Short-circuit evaluation).<br/>(The comment <code>considered black</code> is in accordance with requirement 2.)</dd>
<dd>The related <code>if</code>-statements have to occur far less frequently if the proposal<sup class="reference" id="cite_ref-pullout_30-1">[30]</sup> is realised.</dd></dl>
<h3><span class="mw-headline" id="Insertion">Insertion</span><span class="mw-editsection"></span></h3>
<p>Insertion begins by placing the new (non-NIL) node, say <b>N</b>, at the position in the binary search tree of a NIL node whose in-order predecessor’s key compares less than the new node’s key, which in turn compares less than the key of its in-order successor.
(Frequently, this positioning is the result of a search within the tree immediately preceding the insert operation and consists of a node <code>P</code> together with a direction <code>dir</code> with <span class="nowrap"><code>P-&gt;child[dir] == NIL</code>.)</span>
The newly inserted node is temporarily colored red so that all paths contain the same number of black nodes as before.
But if its parent, say <b>P</b>, is also red then this action introduces a red-violation.
</p>

<p><span class="anchor" id="loopInvariantI"></span>The rebalancing loop has the following invariant:
</p>
<ul><li>The current node <b>N</b> is <img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/> (red) at the beginning of each iteration.</li>
<li>Requirement 3 is satisfied for all pairs node←parent with the possible exception <b>N</b>←<b>P</b> when <b>P</b> is also red (a red-violation at <b>N</b>).</li>
<li>All other properties (including requirement 4) are satisfied throughout the tree.</li></ul>
<h4><span class="mw-headline" id="Notes_to_the_insert_diagrams">Notes to the insert diagrams</span><span class="mw-editsection"></span></h4>
<table class="wikitable floatright" style="text-align:center;">
<tbody><tr style="background:#E8E8E8;font-size:smaller;">
<td colspan="4"><i>before</i></td>
<td rowspan="2"><i>case</i><br/>→</td>
<td rowspan="2"><i>rota-</i><br/><i>tion</i></td>
<td rowspan="2"><i>assig-</i><br/><i>nment</i></td>
<td colspan="4"><i>after</i></td>
<td rowspan="2">→<br/><i>next</i></td>
<td rowspan="2"><i>Δh</i>
</td></tr>
<tr style="background:#E8E8E8">
<td><b>P</b></td>
<td><b>G</b></td>
<td><b>U</b></td>
<td style="width:.8em;"><i>x</i></td>
<td><b>P</b></td>
<td><b>G</b></td>
<td><b>U</b></td>
<td style="width:.8em;"><i>x</i>
</td></tr>
<tr>
<td>—</td>
<td></td>
<td></td>
<td></td>
<td><b>I3</b></td>
<td></td>
<td></td>
<td colspan="4"></td>
<td>→</td>
<td>
</td></tr>
<tr>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td></td>
<td></td>
<td></td>
<td><b>I1</b></td>
<td></td>
<td></td>
<td colspan="4"></td>
<td>→</td>
<td>
</td></tr>
<tr>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td>—</td>
<td></td>
<td></td>
<td><b>I4</b></td>
<td></td>
<td></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td colspan="3"></td>
<td>→</td>
<td>
</td></tr>
<tr>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td></td>
<td><b>I2</b></td>
<td></td>
<td><b>N</b>:=<b>G</b></td>
<td>?</td>
<td colspan="3"></td>
<td>?</td>
<td>2
</td></tr>
<tr>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td>i</td>
<td><b>I5</b></td>
<td><b>P</b>↶<b>N</b></td>
<td><b>N</b>:=<b>P</b></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td>o</td>
<td><b>I6</b></td>
<td>0
</td></tr>
<tr>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td>o</td>
<td><b>I6</b></td>
<td><b>P</b>↷<b>G</b></td>
<td></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td></td>
<td>→</td>
<td>
</td></tr>
<tr>
<td colspan="13" style="text-align:left;font-size:smaller;">Insertion: This synopsis shows in its <i>before</i> columns, that all<br/>                possible cases<sup class="reference" id="cite_ref-cases_32-0">[32]</sup> of constellations are covered.
</td></tr></tbody></table>
<ul><li>In the diagrams, <b>P</b> is used for <b>N</b>’s parent, <b>G</b> for the grandparent, and <b>U</b> will denote <b>N</b>’s uncle.</li>
<li>The diagrams show the parent node <b>P</b> as the left child of its parent <b>G</b> even though it is possible for <b>P</b> to be on either side. The sample code covers both possibilities by means of the side variable <code>dir</code>.</li>
<li><b>N</b> is the insertion node, but as the operation proceeds also other nodes may become current (see case <b>I2</b>).</li>
<li>The diagrams show the cases where <b>P</b> is red as well, the red-violation.</li>
<li>The column <i>x</i> indicates the change in child direction, i.e. o (for "outer") means that <b>P</b> and <b>N</b> are both left or both right children, whereas i (for "inner") means that the child direction changes from <b>P</b>’s to <b>N</b>’s.</li>
<li>The column group <i>before</i> defines the case, whose name is given in the column <i>case</i>. Thereby possible values in cells left empty are ignored. So in case <b>I2</b> the sample code covers both possibilities of child directions of <b>N</b>, although the corresponding diagram shows only one.</li>
<li>The rows in the synopsis are ordered such that the coverage of all possible RB cases is easily comprehensible.</li>
<li>The column <i>rotation</i> indicates whether a rotation contributes to the rebalancing.</li>
<li>The column <i>assignment</i> shows an assignment of <b>N</b> before entering a subsequent step. This possibly induces a reassignment of the other nodes <b>P</b>, <b>G</b>, <b>U</b> as well.</li>
<li>If something has been changed by the case, this is shown in the column group <i>after</i>.</li>
<li>An arrow → in column <i>next</i> signifies that the rebalancing is complete with this step. If the column <i>after</i> determines exactly one case, this case is given as the subsequent one, otherwise there are question marks.</li>
<li>The loop is contained in the sections "Insert case 1" and "Insert case 2", where in case <b>I2</b> the problem of rebalancing is escalated <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \Delta h=2}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi mathvariant="normal">Δ<!-- Δ --></mi>
<mi>h</mi>
<mo>=</mo>
<mn>2</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \Delta h=2}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \Delta h=2}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e917f435b864bfa3c32af4940ab895a6d857d07d" style="vertical-align: -0.338ex; width:7.536ex; height:2.176ex;"/></span> levels higher in the tree, in that the grandfather <b>G</b> becomes the new current node <b>N</b>. So it takes maximally <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\tfrac {h}{2}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mi>h</mi>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\tfrac {h}{2}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\tfrac {h}{2}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a80fcbc6eae7936fd14446e7e120f846589c3893" style="vertical-align: -1.171ex; width:1.783ex; height:3.676ex;"/></span> iterations to repair the tree (where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> is the height of the tree). Because the probability of escalation decreases exponentially with each iteration the total rebalancing cost is constant on average, indeed amortized constant.</li>
<li>From the body of the loop, case <b>I1</b> exits by itself and there are exiting branches to cases <b>I4</b>, <b>I6</b>, <b>I5 + I6</b>, and <b>I3</b>.</li>
<li>Rotations occur in cases <b>I6</b> and <b>I5 + I6</b> – outside the loop. Therefore, at most two rotations occur in total.</li></ul>
<h4><span class="mw-headline" id="Insert_case_1">Insert case 1</span><span class="mw-editsection"></span></h4>
<p>The current node’s parent <b>P</b> is black, so requirement 3 holds. Requirement 4 holds as well according to the loop invariant.
</p>

<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Insert_case_2">Insert case 2</span><span class="mw-editsection"></span></h4>
<p>If both the parent <b>P</b> and the uncle <b>U</b> are red, then both of them can be repainted black and the grandparent <b>G</b> becomes red for maintaining requirement 4. Since any path through the parent or uncle must pass through the grandparent, the number of black nodes on these paths has not changed. However, the grandparent <b>G</b> may now violate requirement 3, if it has a red parent. After relabeling <b>G</b> to <b>N</b> the loop invariant is fulfilled so that the rebalancing can be iterated on one black level (= 2 tree levels) higher.
</p>

<h4><span class="mw-headline" id="Insert_case_3">Insert case 3</span><span class="mw-editsection"></span></h4>
<p>Insert case 2 has been executed for <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\tfrac {h-1}{2}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mrow>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mrow>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\tfrac {h-1}{2}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\tfrac {h-1}{2}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6dab1f16f0a08d28cf3e4e74d3e5ad6107b715e9" style="vertical-align: -1.171ex; width:3.883ex; height:3.676ex;"/></span> times and the total height of the tree has increased by 1, now being <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h~.}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mtext> </mtext>
<mo>.</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h~.}</annotation>
</semantics>
</math></span><img alt="{\displaystyle h~.}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b0f2c865414ddb59d43d2dc03ffc687bab5c8734" style="vertical-align: -0.338ex; width:2.566ex; height:2.176ex;"/></span>
The current node <b>N</b> is the (red) root of the tree, and all RB-properties are satisfied.
</p>

<h4><span class="mw-headline" id="Insert_case_4">Insert case 4</span><span class="mw-editsection"></span></h4>
<p>The parent <b>P</b> is red and the root.
Because <b>N</b> is also red, requirement 3 is violated. But after switching <b>P</b>’s color the tree is in RB-shape.
The black height of the tree increases by 1.
</p>

<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Insert_case_5">Insert case 5</span><span class="mw-editsection"></span></h4>
<p>The parent <b>P</b> is red but the uncle <b>U</b> is black. The ultimate goal is to rotate the parent node <b>P</b> to the grandparent position, but this will not work if <b>N</b> is an "inner" grandchild of <b>G</b> (i.e., if <b>N</b> is the left child of the right child of <b>G</b> or the right child of the left child of <b>G</b>). A <span class="nowrap"><code>dir</code>-rotation</span> at <b>P</b> switches the roles of the current node <b>N</b> and its parent <b>P</b>. The rotation adds paths through <b>N</b> (those in the subtree labeled <b>2</b>, see diagram) and removes paths through <b>P</b> (those in the subtree labeled <b>4</b>). But both <b>P</b> and <b>N</b> are red, so requirement 4 is preserved. Requirement 3 is restored in case 6.
</p>

<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Insert_case_6">Insert case 6</span><span class="mw-editsection"></span></h4>
<p>The current node <b>N</b> is now certain to be an "outer" grandchild of <b>G</b> (left of left child or right of right child). Now <span class="nowrap"><code>(1-dir)</code>-rotate</span> at <b>G</b>, putting <b>P</b> in place of <b>G</b> and making <b>P</b> the parent of <b>N</b> and <b>G</b>. <b>G</b> is black and its former child <b>P</b> is red, since requirement 3 was violated. After switching the colors of <b>P</b> and <b>G</b> the resulting tree satisfies requirement 3. Requirement 4 also remains satisfied, since all paths that went through the black <b>G</b> now go through the black <b>P</b>.
</p>

<p>Because the algorithm transforms the input without using an auxiliary data structure and using only a small amount of extra storage space for auxiliary variables it is in-place.
</p>
<h3><span class="mw-headline" id="Removal:_simple_cases">Removal: simple cases</span><span class="mw-editsection"></span></h3>
<p>The label <b>N</b> denotes the current node that at entry is the node to be deleted.
</p><p>If <b>N</b> is the root that does not have a non-NIL child, it is replaced by a NIL node, after which the tree is empty—and in RB-shape.
</p><p>If <b>N</b> has two non-NIL children, an additional navigation to either the maximum element in its left subtree (which is the in-order predecessor) or the minimum element in its right subtree (which is the in-order successor) finds a node with no other node in between (as shown here). This "replacement node", say <b>R</b>, has – as the maximal or minimal element of a subtree – at most one non-NIL child. In order to keep the software completely independent of the node structure as defined by the user, all red–black tree data related with <b>N</b> and <b>R</b>, i.e. the color of and the pointers to and from the two nodes, are exchanged. (The modified red–black tree is the same as before with the exception of the reversed order between <b>N</b> and <b>R</b>, an issue which immediately is resolved by the removal of <b>N</b>.) Now <b>N</b> has at most one non-NIL child.
</p><p>If <b>N</b> has exactly one non-NIL child, it must be a red child, because if it were a black one then requirement 4 would force a second black non-NIL child.
</p><p>If <b>N</b> is a red node, it cannot have a non-NIL child, because this would have to be black by requirement 3. Furthermore, it cannot have exactly one black child as argued just above. As a consequence, the red node <b>N</b> is without any child and can simply be removed.
</p><p>If <b>N</b> is a black node, it may have a red child or no non-NIL child at all.
If <b>N</b> has a red child, it is simply replaced with this child after painting the latter black.
</p>
<h3><span class="mw-headline" id="Removal_of_a_black_non-root_leaf">Removal of a black non-root leaf</span><span class="mw-editsection"></span></h3>
<p>The complex case is when <b>N</b> is not the root, colored black and has only NIL children (⇔ no proper child).
In the first iteration, <b>N</b> is replaced by NIL.
</p>

<p><span class="anchor" id="loopInvariantD"></span>The rebalancing loop has the following invariant:
</p>
<ul><li>At the beginning of each iteration the black height of <b>N</b> equals the iteration number minus one, which means that in the first iteration it is zero and that <b>N</b> is a true black node <img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/> in higher iterations.</li>
<li>The number of black nodes on the paths through <b>N</b> is one less than before the deletion, whereas it is unchanged on all other paths, so that there is a black-violation at <b>P</b> if other paths exist.</li>
<li>All other properties (including requirement 3) are satisfied throughout the tree.</li></ul>
<h4><span class="mw-headline" id="Notes_to_the_delete_diagrams">Notes to the delete diagrams</span><span class="mw-editsection"></span></h4>
<table class="wikitable floatright" style="text-align:center;">
<tbody><tr style="background:#E8E8E8;font-size:smaller;">
<td colspan="4"><i>before</i></td>
<td rowspan="2"><i>case</i><br/>→</td>
<td rowspan="2"><i>rota-</i><br/><i>tion</i></td>
<td rowspan="2"><i>assig-</i><br/><i>nment</i></td>
<td colspan="4"><i>after</i></td>
<td rowspan="2">→<br/><i>next</i></td>
<td rowspan="2"><i>Δh</i>
</td></tr>
<tr style="background:#E8E8E8">
<td><b>P</b></td>
<td><b>C</b></td>
<td><b>S</b></td>
<td><b>D</b></td>
<td><b>P</b></td>
<td><b>C</b></td>
<td><b>S</b></td>
<td><b>D</b>
</td></tr>
<tr>
<td>—</td>
<td></td>
<td></td>
<td></td>
<td><b>D2</b></td>
<td></td>
<td></td>
<td colspan="4"></td>
<td>→</td>
<td>
</td></tr>
<tr>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><b>D3</b></td>
<td><b>P</b>↶<b>S</b></td>
<td><b>N</b>:=<b>N</b></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td>?</td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td>?</td>
<td>?</td>
<td>0
</td></tr>
<tr>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><b>D1</b></td>
<td></td>
<td><b>N</b>:=<b>P</b></td>
<td>?</td>
<td colspan="3"></td>
<td>?</td>
<td>1
</td></tr>
<tr>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><b>D4</b></td>
<td></td>
<td></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td>→</td>
<td>
</td></tr>
<tr>
<td><img alt="RedOrBlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/13px-RedOrBlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/20px-RedOrBlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/26px-RedOrBlackNode.svg.png 2x" width="13"/></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><b>D5</b></td>
<td><b>C</b>↷<b>S</b></td>
<td><b>N</b>:=<b>N</b></td>
<td><img alt="RedOrBlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/13px-RedOrBlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/20px-RedOrBlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/26px-RedOrBlackNode.svg.png 2x" width="13"/></td>
<td></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><b>D6</b></td>
<td>0
</td></tr>
<tr>
<td><img alt="RedOrBlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/13px-RedOrBlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/20px-RedOrBlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/26px-RedOrBlackNode.svg.png 2x" width="13"/></td>
<td></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td><img alt="RedNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/13px-RedNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/20px-RedNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cc/RedNode.svg/26px-RedNode.svg.png 2x" width="13"/></td>
<td><b>D6</b></td>
<td><b>P</b>↶<b>S</b></td>
<td></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td></td>
<td><img alt="RedOrBlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/13px-RedOrBlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/20px-RedOrBlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/26px-RedOrBlackNode.svg.png 2x" width="13"/></td>
<td><img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/></td>
<td>→</td>
<td>
</td></tr>
<tr>
<td colspan="13" style="text-align:left; font-size:smaller;">Deletion: This synopsis shows in its <i>before</i> columns, that all<br/>                possible cases<sup class="reference" id="cite_ref-cases_32-1">[32]</sup> of color constellations are covered.
</td></tr></tbody></table>
<ul><li>In the diagrams below, <b>P</b> is used for <b>N</b>’s parent, <b>S</b> for the sibling of <b>N</b>, <b>C</b> (meaning <i>close</i> nephew) for <b>S</b>’s child in the same direction as <b>N</b>, and <b>D</b> (meaning <i>distant</i> nephew) for <b>S</b>’s other child (<b>S</b> cannot be a NIL node in the first iteration, because it has to have black height one, which was the black height of <b>N</b> before its deletion, but <b>C</b> and <b>D</b> may be NIL nodes).</li>
<li>The diagrams show the current node <b>N</b> as the left child of its parent <b>P</b> even though it is possible for <b>N</b> to be on either side. The code samples cover both possibilities by means of the side variable <code>dir</code>.</li>
<li>At the beginning (in the first iteration) of removal, <b>N</b> is the NIL node replacing the node to be deleted. Because its location in parent’s node is the only thing of importance, it is symbolised by <img alt="NilBlue.svg" data-file-height="13" data-file-width="15" decoding="async" height="7" src="//upload.wikimedia.org/wikipedia/commons/thumb/6/6c/NilBlue.svg/8px-NilBlue.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/6/6c/NilBlue.svg/12px-NilBlue.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/6c/NilBlue.svg/16px-NilBlue.svg.png 2x" width="8"/> (meaning: the current node <b>N</b> is a NIL node and left child) in the left column of the delete diagrams. As the operation proceeds also proper nodes (of black height ≥ 1) may become current (see e.g. case <b>D1</b>).</li>
<li>By counting the black bullets (<img alt="BlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/13px-BlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/20px-BlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/fe/BlackNode.svg/26px-BlackNode.svg.png 2x" width="13"/> and <img alt="TriangleTop.svg" data-file-height="13" data-file-width="10" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/e/e0/TriangleTop.svg/10px-TriangleTop.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/e/e0/TriangleTop.svg/15px-TriangleTop.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/e/e0/TriangleTop.svg/20px-TriangleTop.svg.png 2x" width="10"/>) in a delete diagram it can be observed that the paths through <b>N</b> have one bullet less than the other paths. This means a black-violation at <b>P</b>—if it exists.</li>
<li>The color constellation in column group <i>before</i> defines the case, whose name is given in the column <i>case</i>. Thereby possible values in cells left empty are ignored.</li>
<li>The rows in the synopsis are ordered such that the coverage of all possible RB cases is easily comprehensible.</li>
<li>The column <i>rotation</i> indicates whether a rotation contributes to the rebalancing.</li>
<li>The column <i>assignment</i> shows an assignment of <b>N</b> before entering a subsequent step. This possibly induces a reassignment of the other nodes <b>P</b>, <b>C</b>, <b>S</b>, <b>D</b> as well.</li>
<li>If something has been changed by the case, this is shown in the column group <i>after</i>.</li>
<li>An arrow → in column <i>next</i> signifies that the rebalancing is complete with this step. If the column <i>after</i> determines exactly one case, this case is given as the subsequent one, otherwise there are question marks.</li>
<li>The loop is contained in the sections from <code>Start_D</code> through "Delete case 1", where the problem of rebalancing is escalated <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \Delta h=1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi mathvariant="normal">Δ<!-- Δ --></mi>
<mi>h</mi>
<mo>=</mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \Delta h=1}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \Delta h=1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6d1e4add760f1aeebaeafee795acfa6f29b548bc" style="vertical-align: -0.338ex; width:7.536ex; height:2.176ex;"/></span> level higher in the tree in that the parent <b>P</b> becomes the new current node <b>N</b>. So it takes maximally <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> iterations to repair the tree (where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> is the height of the tree). Because the probability of escalation decreases exponentially with each iteration the total rebalancing cost is constant on average, indeed amortized constant. (Just as an aside: Mehlhorn &amp; Sanders point out: "AVL trees do <i>not</i> support constant amortized update costs."<sup class="reference" id="cite_ref-Mehlhorn2008_17-3">[17]</sup><sup class="reference nowrap"><span title="Page / location: 165, 158">: 165, 158 </span></sup> This is true for the rebalancing after a deletion, but not AVL insertion.<sup class="reference" id="cite_ref-33">[33]</sup>)</li>
<li>Out of the body of the loop there are exiting branches to the cases <b>D3</b>, <b>D6</b>, <b>D5 + D6</b>, <b>D4</b>, and <b>D2</b>; section "Delete case 3" of its own has three different exiting branches to the cases <b>D6</b>, <b>D5</b> and <b>D4</b>.</li>
<li>Rotations occur in cases <b>D6</b> and <b>D5 + D6</b> and <b>D3 + D5 + D6</b> – all outside the loop. Therefore, at most three rotations occur in total.</li></ul>
<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Delete_case_1">Delete case 1</span><span class="mw-editsection"></span></h4>
<p><b>P</b>, <b>S</b>, and <b>S</b>’s children are black. After painting <b>S</b> red all paths passing through <b>S</b>, which are precisely those paths <i>not</i> passing through <b>N</b>, have one less black node. Now all paths in the subtree rooted by <b>P</b> have the same number of black nodes, but one fewer than the paths that do not pass through <b>P</b>, so requirement 4 may still be violated. After relabeling <b>P</b> to <b>N</b> the loop invariant is fulfilled so that the rebalancing can be iterated on one black level (= 1 tree level) higher.
</p>

<h4><span class="mw-headline" id="Delete_case_2">Delete case 2</span><span class="mw-editsection"></span></h4>
<p>The current node <b>N</b> is the new root. One black node has been removed from every path, so the RB-properties are preserved.
The black height of the tree decreases by 1.
</p>


<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Delete_case_3">Delete case 3</span><span class="mw-editsection"></span></h4>
<p>The sibling <b>S</b> is red, so <b>P</b> and the nephews <b>C</b> and <b>D</b> have to be black. A <span class="nowrap"><code>dir</code>-rotation</span> at <b>P</b> turns <b>S</b> into <b>N</b>’s grandparent.
Then after reversing the colors of <b>P</b> and <b>S</b>, the path through <b>N</b> is still short one black node. But <b>N</b> has a red parent <b>P</b> and a black sibling <b>S</b>, so the transformations in cases D4, D5, or D6 are able to restore the RB-shape.
</p>


<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Delete_case_4">Delete case 4</span><span class="mw-editsection"></span></h4>
<p>The sibling <b>S</b> and <b>S</b>’s children are black, but <b>P</b> is red. Exchanging the colors of <b>S</b> and <b>P</b> does not affect the number of black nodes on paths going through <b>S</b>, but it does add one to the number of black nodes on paths going through <b>N</b>, making up for the deleted black node on those paths.
</p>


<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Delete_case_5">Delete case 5</span><span class="mw-editsection"></span></h4>
<p>The sibling <b>S</b> is black, <b>S</b>’s close child <b>C</b> is red, and <b>S</b>’s distant child <b>D</b> is black. After a <span class="nowrap"><code>(1-dir)</code>-rotation</span> at <b>S</b> the nephew <b>C</b> becomes <b>S</b>’s parent and <b>N</b>’s new sibling. The colors of <b>S</b> and <b>C</b> are exchanged.
All paths still have the same number of black nodes, but now <b>N</b> has a black sibling whose distant child is red, so the constellation is fit for case D6. Neither <b>N</b> nor its parent <b>P</b> are affected by this transformation, and <b>P</b> may be red or black (<img alt="RedOrBlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/13px-RedOrBlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/20px-RedOrBlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/26px-RedOrBlackNode.svg.png 2x" width="13"/> in the diagram).
</p>


<link href="mw-data:TemplateStyles:r1096954695/mw-parser-output/.tmulti" rel="mw-deduplicated-inline-style"/>
<h4><span class="mw-headline" id="Delete_case_6">Delete case 6</span><span class="mw-editsection"></span></h4>
<p>The sibling <b>S</b> is black, <b>S</b>’s distant child <b>D</b> is red. After a <span class="nowrap"><code>dir</code>-rotation</span> at <b>P</b> the sibling <b>S</b> becomes the parent of <b>P</b> and <b>S</b>’s distant child <b>D</b>. The colors of <b>P</b> and <b>S</b> are exchanged, and <b>D</b> is made black. The subtree still has the same color at its root, namely either red or black (<img alt="RedOrBlackNode.svg" data-file-height="13" data-file-width="13" decoding="async" height="13" src="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/13px-RedOrBlackNode.svg.png" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/20px-RedOrBlackNode.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/b/bd/RedOrBlackNode.svg/26px-RedOrBlackNode.svg.png 2x" width="13"/> in the diagram), which refers to the same color both before and after the transformation. This way requirement 3 is preserved. The paths in the subtree not passing through <b>N</b> (i.o.w. passing through <b>D</b> and node <b>3</b> in the diagram) pass through the same number of black nodes as before, but <b>N</b> now has one additional black ancestor: either <b>P</b> has become black, or it was black and <b>S</b> was added as a black grandparent. Thus, the paths passing through <b>N</b> pass through one additional black node, so that requirement 4 is restored and the total tree is in RB-shape.
</p>

<p>Because the algorithm transforms the input without using an auxiliary data structure and using only a small amount of extra storage space for auxiliary variables it is in-place.
</p>
<h2><span class="mw-headline" id="Proof_of_bounds">Proof of bounds</span><span class="mw-editsection"></span></h2>

<p>For <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h\in \mathbb {N} }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mo>∈<!-- ∈ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="double-struck">N</mi>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h\in \mathbb {N} }</annotation>
</semantics>
</math></span><img alt="{\displaystyle h\in \mathbb {N} }" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fd796ca77a508511c1ba760a6b508973b08afc36" style="vertical-align: -0.338ex; width:5.858ex; height:2.176ex;"/></span> there is a red–black tree of height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> with
</p>
<dl><dd><table>
<tbody><tr>
<td rowspan="3"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\begin{array}{ll}m_{h}&amp;=2^{\lfloor (h+1)/2\rfloor }+2^{\lfloor h/2\rfloor }-2\\&amp;{={\begin{cases}2\cdot 2^{\tfrac {h}{2}}-2=2^{{\tfrac {h}{2}}+1}-2\\3\cdot 2^{\tfrac {h-1}{2}}-2\end{cases}}}\end{array}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtable columnalign="left left" columnspacing="1em" rowspacing="4pt">
<mtr>
<mtd>
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
</mrow>
</msub>
</mtd>
<mtd>
<mo>=</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mo>+</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mi>h</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
</mtd>
</mtr>
<mtr>
<mtd></mtd>
<mtd>
<mrow class="MJX-TeXAtom-ORD">
<mo>=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow>
<mo>{</mo>
<mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em">
<mtr>
<mtd>
<mn>2</mn>
<mo>⋅<!-- ⋅ --></mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mi>h</mi>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
<mo>=</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mi>h</mi>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
<mo>+</mo>
<mn>1</mn>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
</mtd>
</mtr>
<mtr>
<mtd>
<mn>3</mn>
<mo>⋅<!-- ⋅ --></mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="false" scriptlevel="0">
<mfrac>
<mrow>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mrow>
<mn>2</mn>
</mfrac>
</mstyle>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
</mtd>
</mtr>
</mtable>
<mo fence="true" stretchy="true" symmetric="true"></mo>
</mrow>
</mrow>
</mrow>
</mtd>
</mtr>
</mtable>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\begin{array}{ll}m_{h}&amp;=2^{\lfloor (h+1)/2\rfloor }+2^{\lfloor h/2\rfloor }-2\\&amp;{={\begin{cases}2\cdot 2^{\tfrac {h}{2}}-2=2^{{\tfrac {h}{2}}+1}-2\\3\cdot 2^{\tfrac {h-1}{2}}-2\end{cases}}}\end{array}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\begin{array}{ll}m_{h}&amp;=2^{\lfloor (h+1)/2\rfloor }+2^{\lfloor h/2\rfloor }-2\\&amp;{={\begin{cases}2\cdot 2^{\tfrac {h}{2}}-2=2^{{\tfrac {h}{2}}+1}-2\\3\cdot 2^{\tfrac {h-1}{2}}-2\end{cases}}}\end{array}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7c38c8b683bfb657db1ceef8ac815339332d431d" style="vertical-align: -5.671ex; width:33.966ex; height:12.509ex;"/></span></td>
<td><small>(with floor function <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \lfloor \,\rfloor }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mspace width="thinmathspace"></mspace>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \lfloor \,\rfloor }</annotation>
</semantics>
</math></span><img alt="{\displaystyle \lfloor \,\rfloor }" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3084289cca849fb18ec6407b9de5faa5846d8607" style="vertical-align: -0.838ex; width:2.452ex; height:2.843ex;"/></span>)</small>
</td></tr>
<tr>
<td>if <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> even
</td></tr>
<tr>
<td>if <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> odd
</td></tr></tbody></table></dd></dl>
<p>nodes and there is no red–black tree of this tree height with fewer nodes—therefore it is <b>minimal</b>.<br/>Its black height is   <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \lceil h/2\rceil }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo fence="false" stretchy="false">⌈<!-- ⌈ --></mo>
<mi>h</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌉<!-- ⌉ --></mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \lceil h/2\rceil }</annotation>
</semantics>
</math></span><img alt="{\displaystyle \lceil h/2\rceil }" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6ab467b2409d6a03abd1eaea955a89b01ab11bc4" style="vertical-align: -0.838ex; width:5.729ex; height:2.843ex;"/></span>   (with black root) or for odd <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> (then with a red root) also   <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (h-1)/2~.}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mtext> </mtext>
<mo>.</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle (h-1)/2~.}</annotation>
</semantics>
</math></span><img alt="{\displaystyle (h-1)/2~.}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/624b37eb86422209805b5a7ae402623f34fe9516" style="vertical-align: -0.838ex; width:10.704ex; height:2.843ex;"/></span>
</p>
<dl><dt>Proof</dt></dl>
<p>For a red–black tree of a certain height to have minimal number of nodes, it has to have exactly one longest path with maximal number of red nodes, in order to achieve a maximal tree height with a minimal black height. Besides this path all other nodes have to be black.<sup class="reference" id="cite_ref-Algs4_16-2">[16]</sup><sup class="reference nowrap"><span title="Page / location: 444 Proof sketch">: 444 Proof sketch </span></sup> If a node is taken off this tree it either loses height or some RB property.
</p><p>The RB tree of height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h=1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mo>=</mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h=1}</annotation>
</semantics>
</math></span><img alt="h=1" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3d5d82ae0a834e0d0b839e2ea7a0f8eac0ee791d" style="vertical-align: -0.338ex; width:5.6ex; height:2.176ex;"/></span> with red root is minimal. This is in agreement with
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{1}=2^{\lfloor (1+1)/2\rfloor }\!+\!2^{\lfloor 1/2\rfloor }\!\!-\!\!2=2^{1}\!+\!2^{0}\!\!-\!\!2=1~.}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>=</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mn>1</mn>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mspace width="negativethinmathspace"></mspace>
<mo>+</mo>
<mspace width="negativethinmathspace"></mspace>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mn>1</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mo>−<!-- − --></mo>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mn>2</mn>
<mo>=</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msup>
<mspace width="negativethinmathspace"></mspace>
<mo>+</mo>
<mspace width="negativethinmathspace"></mspace>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mn>0</mn>
</mrow>
</msup>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mo>−<!-- − --></mo>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mn>2</mn>
<mo>=</mo>
<mn>1</mn>
<mtext> </mtext>
<mo>.</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{1}=2^{\lfloor (1+1)/2\rfloor }\!+\!2^{\lfloor 1/2\rfloor }\!\!-\!\!2=2^{1}\!+\!2^{0}\!\!-\!\!2=1~.}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{1}=2^{\lfloor (1+1)/2\rfloor }\!+\!2^{\lfloor 1/2\rfloor }\!\!-\!\!2=2^{1}\!+\!2^{0}\!\!-\!\!2=1~.}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/30e23cc8c099a9f15af5d0b202fcbbd9f6bf61ff" style="vertical-align: -0.671ex; width:42.276ex; height:3.176ex;"/></span></dd></dl>
<p>A minimal RB tree (RB<sub><i>h</i></sub> in figure 4) of height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h&gt;1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mo>&gt;</mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h&gt;1}</annotation>
</semantics>
</math></span><img alt="{\displaystyle h&gt;1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3df33213a54649226c03c8115b130c49170d0683" style="vertical-align: -0.338ex; width:5.6ex; height:2.176ex;"/></span> has a root whose two child subtrees are of different height. The higher child subtree is also a minimal RB tree, <span class="nowrap">RB<sub><i>h</i>–1</sub>,</span> containing also a longest path that defines its height <span class="nowrap"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h\!\!-\!\!1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mo>−<!-- − --></mo>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h\!\!-\!\!1}</annotation>
</semantics>
</math></span><img alt="{\displaystyle h\!\!-\!\!1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/457b18f3a6b88195f73823276ea191f69975fbe3" style="vertical-align: -0.505ex; width:3.793ex; height:2.343ex;"/></span>;</span> it has <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{h-1}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{h-1}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{h-1}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1edb81f036dd4ec5ed6234b26b2bb969e140fb5e" style="vertical-align: -0.671ex; width:5.32ex; height:2.009ex;"/></span> nodes and the black height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \lfloor (h\!\!-\!\!1)/2\rfloor =:s.}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mi>h</mi>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mo>−<!-- − --></mo>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
<mo>=:</mo>
<mi>s</mi>
<mo>.</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \lfloor (h\!\!-\!\!1)/2\rfloor =:s.}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \lfloor (h\!\!-\!\!1)/2\rfloor =:s.}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e058a8d10edc0edb201b22f2e4b24455452d2519" style="vertical-align: -0.838ex; width:15.475ex; height:2.843ex;"/></span> The other subtree is a perfect binary tree of (black) height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>s</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s}</annotation>
</semantics>
</math></span><img alt="s" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/01d131dfd7673938b947072a13a9744fe997e632" style="vertical-align: -0.338ex; width:1.09ex; height:1.676ex;"/></span> having <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle 2^{s}\!\!-\!\!1=2^{\lfloor (h-1)/2\rfloor }\!\!-\!\!1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mi>s</mi>
</mrow>
</msup>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mo>−<!-- − --></mo>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mn>1</mn>
<mo>=</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mo>−<!-- − --></mo>
<mspace width="negativethinmathspace"></mspace>
<mspace width="negativethinmathspace"></mspace>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle 2^{s}\!\!-\!\!1=2^{\lfloor (h-1)/2\rfloor }\!\!-\!\!1}</annotation>
</semantics>
</math></span><img alt="{\displaystyle 2^{s}\!\!-\!\!1=2^{\lfloor (h-1)/2\rfloor }\!\!-\!\!1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5bf25348afb7233dd7a0f4d94f1128874424b09f" style="vertical-align: -0.505ex; width:18.999ex; height:3.009ex;"/></span> black nodes—and no red node. Then the number of nodes is by induction
</p>
<table>
<tbody><tr>
<td style="width:1.0em;"></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{h}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{h}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{h}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8125d74e28bfab7418265ece96c1ea364924cb14" style="vertical-align: -0.671ex; width:3.219ex; height:2.009ex;"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle =}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>=</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle =}</annotation>
</semantics>
</math></span><img alt="=" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/505a4ceef454c69dffd23792c84b90f488543743" style="vertical-align: 0.307ex; margin-bottom: -0.478ex; width:1.808ex; height:1.343ex;"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (m_{h-1})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo stretchy="false">(</mo>
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle (m_{h-1})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle (m_{h-1})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f9c7c6238d1d63a5a01c0a529df696ee1c387a5d" style="vertical-align: -0.838ex; width:7.129ex; height:2.843ex;"/></span></td>
<td style="width:4em;text-align:center;"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle +}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>+</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle +}</annotation>
</semantics>
</math></span><img alt="+" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fe6ef363cd19902d1a7a71fb1c8b21e8ede52406" style="vertical-align: -0.505ex; width:1.808ex; height:2.176ex;"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (1)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo stretchy="false">(</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle (1)}</annotation>
</semantics>
</math></span><img alt="(1)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a25115739469707c4758b189fe310a750092a80a" style="vertical-align: -0.838ex; width:2.972ex; height:2.843ex;"/></span></td>
<td style="width:4em;text-align:center;"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle +}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>+</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle +}</annotation>
</semantics>
</math></span><img alt="+" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fe6ef363cd19902d1a7a71fb1c8b21e8ede52406" style="vertical-align: -0.505ex; width:1.808ex; height:2.176ex;"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (2^{\lfloor (h-1)/2\rfloor }-1)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo stretchy="false">(</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle (2^{\lfloor (h-1)/2\rfloor }-1)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle (2^{\lfloor (h-1)/2\rfloor }-1)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f2da06f0224c47d78ea9c9d136eea85c35bbad57" style="vertical-align: -0.838ex; width:14.638ex; height:3.343ex;"/></span>
</td></tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>(higher subtree)</td>
<td></td>
<td>(root)</td>
<td></td>
<td>(second subtree)
</td></tr>
<tr>
<td colspan="8">resulting in
</td></tr>
<tr>
<td></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{h}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{h}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{h}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8125d74e28bfab7418265ece96c1ea364924cb14" style="vertical-align: -0.671ex; width:3.219ex; height:2.009ex;"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle =}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>=</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle =}</annotation>
</semantics>
</math></span><img alt="=" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/505a4ceef454c69dffd23792c84b90f488543743" style="vertical-align: 0.307ex; margin-bottom: -0.478ex; width:1.808ex; height:1.343ex;"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (2^{\lfloor h/2\rfloor }+2^{\lfloor (h-1)/2\rfloor }-2)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo stretchy="false">(</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mi>h</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mo>+</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle (2^{\lfloor h/2\rfloor }+2^{\lfloor (h-1)/2\rfloor }-2)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle (2^{\lfloor h/2\rfloor }+2^{\lfloor (h-1)/2\rfloor }-2)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8dec3e50772f8368dd541d82625fde74f035c034" style="vertical-align: -0.838ex; width:22.923ex; height:3.343ex;"/></span></td>
<td style="text-align:center;"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle +}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>+</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle +}</annotation>
</semantics>
</math></span><img alt="+" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fe6ef363cd19902d1a7a71fb1c8b21e8ede52406" style="vertical-align: -0.505ex; width:1.808ex; height:2.176ex;"/></span></td>
<td colspan="2" style="text-align:right;"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle 2^{\lfloor (h-1)/2\rfloor }}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle 2^{\lfloor (h-1)/2\rfloor }}</annotation>
</semantics>
</math></span><img alt="{\displaystyle 2^{\lfloor (h-1)/2\rfloor }}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9cfcd8ddfb80d940a3b5e56fc4569b7a2309cf58" style="vertical-align: -0.338ex; width:8.825ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td></td>
<td></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle =}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>=</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle =}</annotation>
</semantics>
</math></span><img alt="=" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/505a4ceef454c69dffd23792c84b90f488543743" style="vertical-align: 0.307ex; margin-bottom: -0.478ex; width:1.808ex; height:1.343ex;"/></span></td>
<td colspan="8"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle 2^{\lfloor h/2\rfloor }+2^{\lfloor (h+1)/2\rfloor }-2}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mi>h</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mo>+</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo fence="false" stretchy="false">⌊<!-- ⌊ --></mo>
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo fence="false" stretchy="false">⌋<!-- ⌋ --></mo>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle 2^{\lfloor h/2\rfloor }+2^{\lfloor (h+1)/2\rfloor }-2}</annotation>
</semantics>
</math></span><img alt="{\displaystyle 2^{\lfloor h/2\rfloor }+2^{\lfloor (h+1)/2\rfloor }-2}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2510bfeed4ca7e4483bd09d45a37d5d47bdede7" style="vertical-align: -0.505ex; width:21.114ex; height:3.009ex;"/></span>  ■
</td></tr></tbody></table>
<p>The graph of the function <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{h}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{h}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{h}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8125d74e28bfab7418265ece96c1ea364924cb14" style="vertical-align: -0.671ex; width:3.219ex; height:2.009ex;"/></span> is convex and piecewise linear with breakpoints at <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (h=2k\;|\;m_{2k}=2\cdot 2^{k}\!-\!2)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>=</mo>
<mn>2</mn>
<mi>k</mi>
<mspace width="thickmathspace"></mspace>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mspace width="thickmathspace"></mspace>
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
<mi>k</mi>
</mrow>
</msub>
<mo>=</mo>
<mn>2</mn>
<mo>⋅<!-- ⋅ --></mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
</mrow>
</msup>
<mspace width="negativethinmathspace"></mspace>
<mo>−<!-- − --></mo>
<mspace width="negativethinmathspace"></mspace>
<mn>2</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle (h=2k\;|\;m_{2k}=2\cdot 2^{k}\!-\!2)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle (h=2k\;|\;m_{2k}=2\cdot 2^{k}\!-\!2)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3ce284b61162046ecc582488fff2f6d539cdfb75" style="vertical-align: -0.838ex; width:25.929ex; height:3.176ex;"/></span> where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k\in \mathbb {N} .}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
<mo>∈<!-- ∈ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="double-struck">N</mi>
</mrow>
<mo>.</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k\in \mathbb {N} .}</annotation>
</semantics>
</math></span><img alt="{\displaystyle k\in \mathbb {N} .}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7037847116113f919f4a73998f7466f9c0615a1b" style="vertical-align: -0.338ex; width:6.377ex; height:2.176ex;"/></span> The function has been tabulated as <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{h}=}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
</mrow>
</msub>
<mo>=</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{h}=}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{h}=}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f80ecca43c17a8fb1a90622696612e6a5d0742a8" style="vertical-align: -0.671ex; width:5.673ex; height:2.009ex;"/></span> A027383(<i>h</i>–1) for <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h\geq 1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mo>≥<!-- ≥ --></mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h\geq 1}</annotation>
</semantics>
</math></span><img alt="{\displaystyle h\geq 1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0757ec4a3a583f5faf146a91bfbbf088253f112c" style="vertical-align: -0.505ex; width:5.6ex; height:2.343ex;"/></span> <span class="nowrap">(sequence <span class="nowrap external">A027383</span> in the OEIS).</span>
</p>
<dl><dt>Solving the function for <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span></dt></dl>
<p>The inequality <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle 9&gt;8=2^{3}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mn>9</mn>
<mo>&gt;</mo>
<mn>8</mn>
<mo>=</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mn>3</mn>
</mrow>
</msup>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle 9&gt;8=2^{3}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle 9&gt;8=2^{3}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fc6aa3b743ffc4de7d75d22ec4e30b93ae86037" style="vertical-align: -0.338ex; width:10.739ex; height:2.676ex;"/></span> leads to <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle 3&gt;2^{3/2}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mn>3</mn>
<mo>&gt;</mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mn>3</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
</mrow>
</msup>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle 3&gt;2^{3/2}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle 3&gt;2^{3/2}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/289041b8c90d373cd5129f1c257ef854de064e4c" style="vertical-align: -0.338ex; width:8.122ex; height:2.843ex;"/></span>, which for odd <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> leads to
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{h}=3\cdot 2^{(h-1)/2}-2={\bigl (}3\cdot 2^{-3/2}{\bigr )}\cdot 2^{(h+2)/2}-2&gt;2\cdot 2^{h/2}-2}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
</mrow>
</msub>
<mo>=</mo>
<mn>3</mn>
<mo>⋅<!-- ⋅ --></mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
<mo>=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-OPEN">
<mo maxsize="1.2em" minsize="1.2em">(</mo>
</mrow>
</mrow>
<mn>3</mn>
<mo>⋅<!-- ⋅ --></mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo>−<!-- − --></mo>
<mn>3</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
</mrow>
</msup>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-CLOSE">
<mo maxsize="1.2em" minsize="1.2em">)</mo>
</mrow>
</mrow>
<mo>⋅<!-- ⋅ --></mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">(</mo>
<mi>h</mi>
<mo>+</mo>
<mn>2</mn>
<mo stretchy="false">)</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
<mo>&gt;</mo>
<mn>2</mn>
<mo>⋅<!-- ⋅ --></mo>
<msup>
<mn>2</mn>
<mrow class="MJX-TeXAtom-ORD">
<mi>h</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
</mrow>
</msup>
<mo>−<!-- − --></mo>
<mn>2</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{h}=3\cdot 2^{(h-1)/2}-2={\bigl (}3\cdot 2^{-3/2}{\bigr )}\cdot 2^{(h+2)/2}-2&gt;2\cdot 2^{h/2}-2}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{h}=3\cdot 2^{(h-1)/2}-2={\bigl (}3\cdot 2^{-3/2}{\bigr )}\cdot 2^{(h+2)/2}-2&gt;2\cdot 2^{h/2}-2}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/11105813afbd3e754a837dae4eb53795fdf60696" style="vertical-align: -1.005ex; width:60.712ex; height:3.509ex;"/></span>.</dd></dl>
<p>So in the even as well as the odd case, <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h}</annotation>
</semantics>
</math></span><img alt="h" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;"/></span> is in the interval
</p>
<table>
<tbody><tr>
<td style="width:1.0em;"></td>
<td style="text-align:right;"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \log _{2}(n+1)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \log _{2}(n+1)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \log _{2}(n+1)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2b6cf3670e9abb9beb47857d021a9041b5dd0d86" style="vertical-align: -0.838ex; width:11.233ex; height:2.843ex;"/></span></td>
<td style="width:8em;text-align:center"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \leq h\leq }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>≤<!-- ≤ --></mo>
<mi>h</mi>
<mo>≤<!-- ≤ --></mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \leq h\leq }</annotation>
</semantics>
</math></span><img alt="{\displaystyle \leq h\leq }" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e08ed3492f48a8378d27964ad456b9f3819cca02" style="vertical-align: -0.505ex; width:6.246ex; height:2.343ex;"/></span></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle 2\log _{2}(n+2)-2=2\log _{2}(n/2+1)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mn>2</mn>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mn>2</mn>
<mo stretchy="false">)</mo>
<mo>−<!-- − --></mo>
<mn>2</mn>
<mo>=</mo>
<mn>2</mn>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo>/</mo>
</mrow>
<mn>2</mn>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle 2\log _{2}(n+2)-2=2\log _{2}(n/2+1)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle 2\log _{2}(n+2)-2=2\log _{2}(n/2+1)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f1abef9acd4fa5ebef2bf3a5f58eefd06336248c" style="vertical-align: -0.838ex; width:34.991ex; height:2.843ex;"/></span></td>
<td style="width:12em;text-align:right"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\bigl [}&lt;2\log _{2}(n+1)\;{\bigr ]}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-OPEN">
<mo maxsize="1.2em" minsize="1.2em">[</mo>
</mrow>
</mrow>
<mo>&lt;</mo>
<mn>2</mn>
<msub>
<mi>log</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mo stretchy="false">(</mo>
<mi>n</mi>
<mo>+</mo>
<mn>1</mn>
<mo stretchy="false">)</mo>
<mspace width="thickmathspace"></mspace>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-CLOSE">
<mo maxsize="1.2em" minsize="1.2em">]</mo>
</mrow>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\bigl [}&lt;2\log _{2}(n+1)\;{\bigr ]}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\bigl [}&lt;2\log _{2}(n+1)\;{\bigr ]}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a0c1043c587524d2a645896481b77387cb1ca96e" style="vertical-align: -1.005ex; width:18.465ex; height:3.176ex;"/></span>
</td></tr>
<tr>
<td></td>
<td>(perfect binary tree)</td>
<td></td>
<td style="text-align:left;">(minimal red–black tree)
</td></tr></tbody></table>
<p>with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> being the number of nodes.<sup class="reference" id="cite_ref-34">[34]</sup>
</p>
<dl><dt>Conclusion</dt></dl>
<p>A red–black tree with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> nodes (keys) has tree height <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle h\in O(\log n).}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>h</mi>
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
<mo>.</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle h\in O(\log n).}</annotation>
</semantics>
</math></span><img alt="{\displaystyle h\in O(\log n).}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4ef0d66e05a531eac2823ef294cd01ff07908a5f" style="vertical-align: -0.838ex; width:13.163ex; height:2.843ex;"/></span>
</p>
<h2><span class="mw-headline" id="Set_operations_and_bulk_operations">Set operations and bulk operations</span><span class="mw-editsection"></span></h2>
<p>In addition to the single-element insert, delete and lookup operations, several set operations have been defined on <span class="nowrap">red–black trees:</span> union, intersection and set difference. Then fast <i>bulk</i> operations on insertions or deletions can be implemented based on these set functions. These set operations rely on two helper operations, <i>Split</i> and <i>Join</i>. With the new operations, the implementation of red–black trees can be more efficient and highly-parallelizable.<sup class="reference" id="cite_ref-join-based_35-0">[35]</sup> In order to achieve its time complexities this implementation requires that the root is allowed to be either red or black, and that every node stores its own <b>black height</b>.
</p>
<ul><li><i>Join</i>: The function <i>Join</i> is on two red–black trees <span class="texhtml"><i>t</i><sub>1</sub></span> and <span class="texhtml"><i>t</i><sub>2</sub></span> and a key <span class="texhtml mvar" style="font-style:italic;">k</span>, where <span class="texhtml"><i>t</i><sub>1</sub> &lt; <i>k</i> &lt; <i>t</i><sub>2</sub></span>, i.e. all keys in <span class="texhtml"><i>t</i><sub>1</sub></span> are less than <span class="texhtml mvar" style="font-style:italic;">k</span>, and all keys in <span class="texhtml"><i>t</i><sub>2</sub></span> are greater than <span class="texhtml mvar" style="font-style:italic;">k</span>. It returns a tree containing all elements in <span class="texhtml"><i>t</i><sub>1</sub></span>, <span class="texhtml"><i>t</i><sub>2</sub></span> as well as <span class="texhtml mvar" style="font-style:italic;">k</span>.</li></ul>
<dl><dd>If the two trees have the same black height, <i>Join</i> simply creates a new node with left subtree <span class="texhtml"><i>t</i><sub>1</sub></span>, root <span class="texhtml mvar" style="font-style:italic;">k</span> and right subtree <span class="texhtml"><i>t</i><sub>2</sub></span>. If both <span class="texhtml"><i>t</i><sub>1</sub></span> and <span class="texhtml"><i>t</i><sub>2</sub></span> have black root, set <span class="texhtml mvar" style="font-style:italic;">k</span> to be red. Otherwise <span class="texhtml mvar" style="font-style:italic;">k</span> is set black.</dd>
<dd>If the black heights are unequal, suppose that <span class="texhtml"><i>t</i><sub>1</sub></span> has larger black height than <span class="texhtml"><i>t</i><sub>2</sub></span> (the other case is symmetric). <i>Join</i> follows the right spine of <span class="texhtml"><i>t</i><sub>1</sub></span> until a black node <span class="texhtml mvar" style="font-style:italic;">c</span>, which is balanced with <span class="texhtml"><i>t</i><sub>2</sub></span>. At this point a new node with left child <span class="texhtml mvar" style="font-style:italic;">c</span>, root <span class="texhtml mvar" style="font-style:italic;">k</span> (set to be red) and right child <span class="texhtml"><i>t</i><sub>2</sub></span> is created to replace c. The new node may invalidate the red–black invariant because at most three red nodes can appear in a row. This can be fixed with a double rotation. If double red issue propagates to the root, the root is then set to be black, restoring the properties. The cost of this function is the difference of the black heights between the two input trees.</dd></dl>
<ul><li><i>Split</i>: To split a red–black tree into two smaller trees, those smaller than key <span class="texhtml mvar" style="font-style:italic;">x</span>, and those larger than key <span class="texhtml mvar" style="font-style:italic;">x</span>, first draw a path from the root by inserting <span class="texhtml mvar" style="font-style:italic;">x</span> into the red–black tree. After this insertion, all values less than <span class="texhtml mvar" style="font-style:italic;">x</span> will be found on the left of the path, and all values greater than <span class="texhtml mvar" style="font-style:italic;">x</span> will be found on the right. By applying <i>Join</i>, all the subtrees on the left side are merged bottom-up using keys on the path as intermediate nodes from bottom to top to form the left tree, and the right part is symmetric.</li></ul>
<dl><dd>For some applications, <i>Split</i> also returns a boolean value denoting if <span class="texhtml mvar" style="font-style:italic;">x</span> appears in the tree. The cost of <i>Split</i> is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log n),}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
<mo>,</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log n),}</annotation>
</semantics>
</math></span><img alt="{\displaystyle O(\log n),}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d698e277a7d13ddd8b334d95be0e73986fd0cb64" style="vertical-align: -0.838ex; width:8.983ex; height:2.843ex;"/></span> order of the height of the tree. This algorithm actually has nothing to do with any special properties of a red–black tree, and may be used on any tree with a <i>join</i> operation, such as an AVL tree.</dd></dl>
<p>The join algorithm is as follows:
</p>
<pre><b>function</b> joinRightRB(T<sub>L</sub>, k, T<sub>R</sub>):
    <b>if</b> (T<sub>L</sub>.color=black) and (T<sub>L</sub>.blackHeight=T<sub>R</sub>.blackHeight):
        <b>return</b> Node(T<sub>L</sub>,⟨k,red⟩,T<sub>R</sub>)
    T'=Node(T<sub>L</sub>.left,⟨T<sub>L</sub>.key,T<sub>L</sub>.color⟩,joinRightRB(T<sub>L</sub>.right,k,T<sub>R</sub>))
    <b>if</b> (T<sub>L</sub>.color=black) and (T'.right.color=T'.right.right.color=red):
        T'.right.right.color=black;
        <b>return</b> rotateLeft(T')
    <b>return</b> T' /* T<span style="padding-right:.15em;">'</span>'[recte T'] */

<b>function</b> joinLeftRB(T<sub>L</sub>, k, T<sub>R</sub>):
  /* symmetric to joinRightRB */

<b>function</b> join(T<sub>L</sub>, k, T<sub>R</sub>):
    <b>if</b> T<sub>L</sub>.blackHeight&gt;T<sub>R</sub>.blackHeight:
        T'=joinRightRB(T<sub>L</sub>,k,T<sub>R</sub>)
        <b>if</b> (T'.color=red) and (T'.right.color=red):
            T'.color=black
        <b>return</b> T'
    <b>if</b> T<sub>R</sub>.blackHeight&gt;T<sub>L</sub>.blackHeight:
        /* symmetric */
    <b>if</b> (T<sub>L</sub>.color=black) and (T<sub>R</sub>.color=black):
        <b>return</b> Node(T<sub>L</sub>,⟨k,red⟩,T<sub>R</sub>)
    <b>return</b> Node(T<sub>L</sub>,⟨k,black⟩,T<sub>R</sub>)
</pre>
<p>The split algorithm is as follows:
</p>
<pre><b>function</b> split(T, k):
    <b>if</b> (T = nil) <b>return</b> (nil, false, nil)
    <b>if</b> (k = T.key) <b>return</b> (T.left, true, T.right)
    <b>if</b> (k &lt; T.key):
        (L',b,R') = split(T.left, k)
        <b>return</b> (L',b,join(R',T.key,T.right))
    (L',b,R') = split(T.right, k)
    <b>return</b> (join(T.left,T.key,L'),b,T.right)
</pre>
<p>The union of two red–black trees <span class="texhtml"><i>t</i><sub>1</sub></span> and <span class="texhtml"><i>t</i><sub>2</sub></span> representing sets <span class="texhtml mvar" style="font-style:italic;">A</span> and <span class="texhtml mvar" style="font-style:italic;">B</span>, is a red–black tree <span class="texhtml mvar" style="font-style:italic;">t</span> that represents <span class="texhtml"><i>A</i> ∪ <i>B</i></span>. The following recursive function computes this union:
</p>
<pre><b>function</b> union(t<sub>1</sub>, t<sub>2</sub>):
    <b>if</b> t<sub>1</sub> = nil <b>return</b> t<sub>2</sub>
    <b>if</b> t<sub>2</sub> = nil <b>return</b> t<sub>1</sub>
    (L<sub>1</sub>,b,R<sub>1</sub>)=split(t<sub>1</sub>,t<sub>2</sub>.key)
    proc1=<b>start</b>:
        T<sub>L</sub>=union(L<sub>1</sub>,t<sub>2</sub>.left)
    proc2=<b>start</b>:
        T<sub>R</sub>=union(R<sub>1</sub>,t<sub>2</sub>.right)
    <b>wait all</b> proc1,proc2
    <b>return</b> join(T<sub>L</sub>, t<sub>2</sub>.key, T<sub>R</sub>)
</pre>
<p>Here, <i>split</i> is presumed to return two trees: one holding the keys less its input key, one holding the greater keys. (The algorithm is non-destructive, but an in-place destructive version exists as well.)
</p><p>The algorithm for intersection or difference is similar, but requires the <i>Join2</i> helper routine that is the same as <i>Join</i> but without the middle key. Based on the new functions for union, intersection or difference, either one key or multiple keys can be inserted to or deleted from the red–black tree. Since <i>Split</i> calls <i>Join</i> but does not deal with the balancing criteria of red–black trees directly, such an implementation is usually called the "join-based" implementation.
</p><p>The complexity of each of union, intersection and difference is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O\left(m\log \left({n \over m}+1\right)\right)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mi>m</mi>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow class="MJX-TeXAtom-ORD">
<mfrac>
<mi>n</mi>
<mi>m</mi>
</mfrac>
</mrow>
<mo>+</mo>
<mn>1</mn>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O\left(m\log \left({n \over m}+1\right)\right)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle O\left(m\log \left({n \over m}+1\right)\right)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0cd2f7cee37ecf49ccaf8ef28ee006cb55f6b95b" style="vertical-align: -1.838ex; width:19.99ex; height:4.843ex;"/></span> for two red–black trees of sizes <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>m</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m}</annotation>
</semantics>
</math></span><img alt="m" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0a07d98bb302f3856cbabc47b2b9016692e3f7bc" style="vertical-align: -0.338ex; width:2.04ex; height:1.676ex;"/></span> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n(\geq m)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
<mo stretchy="false">(</mo>
<mo>≥<!-- ≥ --></mo>
<mi>m</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n(\geq m)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle n(\geq m)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8999105a5cf1555933b40c34c91d4a78a3c9b487" style="vertical-align: -0.838ex; width:7.698ex; height:2.843ex;"/></span>. This complexity is optimal in terms of the number of comparisons. More importantly, since the recursive calls to union, intersection or difference are independent of each other, they can be executed in parallel with a parallel depth <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log m\log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>m</mi>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log m\log n)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle O(\log m\log n)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b79240ec677da2c426ef4db2f50ff29a86cc233c" style="vertical-align: -0.838ex; width:14.123ex; height:2.843ex;"/></span>.<sup class="reference" id="cite_ref-join-based_35-1">[35]</sup> When <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m=1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>m</mi>
<mo>=</mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m=1}</annotation>
</semantics>
</math></span><img alt="m=1" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b6100c5ebd48c6fd848709f2be624465203eb173" style="vertical-align: -0.338ex; width:6.301ex; height:2.176ex;"/></span>, the join-based implementation has the same computational directed acyclic graph (DAG) as single-element insertion and deletion if the root of the larger tree is used to split the smaller tree.
</p>
<h2><span class="mw-headline" id="Parallel_algorithms">Parallel algorithms</span><span class="mw-editsection"></span></h2>
<p>Parallel algorithms for constructing red–black trees from sorted lists of items can run in constant time or <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(\log \log n)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>n</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(\log \log n)}</annotation>
</semantics>
</math></span><img alt="O(\log \log n)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a9f3ded7e013a35c8039ff3276bee6e183d7f1a7" style="vertical-align: -0.838ex; width:11.695ex; height:2.843ex;"/></span> time, depending on the computer model, if the number of processors available is asymptotically proportional to the number <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span> of items where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n\to \infty }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
<mo stretchy="false">→<!-- → --></mo>
<mi mathvariant="normal">∞<!-- ∞ --></mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n\to \infty }</annotation>
</semantics>
</math></span><img alt="n\to \infty " aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a0d55d9b32f6fa8fab6a84ea444a6b5a24bb45e1" style="vertical-align: -0.338ex; width:7.333ex; height:1.843ex;"/></span>. Fast search, insertion, and deletion parallel algorithms are also known.<sup class="reference" id="cite_ref-36">[36]</sup>
</p><p>The join-based algorithms for red–black trees are parallel for bulk operations, including union, intersection, construction, filter, map-reduce, and so on.
</p>
<h3><span class="mw-headline" id="Parallel_bulk_operations">Parallel bulk operations</span><span class="mw-editsection"></span></h3>
<p>Basic operations like insertion, removal or update can be parallelised by defining operations that process bulks of multiple elements. It is also possible to process bulks with several basic operations, for example bulks may contain elements to insert and also elements to remove from the tree.
</p><p>The algorithms for bulk operations aren’t just applicable to the red–black tree, but can be adapted to other sorted sequence data structures as well, like the 2–3 tree, 2–3–4 tree and (a,b)-tree. In the following different algorithms for bulk insert will be explained, but the same algorithms can also be applied to removal and update. Bulk insert is an operation that inserts each element of a sequence <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> into a tree <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span>.
</p>
<h4><span class="mw-headline" id="Join-based">Join-based</span><span class="mw-editsection"></span></h4>
<p>This approach can be applied to every sorted sequence data structure that supports efficient join- and split-operations.<sup class="reference" id="cite_ref-37">[37]</sup>
The general idea is to split <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span> in multiple parts and perform the insertions on these parts in parallel.
</p>
<ol><li>First the bulk <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> of elements to insert has to be sorted.</li>
<li>After that, the algorithm splits <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> into <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k\in \mathbb {N} ^{+}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
<mo>∈<!-- ∈ --></mo>
<msup>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="double-struck">N</mi>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mo>+</mo>
</mrow>
</msup>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k\in \mathbb {N} ^{+}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle k\in \mathbb {N} ^{+}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6c8abd3366b703d9dc620115174fe692aeb5ded4" style="vertical-align: -0.338ex; width:7.241ex; height:2.509ex;"/></span> parts <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \langle I_{1},\cdots ,I_{k}\rangle }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo fence="false" stretchy="false">⟨<!-- ⟨ --></mo>
<msub>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>⋯<!-- ⋯ --></mo>
<mo>,</mo>
<msub>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
</mrow>
</msub>
<mo fence="false" stretchy="false">⟩<!-- ⟩ --></mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \langle I_{1},\cdots ,I_{k}\rangle }</annotation>
</semantics>
</math></span><img alt="{\displaystyle \langle I_{1},\cdots ,I_{k}\rangle }" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1ce29ad08fbed606cec3c147cecccb40eae2fc70" style="vertical-align: -0.838ex; width:11.177ex; height:2.843ex;"/></span> of about equal sizes.</li>
<li>Next the tree <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span> has to be split into <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k}</annotation>
</semantics>
</math></span><img alt="k" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;"/></span> parts <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \langle T_{1},\cdots ,T_{k}\rangle }" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo fence="false" stretchy="false">⟨<!-- ⟨ --></mo>
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>⋯<!-- ⋯ --></mo>
<mo>,</mo>
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
</mrow>
</msub>
<mo fence="false" stretchy="false">⟩<!-- ⟩ --></mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \langle T_{1},\cdots ,T_{k}\rangle }</annotation>
</semantics>
</math></span><img alt="{\displaystyle \langle T_{1},\cdots ,T_{k}\rangle }" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9a790afd93ad6b4f84edea3111d12beecf93f00f" style="vertical-align: -0.838ex; width:11.846ex; height:2.843ex;"/></span> in a way, so that for every <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle j\in \mathbb {N} ^{+}|\,1\leq j&lt;k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>j</mi>
<mo>∈<!-- ∈ --></mo>
<msup>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="double-struck">N</mi>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mo>+</mo>
</mrow>
</msup>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mspace width="thinmathspace"></mspace>
<mn>1</mn>
<mo>≤<!-- ≤ --></mo>
<mi>j</mi>
<mo>&lt;</mo>
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle j\in \mathbb {N} ^{+}|\,1\leq j&lt;k}</annotation>
</semantics>
</math></span><img alt="{\displaystyle j\in \mathbb {N} ^{+}|\,1\leq j&lt;k}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ebcf0163612ff9a0e01e7f9986fa67a81af8b69f" style="vertical-align: -0.838ex; margin-left: -0.027ex; width:17.577ex; height:3.009ex;"/></span> following constraints hold:
<ol><li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{last}}(I_{j})&lt;{\text{first}}(T_{j+1})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>last</mtext>
</mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
<mo>&lt;</mo>
<mrow class="MJX-TeXAtom-ORD">
<mtext>first</mtext>
</mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
<mo>+</mo>
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{last}}(I_{j})&lt;{\text{first}}(T_{j+1})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{last}}(I_{j})&lt;{\text{first}}(T_{j+1})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c1b71d729dc4e58bf17ae09de7a16e7e1761cc8e" style="vertical-align: -1.005ex; width:20.739ex; height:3.009ex;"/></span></li>
<li><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\text{last}}(T_{j})&lt;{\text{first}}(I_{j+1})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtext>last</mtext>
</mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
<mo>&lt;</mo>
<mrow class="MJX-TeXAtom-ORD">
<mtext>first</mtext>
</mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
<mo>+</mo>
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\text{last}}(T_{j})&lt;{\text{first}}(I_{j+1})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\text{last}}(T_{j})&lt;{\text{first}}(I_{j+1})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ea8ee23dcd957da50696ad1c86d69af56bcc84fb" style="vertical-align: -1.005ex; width:20.739ex; height:3.009ex;"/></span></li></ol></li>
<li>Now the algorithm inserts each element of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I_{j}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I_{j}}</annotation>
</semantics>
</math></span><img alt="I_{j}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b7cb04680c2246f78082e43ec912f72afe7af266" style="vertical-align: -1.005ex; width:1.933ex; height:2.843ex;"/></span> into <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{j}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{j}}</annotation>
</semantics>
</math></span><img alt="T_{j}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/27cdb9041c8aa769beb9153a48f41002297faacc" style="vertical-align: -1.005ex; width:2.267ex; height:2.843ex;"/></span> sequentially. This step has to be performed for every <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle j}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>j</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle j}</annotation>
</semantics>
</math></span><img alt="j" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2f461e54f5c093e92a55547b9764291390f0b5d0" style="vertical-align: -0.671ex; margin-left: -0.027ex; width:0.985ex; height:2.509ex;"/></span>, which can be done by up to <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k}</annotation>
</semantics>
</math></span><img alt="k" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;"/></span> processors in parallel.</li>
<li>Finally, the resulting trees will be joined to form the final result of the entire operation.</li></ol>
<p>Note that in Step 3 the constraints for splitting <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> assure that in Step 5 the trees can be joined again and the resulting sequence is sorted.
</p>
<ul class="gallery mw-gallery-traditional">
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
</ul>
<p>The pseudo code shows a simple divide-and-conquer implementation of the join-based algorithm for bulk-insert.
Both recursive calls can be executed in parallel.
The join operation used here differs from the version explained in this article, instead join2 is used, which misses the second parameter k.
</p>
<pre><b>bulkInsert</b>(T, I, k):
    I.sort()
    bulklInsertRec(T, I, k)

<b>bulkInsertRec</b>(T, I, k):
    <b>if</b> k = 1:
        <b>forall</b> e <b>in</b> I: T.insert(e)
    <b>else</b>
        m := ⌊size(I) / 2⌋
        (T<sub>1</sub>, _, T<sub>2</sub>) := split(T, I[m])
        bulkInsertRec(T<sub>1</sub>, I[0 .. m], ⌈k / 2⌉)
            || bulkInsertRec(T<sub>2</sub>, I[m + 1 .. size(I) - 1], ⌊k / 2⌋)
        T ← join2(T<sub>1</sub>, T<sub>2</sub>)
</pre>
<h5><span class="mw-headline" id="Execution_time">Execution time</span><span class="mw-editsection"></span></h5>
<p>Sorting <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> is not considered in this analysis.
</p>
<table class="wikitable">
<tbody><tr>
<td>#recursion levels</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log k)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>k</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log k)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log k)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/91dc9d45c1217d00379c59719e5d7d253a3519f9" style="vertical-align: -0.838ex; width:10.348ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>T(split) + T(join)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc333611d8c200a69a7eefad86d42fcee9cff5d5" style="vertical-align: -0.838ex; width:12.067ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>insertions per thread</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O\left({\frac {|I|}{k}}\right)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mfrac>
<mrow>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mrow>
<mi>k</mi>
</mfrac>
</mrow>
<mo>)</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O\left({\frac {|I|}{k}}\right)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O\left({\frac {|I|}{k}}\right)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0a3d3e6467e257ead7e32d06f511ef29369c4915" style="vertical-align: -2.505ex; width:11.079ex; height:6.343ex;"/></span>
</td></tr>
<tr>
<td>T(insert)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc333611d8c200a69a7eefad86d42fcee9cff5d5" style="vertical-align: -0.838ex; width:12.067ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td><b>T(bulkInsert) with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k}</annotation>
</semantics>
</math></span><img alt="k" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;"/></span> = #processors</b></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O\left(\log k\log |T|+{\frac {|I|}{k}}\log |T|\right)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mi>k</mi>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo>+</mo>
<mrow class="MJX-TeXAtom-ORD">
<mfrac>
<mrow>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mrow>
<mi>k</mi>
</mfrac>
</mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O\left(\log k\log |T|+{\frac {|I|}{k}}\log |T|\right)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O\left(\log k\log |T|+{\frac {|I|}{k}}\log |T|\right)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/eae5b656b733f4188e3f29155168a7d50078e348" style="vertical-align: -2.505ex; width:31.841ex; height:6.343ex;"/></span>
</td></tr></tbody></table>
<p>This can be improved by using parallel algorithms for splitting and joining.
In this case the execution time is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O\left(\log |T|+{\frac {|I|}{k}}\log |T|\right)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mrow>
<mo>(</mo>
<mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo>+</mo>
<mrow class="MJX-TeXAtom-ORD">
<mfrac>
<mrow>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mrow>
<mi>k</mi>
</mfrac>
</mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O\left(\log |T|+{\frac {|I|}{k}}\log |T|\right)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O\left(\log |T|+{\frac {|I|}{k}}\log |T|\right)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/536948661f840517e2ed25d8b147cf435de56561" style="vertical-align: -2.505ex; width:26.884ex; height:6.343ex;"/></span>.<sup class="reference" id="cite_ref-38">[38]</sup>
</p>
<h5><span class="mw-headline" id="Work">Work</span><span class="mw-editsection"></span></h5>
<table class="wikitable">
<tbody><tr>
<td>#splits, #joins</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(k)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>k</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(k)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(k)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e69ae4a8a037d2c6a9817f9b12ceb4daadcc7e4d" style="vertical-align: -0.838ex; width:6.989ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>W(split) + W(join)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc333611d8c200a69a7eefad86d42fcee9cff5d5" style="vertical-align: -0.838ex; width:12.067ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>#insertions</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(|I|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(|I|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(|I|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/99a53322f6b3ed859f9ab86718ea070677723c9f" style="vertical-align: -0.838ex; width:8.244ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>W(insert)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc333611d8c200a69a7eefad86d42fcee9cff5d5" style="vertical-align: -0.838ex; width:12.067ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td><b>W(bulkInsert)</b></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(k\log |T|+|I|\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>k</mi>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo>+</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(k\log |T|+|I|\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(k\log |T|+|I|\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d4a7b31e17730261147bbb2f3ae14b8eec3203e0" style="vertical-align: -0.838ex; width:25.647ex; height:2.843ex;"/></span>
</td></tr></tbody></table>
<h4><span class="mw-headline" id="Pipelining">Pipelining</span><span class="mw-editsection"></span></h4>
<p>Another method of parallelizing bulk operations is to use a pipelining approach.<sup class="reference" id="cite_ref-39">[39]</sup>
This can be done by breaking the task of processing a basic operation up into a sequence of subtasks.
For multiple basic operations the subtasks can be processed in parallel by assigning each subtask to a separate processor.
</p>
<ol><li>First the bulk <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> of elements to insert has to be sorted.</li>
<li>For each element in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> the algorithm locates the according insertion position in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span>. This can be done in parallel for each element <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in I}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in I}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/115150f88cabd4b520dc0251c17fe061dc4d9897" style="vertical-align: -0.338ex; width:3.367ex; height:2.176ex;"/></span> since <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span> won’t be mutated in this process. Now <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> has to be divided into subsequences <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle S}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>S</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle S}</annotation>
</semantics>
</math></span><img alt="S" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4611d85173cd3b508e67077d4a1252c9c05abca2" style="vertical-align: -0.338ex; width:1.499ex; height:2.176ex;"/></span> according to the insertion position of each element. For example <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{n,{\mathit {left}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">l</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">e</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">f</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">t</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{n,{\mathit {left}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle s_{n,{\mathit {left}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c7268d90e4ad5f06166867efe8de95be0086766d" style="vertical-align: -1.005ex; width:4.995ex; height:2.343ex;"/></span> is the subsequence of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> that contains the elements whose insertion position would be to the left of node <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>n</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n}</annotation>
</semantics>
</math></span><img alt="n" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a601995d55609f2d9f5e233e36fbe9ea26011b3b" style="vertical-align: -0.338ex; width:1.395ex; height:1.676ex;"/></span>.</li>
<li>The middle element <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{n,{\mathit {dir}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">d</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">i</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">r</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{n,{\mathit {dir}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{n,{\mathit {dir}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bff172765423252c4e5d89983180604e6ce223ed" style="vertical-align: -1.005ex; width:5.755ex; height:2.343ex;"/></span> of every subsequence <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{n,{\mathit {dir}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">d</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">i</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">r</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{n,{\mathit {dir}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle s_{n,{\mathit {dir}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1ff5967e5cddb49c4187a7d5725d8a9929101c60" style="vertical-align: -1.005ex; width:4.805ex; height:2.343ex;"/></span> will be inserted into <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span> as a new node <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle n'}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msup>
<mi>n</mi>
<mo>′</mo>
</msup>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle n'}</annotation>
</semantics>
</math></span><img alt="n'" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d215ec5b3d3b48ac8ec46e7131e7b3c091c9114e" style="vertical-align: -0.338ex; width:2.079ex; height:2.509ex;"/></span>. This can be done in parallel for each <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{n,{\mathit {dir}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">d</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">i</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">r</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{n,{\mathit {dir}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{n,{\mathit {dir}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bff172765423252c4e5d89983180604e6ce223ed" style="vertical-align: -1.005ex; width:5.755ex; height:2.343ex;"/></span> since by definition the insertion position of each <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{n,{\mathit {dir}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">d</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">i</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">r</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{n,{\mathit {dir}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{n,{\mathit {dir}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bff172765423252c4e5d89983180604e6ce223ed" style="vertical-align: -1.005ex; width:5.755ex; height:2.343ex;"/></span> is unique. If <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{n,{\mathit {dir}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">d</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">i</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">r</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{n,{\mathit {dir}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle s_{n,{\mathit {dir}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1ff5967e5cddb49c4187a7d5725d8a9929101c60" style="vertical-align: -1.005ex; width:4.805ex; height:2.343ex;"/></span> contains elements to the left or to the right of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle m_{n,{\mathit {dir}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>m</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">d</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">i</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">r</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle m_{n,{\mathit {dir}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle m_{n,{\mathit {dir}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bff172765423252c4e5d89983180604e6ce223ed" style="vertical-align: -1.005ex; width:5.755ex; height:2.343ex;"/></span>, those will be contained in a new set of subsequences <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle S}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>S</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle S}</annotation>
</semantics>
</math></span><img alt="S" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4611d85173cd3b508e67077d4a1252c9c05abca2" style="vertical-align: -0.338ex; width:1.499ex; height:2.176ex;"/></span> as <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{n',{\mathit {left}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<msup>
<mi>n</mi>
<mo>′</mo>
</msup>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">l</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">e</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">f</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">t</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{n',{\mathit {left}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle s_{n',{\mathit {left}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05dd2bb43c617237df9d93284f0f8323e4ef5cd3" style="vertical-align: -1.005ex; width:5.527ex; height:2.343ex;"/></span> or <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{n',{\mathit {right}}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<msup>
<mi>n</mi>
<mo>′</mo>
</msup>
<mo>,</mo>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mi class="MJX-tex-mathit" mathvariant="italic">r</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">i</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">g</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">h</mi>
<mi class="MJX-tex-mathit" mathvariant="italic">t</mi>
</mrow>
</mrow>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{n',{\mathit {right}}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle s_{n',{\mathit {right}}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2cad5a20028ec75a94a97d6066ca6c5f7980295e" style="vertical-align: -1.005ex; width:6.639ex; height:2.343ex;"/></span>.</li>
<li>Now <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span> possibly contains up to two consecutive red nodes at the end of the paths form the root to the leaves, which needs to be repaired. Note that, while repairing, the insertion position of elements <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in S}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>S</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in S}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in S}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/813129d6e4794d5b9c99a446b2c3683c29a539fc" style="vertical-align: -0.338ex; width:3.695ex; height:2.176ex;"/></span> have to be updated, if the corresponding nodes are affected by rotations.<br/>If two nodes have different nearest black ancestors, they can be repaired in parallel. Since at most four nodes can have the same nearest black ancestor, the nodes at the lowest level can be repaired in a constant number of parallel steps.<br/>This step will be applied successively to the black levels above until <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T}</annotation>
</semantics>
</math></span><img alt="T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ec7200acd984a1d3a3d7dc455e262fbe54f7f6e0" style="vertical-align: -0.338ex; width:1.636ex; height:2.176ex;"/></span> is fully repaired.</li>
<li>The steps 3 to 5 will be repeated on the new subsequences until <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle S}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>S</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle S}</annotation>
</semantics>
</math></span><img alt="S" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4611d85173cd3b508e67077d4a1252c9c05abca2" style="vertical-align: -0.338ex; width:1.499ex; height:2.176ex;"/></span> is empty. At this point every element <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in I}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in I}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/115150f88cabd4b520dc0251c17fe061dc4d9897" style="vertical-align: -0.338ex; width:3.367ex; height:2.176ex;"/></span> has been inserted. Each application of these steps is called a <i>stage</i>. Since the length of the subsequences in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle S}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>S</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle S}</annotation>
</semantics>
</math></span><img alt="S" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4611d85173cd3b508e67077d4a1252c9c05abca2" style="vertical-align: -0.338ex; width:1.499ex; height:2.176ex;"/></span> is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(|I|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(|I|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(|I|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/99a53322f6b3ed859f9ab86718ea070677723c9f" style="vertical-align: -0.838ex; width:8.244ex; height:2.843ex;"/></span> and in every stage the subsequences are being cut in half, the number of stages is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |I|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |I|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |I|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b2b1ee6732be28b2349b96f67b19e0b3cf0e0a1e" style="vertical-align: -0.838ex; width:11.602ex; height:2.843ex;"/></span>.<br/>Since all stages move up the black levels of the tree, they can be parallelised in a pipeline. Once a stage has finished processing one black level, the next stage is able to move up and continue at that level.</li></ol>
<ul class="gallery mw-gallery-traditional">
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
<li class="gallerybox" style="width: 155px"></li>
</ul>
<h5><span class="mw-headline" id="Execution_time_2">Execution time</span><span class="mw-editsection"></span></h5>
<p>Sorting <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle I}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>I</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle I}</annotation>
</semantics>
</math></span><img alt="I" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/535ea7fc4134a31cbe2251d9d3511374bc41be9f" style="vertical-align: -0.338ex; width:1.172ex; height:2.176ex;"/></span> is not considered in this analysis.
Also, <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle |I|}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle |I|}</annotation>
</semantics>
</math></span><img alt="|I|" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b81474b934a4f217048d45013e8088b97b1311ea" style="vertical-align: -0.838ex; width:2.465ex; height:2.843ex;"/></span> is assumed to be smaller than <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle |T|}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle |T|}</annotation>
</semantics>
</math></span><img alt="|T|" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/073a0b1ce9d4c91f30329289adbb91aae47f87ea" style="vertical-align: -0.838ex; width:2.93ex; height:2.843ex;"/></span>, otherwise it would be more efficient to construct the resulting tree from scratch.
</p>
<table class="wikitable">
<tbody><tr>
<td>T(find insert position)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc333611d8c200a69a7eefad86d42fcee9cff5d5" style="vertical-align: -0.838ex; width:12.067ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>#stages</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |I|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |I|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |I|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b2b1ee6732be28b2349b96f67b19e0b3cf0e0a1e" style="vertical-align: -0.838ex; width:11.602ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>T(insert) + T(repair)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc333611d8c200a69a7eefad86d42fcee9cff5d5" style="vertical-align: -0.838ex; width:12.067ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td><b>T(bulkInsert) with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle |I|}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle |I|}</annotation>
</semantics>
</math></span><img alt="|I|" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b81474b934a4f217048d45013e8088b97b1311ea" style="vertical-align: -0.838ex; width:2.465ex; height:2.843ex;"/></span> ~ #processors</b></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |I|+2\cdot \log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo>+</mo>
<mn>2</mn>
<mo>⋅<!-- ⋅ --></mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |I|+2\cdot \log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |I|+2\cdot \log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c9f3f6e104625df8a4ceb489f5c15c9750d7a83c" style="vertical-align: -0.838ex; width:23.573ex; height:2.843ex;"/></span><br/><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle =O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>=</mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle =O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle =O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6ea6f2f408c41050228af86dbd0d0cca6d738d26" style="vertical-align: -0.838ex; width:12.325ex; height:2.843ex;"/></span>
</td></tr></tbody></table>
<h5><span class="mw-headline" id="Work_2">Work</span><span class="mw-editsection"></span></h5>
<table class="wikitable">
<tbody><tr>
<td>W(find insert positions)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(|I|\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(|I|\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(|I|\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fe0ee05c7db84707429b4ad9da502bef02779494" style="vertical-align: -0.838ex; width:14.919ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>#insertions, #repairs</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(|I|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(|I|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(|I|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/99a53322f6b3ed859f9ab86718ea070677723c9f" style="vertical-align: -0.838ex; width:8.244ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td>W(insert) + W(repair)</td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc333611d8c200a69a7eefad86d42fcee9cff5d5" style="vertical-align: -0.838ex; width:12.067ex; height:2.843ex;"/></span>
</td></tr>
<tr>
<td><b>W(bulkInsert)</b></td>
<td><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \in O(2\cdot |I|\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mn>2</mn>
<mo>⋅<!-- ⋅ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \in O(2\cdot |I|\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \in O(2\cdot |I|\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/30dd9ec49c1ad9ba441306f19e94d357aa21d097" style="vertical-align: -0.838ex; width:17.761ex; height:2.843ex;"/></span><br/><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle =O(|I|\log |T|)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mo>=</mo>
<mi>O</mi>
<mo stretchy="false">(</mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>I</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>log</mi>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle =O(|I|\log |T|)}</annotation>
</semantics>
</math></span><img alt="{\displaystyle =O(|I|\log |T|)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e288bb46cec303392c726cbe6365d5608dd65909" style="vertical-align: -0.838ex; width:15.177ex; height:2.843ex;"/></span>
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Popular_culture">Popular culture</span><span class="mw-editsection"></span></h2>
<p>A red–black tree was referenced correctly in an episode of <i>Missing</i><sup class="reference" id="cite_ref-40">[40]</sup> as noted by Robert Sedgewick in one of his lectures:<sup class="reference" id="cite_ref-41">[41]</sup>
</p>
<dl><dd><b>Jess</b>: <q>It was the red door again.</q><br/><b>Pollock</b>: <q>I thought the red door was the storage container.</q><br/><b>Jess</b>: <q>But it wasn’t red anymore, it was black.</q><br/><b>Antonio</b>: <q>So red turning to black means what?</q><br/><b>Pollock</b>: <q>Budget deficits, red ink, black ink.</q><br/><b>Antonio</b>: <q>It could be from a binary search tree. The red–black tree tracks every simple path from a node to a descendant leaf that has the same number of black nodes.</q><br/><b>Jess</b>: <q>Does that help you with the ladies?</q></dd></dl>
<h2><span class="mw-headline" id="See_also">See also</span><span class="mw-editsection"></span></h2>
<ul><li>List of data structures</li>
<li>Tree data structure</li>
<li>Tree rotation</li>
<li>AA tree, a variation of the red–black tree</li>
<li>AVL tree</li>
<li>B-tree (2–3 tree, 2–3–4 tree, B+ tree, B*-tree, UB-tree)</li>
<li>Scapegoat tree</li>
<li>Splay tree</li>
<li>T-tree</li>
<li>WAVL tree</li></ul>
<h2><span class="mw-headline" id="References_and_notes">References and notes</span><span class="mw-editsection"></span></h2>
<style data-mw-deduplicate="TemplateStyles:r1011085734">.mw-parser-output .reflist{font-size:90%;margin-bottom:0.5em;list-style-type:decimal}.mw-parser-output .reflist .references{font-size:100%;margin-bottom:0;list-style-type:inherit}.mw-parser-output .reflist-columns-2{column-width:30em}.mw-parser-output .reflist-columns-3{column-width:25em}.mw-parser-output .reflist-columns{margin-top:0.3em}.mw-parser-output .reflist-columns ol{margin-top:0}.mw-parser-output .reflist-columns li{page-break-inside:avoid;break-inside:avoid-column}.mw-parser-output .reflist-upper-alpha{list-style-type:upper-alpha}.mw-parser-output .reflist-upper-roman{list-style-type:upper-roman}.mw-parser-output .reflist-lower-alpha{list-style-type:lower-alpha}.mw-parser-output .reflist-lower-greek{list-style-type:lower-greek}.mw-parser-output .reflist-lower-roman{list-style-type:lower-roman}</style>
<h2><span class="mw-headline" id="Further_reading">Further reading</span><span class="mw-editsection"></span></h2>
<ul><li>Mathworld: Red–Black Tree</li>
<li>San Diego State University: CS 660: Red–Black tree notes, by Roger Whitney</li>
<li><span class="anchor" id="Pfaff_b"></span> <link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation web cs1">Pfaff, Ben (June 2004). "Performance Analysis of BSTs in System Software" <span class="cs1-format">(PDF)</span>. Stanford University.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=unknown&amp;rft.btitle=Performance+Analysis+of+BSTs+in+System+Software&amp;rft.pub=Stanford+University&amp;rft.date=2004-06&amp;rft.aulast=Pfaff&amp;rft.aufirst=Ben&amp;rft_id=http%3A%2F%2Fwww.stanford.edu%2F~blp%2Fpapers%2Flibavl.pdf&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3ARed%E2%80%93black+tree"></span></li></ul>
<h2><span class="mw-headline" id="External_links">External links</span><span class="mw-editsection"></span></h2>
<ul><li><span class="anchor" id="Pfaff_a"></span>Ben Pfaff: <i>An Introduction to Binary Search Trees and Balanced Trees.</i> Free Software Foundation, Boston 2004, ftp.gnu.org (PDF gzip; 1662 kB)</li>
<li>A complete and working implementation in C</li>
<li>OCW MIT Lecture on Red-black Trees by Erik Demaine</li>
<li><span class="plainlinks">Binary Search Tree Insertion Visualization</span> on YouTube – Visualization of random and pre-sorted data insertions, in elementary binary search trees, and left-leaning red–black trees</li>
<li>An intrusive red–black tree written in C++</li>
<li>Red–black BSTs in 3.3 Balanced Search Trees</li>
<li>Red–black BST Demo</li></ul>


<!-- 
NewPP limit report
Parsed by mw2369
Cached time: 20221223235723
Cache expiry: 1814400
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.865 seconds
Real time usage: 1.103 seconds
Preprocessor visited node count: 7079/1000000
Post‐expand include size: 129730/2097152 bytes
Template argument size: 5477/2097152 bytes
Highest expansion depth: 16/100
Expensive parser function count: 16/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 187456/5000000 bytes
Lua time usage: 0.341/10.000 seconds
Lua memory usage: 9422106/52428800 bytes
Number of Wikibase entities loaded: 0/400
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  618.533      1 -total
 38.86%  240.336      1 Template:Reflist
 18.75%  115.982     12 Template:Cite_web
  8.36%   51.708      2 Template:Navbox
  8.08%   49.955      1 Template:CS-Trees
  7.99%   49.409      1 Template:Short_description
  7.64%   47.238      1 Template:Harvtxt
  7.08%   43.793     10 Template:Cite_book
  6.96%   43.037      6 Template:Rp
  6.47%   39.998      6 Template:R/superscript
-->
<!-- Saved in parser cache with key enwiki:pcache:idhash:26397-0!canonical and timestamp 20221223235722 and revision id 1128711287.
 -->
</div></body>
</html>