factorialSelected factorials; values in scientific notation are rounded0111223642451206720758409362103113912479136148715116201735518619121202251.5511025503.0411064701.197101001009.332101574501.73310114.02310236.4121010102.8461035251.205101001002.824104562052.50310118.263105101001010101.998In mathematics, the factorial of a non-negative , denoted , is the product of all positive integers less than or equal . The factorial  also equals the product of  with the next smaller factorial:For example,The value of 0! is 1, according to the convention for an empty product.[1]Factorials have been discovered in several ancient cultures, notably in Indian mathematics in the canonical works of Jain literature, and by Jewish mystics in the Talmudic book Sefer Yetzirah. The factorial operation is encountered in many areas of mathematics, notably in combinatorics, where its most basic use counts the possible distinct sequences – the permutations – of  distinct objects: there . In mathematical analysis, factorials are used in power series for the exponential function and other functions, and they also have applications in algebra, number theory, probability theory, and computer science.Much of the mathematics of the factorial function was developed beginning in the late 18th and early 19th centuries.Stirling's approximation provides an accurate approximation to the factorial of large numbers, showing that it grows more quickly than exponential growth. Legendre's formula describes the exponents of the prime numbers in a prime factorization of the factorials, and can be used to count the trailing zeros of the factorials. Daniel Bernoulli and Leonhard Euler interpolated the factorial function to a continuous function of complex numbers, except at the negative integers, the (offset) gamma function.Many other notable functions and number sequences are closely related to the factorials, including the binomial coefficients, double factorials, falling factorials, primorials, and subfactorials. Implementations of the factorial function are commonly used as an example of different computer programming styles, and are included in scientific calculators and scientific computing software libraries. Although directly computing large factorials using the product formula or recurrence is not efficient, faster algorithms are known, matching to within a constant factor the time for fast multiplication algorithms for numbers with the same number of digits.The concept of factorials has arisen independently in many cultures:In Indian mathematics, one of the earliest known descriptions of factorials comes from the Anuyogadvāra-sūtra,[2] one of the canonical works of Jain literature, which has been assigned dates varying from 300 BCE to 400 CE.[3] It separates out the sorted and reversed order of a set of items from the other ("mixed") orders, evaluating the number of mixed orders by subtracting two from the usual product formula for the factorial. The product rule for permutations was also described by 6th-century CE Jain monk Jinabhadra.[2] Hindu scholars have been using factorial formulas since at least 1150, when Bhāskara II mentioned factorials in his work Līlāvatī, in connection with a problem of how many ways Vishnu could hold his four characteristic objects (a conch shell, discus, mace, and lotus flower) in his four hands, and a similar problem for a ten-handed god.[4]In the mathematics of the Middle East, the Hebrew mystic book of creation Sefer Yetzirah, from the Talmudic period (200 to 500 CE), lists factorials up to 7! as part of an investigation into the number of words that can be formed from the Hebrew alphabet.[5][6] Factorials were also studied for similar reasons by 8th-century Arab grammarian Al-Khalil ibn Ahmad al-Farahidi.[5] Arab mathematician Ibn al-Haytham (also known as Alhazen, c. 965 – c. 1040) was the first to formulate Wilson's theorem connecting the factorials with the prime numbers.[7]In Europe, although Greek mathematics included some combinatorics, and Plato famously used 5040 (a factorial) as the population of an ideal community, in part because of its divisibility properties,[8] there is no direct evidence of ancient Greek study of factorials. Instead, the first work on factorials in Europe was by Jewish scholars such as Shabbethai Donnolo, explicating the Sefer Yetzirah passage.[9] In 1677, British author Fabian Stedman described the application of factorials to change ringing, a musical art involving the ringing of several tuned bells.[10][11]From the late 15th century onward, factorials became the subject of study by western mathematicians. In a 1494 treatise, Italian mathematician Luca Pacioli calculated factorials up to 11!, in connection with a problem of dining table arrangements.[12] Christopher Clavius discussed factorials in a 1603 commentary on the work of Johannes de Sacrobosco, and in the 1640s, French polymath Marin Mersenne published large (but not entirely correct) tables of factorials, up to 64!, based on the work of Clavius.[13] The power series for the exponential function, with the reciprocals of factorials for its coefficients, was first formulated in 1676 by Isaac Newton in a letter to Gottfried Wilhelm Leibniz.[14] Other important works of early European mathematics on factorials include extensive coverage in a 1685 treatise by John Wallis, a study of their approximate values for large values of  by Abraham de Moivre in 1721, a 1729 letter from James Stirling to de Moivre stating what became known as Stirling's approximation, and work at the same time by Daniel Bernoulli and Leonhard Euler formulating the continuous extension of the factorial function to the gamma function.[15] Adrien-Marie Legendre included Legendre's formula, describing the exponents in the factorization of factorials into prime powers, in an 1808 text on number theory.[16]The notation  for factorials was introduced by the French mathematician Christian Kramp in 1808.[17] Many other notations have also been used. Another later notation, in which the argument of the factorial was half-enclosed by the left and bottom sides of a box, was popular for some time in Britain and America but fell out of use, perhaps because it is difficult to typeset.[17] The word "factorial" (originally French: factorielle) was first used in 1800 by Louis François Antoine Arbogast,[18] in the first work on Faà di Bruno's formula,[19] but referring to a more general concept of products of arithmetic progressions. The "factors" that this name refers to are the terms of the product formula for the factorial.[20]The factorial function of a positive integer  is defined by the product of all positive integers not greater than [1]This may be written more concisely in product notation as[1]If this product formula is changed to keep all but the last term, it would define a product of the same form, for a smaller factorial. This leads to a recurrence relation, according to which each value of the factorial function can be obtained by multiplying the previous value :[21]For example, .The factorial  , or in symbols, . There are several motivations for this definition:For , the definition of  as a product involves the product of no numbers at all, and so is an example of the broader convention that the empty product, a product of no factors, is equal to the multiplicative identity.[22]There is exactly one permutation of zero objects: with nothing to permute, the only rearrangement is to do nothing.[21]This convention makes many identities in combinatorics valid for all valid choices of their parameters. For instance, the number of ways to choose all  elements from a set of  is  a binomial coefficient identity that would only be valid .[23]With , the recurrence relation for the factorial remains valid . Therefore, with this convention, a recursive computation of the factorial needs to have only the value for zero as a base case, simplifying the computation and avoiding the need for additional special cases.[24]Setting  allows for the compact expression of many formulae, such as the exponential function, as a power series: [14]This choice matches the gamma function , and the gamma function must have this value to be a continuous function.[25]The earliest uses of the factorial function involve counting permutations: there are  different ways of arranging  distinct objects into a sequence.[26] Factorials appear more broadly in many formulas in combinatorics, to account for different orderings of objects. For instance the binomial coefficients  count the -element combinations (subsets of  elements) from a set with  elements, and can be computed from factorials using the formula[27]  The Stirling numbers of the first kind sum to the factorials, and count the permutations  grouped into subsets with the same numbers of cycles.[28] Another combinatorial application is in counting derangements, permutations that do not leave any element in its original position; the number of derangements of  items is the nearest integer .[29]In algebra, the factorials arise through the binomial theorem, which uses binomial coefficients to expand powers of sums.[30] They also occur in the coefficients used to relate certain families of polynomials to each other, for instance in Newton's identities for symmetric polynomials.[31] Their use in counting permutations can also be restated algebraically: the factorials are the orders of finite symmetric groups.[32] In calculus, factorials occur in Faà di Bruno's formula for chaining higher derivatives.[19] In mathematical analysis, factorials frequently appear in the denominators of power series, most notably in the series for the exponential function,[14] and in the coefficients of other Taylor series (in particular those of the trigonometric and hyperbolic functions), where they cancel factors of  coming from the th derivative .[33] This usage of factorials in power series connects back to analytic combinatorics through the exponential generating function, which for a combinatorial class with  elements of  is defined as the power series[34] In number theory, the most salient property of factorials is the divisibility of  by all positive integers up , described more precisely for prime factors by Legendre's formula. It follows that arbitrarily large prime numbers can be found as the prime factors of the numbers, leading to a proof of Euclid's theorem that the number of primes is infinite.[35] When  is itself prime it is called a factorial prime;[36] relatedly, Brocard's problem, also posed by Srinivasa Ramanujan, concerns the existence of square numbers of the form .[37] In contrast, the numbers  must all be composite, proving the existence of arbitrarily large prime gaps.[38] An elementary proof of Bertrand's postulate on the existence of a prime in any interval of the , one of the first results of Paul Erdős, was based on the divisibility properties of factorials.[39][40] The factorial number system is a mixed radix notation for numbers in which the place values of each digit are factorials.[41]Factorials are used extensively in probability theory, for instance in the Poisson distribution[42] and in the probabilities of random permutations.[43] In computer science, beyond appearing in the analysis of brute-force searches over permutations,[44] factorials arise in the lower bound of  on the number of comparisons needed to comparison sort a set of  items,[45] and in the analysis of chained hash tables, where the distribution of keys per cell can be accurately approximated by a Poisson distribution.[46] Moreover, factorials naturally appear in formulae from quantum and statistical physics, where one often considers all the possible permutations of a set of particles. In statistical mechanics, calculations of entropy such as Boltzmann's entropy formula or the Sackur–Tetrode equation must correct the count of microstates by dividing by the factorials of the numbers of each type of indistinguishable particle to avoid the Gibbs paradox. Quantum physics provides the underlying reason for why these corrections are necessary.[47]As a function , the factorial has faster than exponential growth, but grows more slowly than a double exponential function.[48] Its growth rate is similar , but slower by an exponential factor. One way of approaching this result is by taking the natural logarithm of the factorial, which turns its product formula into a sum, and then estimating the sum by an integral:Exponentiating the result (and ignoring the negligible  term) approximates  as .[49]More carefully bounding the sum both above and below by an integral, using the trapezoid rule, shows that this estimate needs a correction factor proportional . The constant of proportionality for this correction can be found from the Wallis product, which expresses  as a limiting ratio of factorials and powers of two. The result of these corrections is Stirling's approximation:[50]Here, the  symbol means that, as  goes to infinity, the ratio between the left and right sides approaches one in the limit.Stirling's formula provides the first term in an asymptotic series that becomes even more accurate when taken to greater numbers of terms:[51]An alternative version uses only odd exponents in the correction terms:[51]Many other variations of these formulas have also been developed, by Srinivasa Ramanujan, Bill Gosper, and others.[51]The binary logarithm of the factorial, used to analyze comparison sorting, can be very accurately estimated using Stirling's approximation. In the formula below, the  term invokes big O notation.[45]The product formula for the factorial implies that  is divisible by all prime numbers that are at , and by no larger prime numbers.[52] More precise information about its divisibility is given by Legendre's formula, which gives the exponent of each prime  in the prime factorization of  as[53][54]Here  denotes the sum of the  digits , and the exponent given by this formula can also be interpreted in advanced mathematics as the -adic valuation of the factorial.[54] Applying Legendre's formula to the product formula for binomial coefficients produces Kummer's theorem, a similar result on the exponent of each prime in the factorization of a binomial coefficient.[55] Grouping the prime factors of the factorial into prime powers in different ways produces the multiplicative partitions of factorials.[56]The special case of Legendre's formula for  gives the number of trailing zeros in the decimal representation of the factorials.[57] According to this formula, the number of zeros can be obtained by subtracting the base-5 digits of  from , and dividing the result by four.[58] Legendre's formula implies that the exponent of the prime  is always larger than the exponent for , so each factor of five can be paired with a factor of two to produce one of these trailing zeros.[57] The leading digits of the factorials are distributed according to Benford's law.[59] Every sequence of digits, in any base, is the sequence of initial digits of some factorial number in that base.[60]Another result on divisibility of factorials, Wilson's theorem, states that  is divisible by  if and only if  is a prime number.[52] For any given , the Kempner function of  is given by the smallest  for which  divides .[61] For almost all numbers (all but a subset of exceptions with asymptotic density zero), it coincides with the largest prime factor .[62]The product of two factorials, , always evenly divides .[63] There are infinitely many factorials that equal the product of other factorials: if  is itself any product of factorials, then  equals that same product multiplied by one more factorial, . The only known examples of factorials that are products of other factorials but are not of this "trivial" form are , , and .[64] It would follow from the  conjecture that there are only finitely many nontrivial examples.[65]The greatest common divisor of the values of a primitive polynomial of degree  over the integers evenly divides .[63]There are infinitely many ways to extend the factorials to a continuous function.[66] The most widely used of these[67] uses the gamma function, which can be defined for positive real numbers as the integralThe resulting function is related to the factorial of a non-negative integer  by the equationwhich can be used as a definition of the factorial for non-integer arguments.At all values  for which both  and  are defined, the gamma function obeys the functional equationgeneralizing the recurrence relation for the factorials.[66]The same integral converges more generally for any complex number  whose real part is positive. It can be extended to the non-integer points in the rest of the complex plane by solving for Euler's reflection formulaHowever, this formula cannot be used at integers because, for them, the  term would produce a division by zero. The result of this extension process is an analytic function, the analytic continuation of the integral formula for the gamma function. It has a nonzero value at all complex numbers, except for the non-positive integers where it has simple poles. Correspondingly, this provides a definition for the factorial at all complex numbers other than the negative integers.[67]One property of the gamma function, distinguishing it from other continuous interpolations of the factorials, is given by the Bohr–Mollerup theorem, which states that the gamma function (offset by one) is the only log-convex function on the positive real numbers that interpolates the factorials and obeys the same functional equation. A related uniqueness theorem of Helmut Wielandt states that the complex gamma function and its scalar multiples are the only holomorphic functions on the positive complex half-plane that obey the functional equation and remain bounded for complex numbers with real part between 1 and 2.[68]Other complex functions that interpolate the factorial values include Hadamard's gamma function, which is an entire function over all the complex numbers, including the non-positive integers.[69][70] In the -adic numbers, it is not possible to continuously interpolate the factorial function directly, because the factorials of large integers (a dense subset of the -adics) converge to zero according to Legendre's formula, forcing any continuous function that is close to their values to be zero everywhere. Instead, the -adic gamma function provides a continuous interpolation of a modified form of the factorial, omitting the factors in the factorial that are divisible by .[71]The digamma function is the logarithmic derivative of the gamma function. Just as the gamma function provides a continuous interpolation of the factorials, offset by one, the digamma function provides a continuous interpolation of the harmonic numbers, offset by the Euler–Mascheroni constant.[72]The factorial function is a common feature in scientific calculators.[73] It is also included in scientific programming libraries such as the Python mathematical functions module[74] and the Boost C++ library.[75] If efficiency is not a concern, computing factorials is trivial: just successively multiply a variable initialized  by the integers up . The simplicity of this computation makes it a common example in the use of different computer programming styles and methods.[76]The computation of  can be expressed in pseudocode using iteration[77] asdefine factorial(n):  f := 1  for i := 1, 2, 3, ..., n:    f := f × i  return for using recursion[78] based on its recurrence relation asdefine factorial(n):  if n = 0 return 1  return n × factorial(n − 1)Other methods suitable for its computation include memoization,[79] dynamic programming,[80] and functional programming.[81] The computational complexity of these algorithms may be analyzed using the unit-cost random-access machine model of computation, in which each arithmetic operation takes constant time and each number uses a constant amount of storage space. In this model, these methods can compute  in time , and the iterative version uses space . Unless optimized for tail recursion, the recursive version takes linear space to store its call stack.[82] However, this model of computation is only suitable when  is small enough to allow  to fit into a machine word.[83] The values 12! and 20! are the largest factorials that can be stored in, respectively, the 32-bit[84] and 64-bit integers.[85] Floating point can represent larger factorials, but approximately rather than exactly, and will still overflow for factorials larger than .[84]The exact computation of larger factorials involves arbitrary-precision arithmetic, because of fast growth and integer overflow.  Time of computation can be analyzed as a function of the number of digits or bits in the result.[85] By Stirling's formula,  has  bits.[86] The Schönhage–Strassen algorithm can produce a -bit product in time , and faster multiplication algorithms taking time  are known.[87] However, computing the factorial involves repeated products, rather than a single multiplication, so these time bounds do not apply directly.  In this setting, computing  by multiplying the numbers from 1  in sequence is inefficient, because it involves  multiplications, a constant fraction of which take time  each, giving total time . A better approach is to perform the multiplications as a divide-and-conquer algorithm that multiplies a sequence of  numbers by splitting it into two subsequences of  numbers, multiplies each subsequence, and combines the results with one last multiplication. This approach to the factorial takes total time : one logarithm comes from the number of bits in the factorial, a second comes from the multiplication algorithm, and a third comes from the divide and conquer.[88]Even better efficiency is obtained by computing  from its prime factorization, based on the principle that exponentiation by squaring is faster than expanding an exponent into a product.[86][89] An algorithm for this by Arnold Schönhage begins by finding the list of the primes up , for instance using the sieve of Eratosthenes, and uses Legendre's formula to compute the exponent for each prime. Then it computes the product of the prime powers with these exponents, using a recursive algorithm, as follows:Use divide and conquer to compute the product of the primes whose exponents are oddDivide all of the exponents by two (rounding down to an integer), recursively compute the product of the prime powers with these smaller exponents, and square the resultMultiply together the results of the two previous stepsThe product of all primes up to  is an -bit number, by the prime number theorem, so the time for the first step is , with one logarithm coming from the divide and conquer and another coming from the multiplication algorithm. In the recursive calls to the algorithm, the prime number theorem can again be invoked to prove that the numbers of bits in the corresponding products decrease by a constant factor at each level of recursion, so the total time for these steps at all levels of recursion adds in a geometric series . The time for the squaring in the second step and the multiplication in the third step are again , because each is a single multiplication of a number with  bits. Again, at each level of recursion the numbers involved have a constant fraction as many bits (because otherwise repeatedly squaring them would produce too large a final result) so again the amounts of time for these steps in the recursive calls add in a geometric series . Consequentially, the whole algorithm takes , proportional to a single multiplication with the same number of bits in its result.[89]Several other integer sequences are similar to or related to the factorials:Alternating factorialThe alternating factorial is the absolute value of the alternating sum of the first  factorials, . These have mainly been studied in connection with their primality; only finitely many of them can be prime, but a complete list of primes of this form is not known.[90]Bhargava factorialThe Bhargava factorials are a family of integer sequences defined by Manjul Bhargava with similar number-theoretic properties to the factorials, including the factorials themselves as a special case.[63]Double factorialThe product of all the odd integers up to some odd positive  is called the double factorial , and denoted by .[91] That is,  For example, . Double factorials are used in trigonometric integrals,[92] in expressions for the gamma function at half-integers and the volumes of hyperspheres,[93] and in counting binary trees and perfect matchings.[91][94]Exponential factorialJust as triangular numbers sum the numbers from  , and factorials take their product, the exponential factorial exponentiates. The exponential factorial is defined recursively . For example, the exponential factorial of 4 is  These numbers grow much more quickly than regular factorials.[95]Falling factorialThe notations  or  are sometimes used to represent the product of the  integers counting up to and , equal to . This is also known as a falling factorial or backward factorial, and the  notation is a Pochhammer symbol.[96] Falling factorials count the number of different sequences of  distinct items that can be drawn from a universe of  items.[97] They occur as coefficients in the higher derivatives of polynomials,[98] and in the factorial moments of random variables.[99]HyperfactorialsThe hyperfactorial of  is the product . These numbers form the discriminants of Hermite polynomials.[100] They can be continuously interpolated by the K-function,[101] and obey analogues to Stirling's formula[102] and Wilson's theorem.[103]Jordan–Pólya numbersThe Jordan–Pólya numbers are the products of factorials, allowing repetitions. Every tree has a symmetry group whose number of symmetries is a Jordan–Pólya number, and every Jordan–Pólya number counts the symmetries of some tree.[104]PrimorialThe primorial  is the product of prime numbers less than or equal ; this construction gives them some similar divisibility properties to factorials,[36] but unlike factorials they are squarefree.[105] As with the factorial primes , researchers have studied primorial primes .[36]SubfactorialThe subfactorial yields the number of derangements of a set of  objects. It is sometimes denoted , and equals the closest integer .[29]SuperfactorialThe superfactorial of  is the product of the first  factorials. The superfactorials are continuously interpolated by the Barnes G-function.[106]OEIS sequence A000142 (Factorial numbers)"Factorial". Encyclopedia of Mathematics. EMS Press. 2001 [1994].