<!DOCTYPE html>
<html>
<head>
<title>Viterbi_algorithm</title>
</head>
<body>
<div class="mw-parser-output">
<p>The <b>Viterbi algorithm</b> is a dynamic programming algorithm for obtaining the maximum a posteriori probability estimate of the most likely sequence of hidden states—called the <b>Viterbi path</b>—that results in a sequence of observed events, especially in the context of Markov information sources and hidden Markov models (HMM).
</p><p>The algorithm has found universal application in decoding the convolutional codes used in both CDMA and GSM digital cellular, dial-up modems, satellite, deep-space communications, and 802.11 wireless LANs. It is now also commonly used in speech recognition, speech synthesis, diarization,<sup class="reference" id="cite_ref-1">[1]</sup> keyword spotting, computational linguistics, and bioinformatics. For example, in speech-to-text (speech recognition), the acoustic signal is treated as the observed sequence of events, and a string of text is considered to be the "hidden cause" of the acoustic signal. The Viterbi algorithm finds the most likely string of text given the acoustic signal.
</p>

<h2><span class="mw-headline" id="History">History</span><span class="mw-editsection"></span></h2>
<p>The Viterbi algorithm is named after Andrew Viterbi, who proposed it in 1967 as a decoding algorithm for convolutional codes over noisy digital communication links.<sup class="reference" id="cite_ref-2">[2]</sup> It has, however, a history of multiple invention, with at least seven independent discoveries, including those by Viterbi, Needleman and Wunsch, and Wagner and Fischer.<sup class="reference" id="cite_ref-slp_3-0">[3]</sup> It was introduced to Natural Language Processing as a method of part-of-speech tagging as early as 1987.
</p><p><i>Viterbi path</i> and <i>Viterbi algorithm</i> have become standard terms for the application of dynamic programming algorithms to maximization problems involving probabilities.<sup class="reference" id="cite_ref-slp_3-1">[3]</sup>
For example, in statistical parsing a dynamic programming algorithm can be used to discover the single most likely context-free derivation (parse) of a string, which is commonly called the "Viterbi parse".<sup class="reference" id="cite_ref-4">[4]</sup><sup class="reference" id="cite_ref-5">[5]</sup><sup class="reference" id="cite_ref-6">[6]</sup> Another application is in target tracking, where the track is computed that assigns a maximum likelihood to a sequence of observations.<sup class="reference" id="cite_ref-7">[7]</sup>
</p>
<h2><span class="mw-headline" id="Extensions">Extensions</span><span class="mw-editsection"></span></h2>
<p>A generalization of the Viterbi algorithm, termed the <i>max-sum algorithm</i> (or <i>max-product algorithm</i>) can be used to find the most likely assignment of all or some subset of latent variables in a large number of graphical models, e.g. Bayesian networks, Markov random fields and conditional random fields.  The latent variables need, in general, to be connected in a way somewhat similar to a hidden Markov model (HMM), with a limited number of connections between variables and some type of linear structure among the variables.  The general algorithm involves <i>message passing</i> and is substantially similar to the belief propagation algorithm (which is the generalization of the forward-backward algorithm).
</p><p>With the algorithm called iterative Viterbi decoding one can find the subsequence of an observation that matches best (on average) to a given hidden Markov model. This algorithm is proposed by Qi Wang et al. to deal with turbo code.<sup class="reference" id="cite_ref-8">[8]</sup> Iterative Viterbi decoding works by iteratively invoking a modified Viterbi algorithm, reestimating the score for a filler until convergence.
</p><p>An alternative algorithm, the Lazy Viterbi algorithm, has been proposed.<sup class="reference" id="cite_ref-9">[9]</sup> For many applications of practical interest, under reasonable noise conditions, the lazy decoder (using Lazy Viterbi algorithm) is much faster than the original Viterbi decoder (using Viterbi algorithm). While the original Viterbi algorithm calculates every node in the trellis of possible outcomes, the Lazy Viterbi algorithm maintains a prioritized list of nodes to evaluate in order, and the number of calculations required is typically fewer (and never more) than the ordinary Viterbi algorithm for the same result. However, it is not so easy<sup class="noprint Inline-Template" style="margin-left:0.1em; white-space:nowrap;">[<i><span title="The text near this tag may need clarification or removal of jargon. (November 2017)">clarification needed</span></i>]</sup> to parallelize in hardware.
</p>
<h2><span class="mw-headline" id="Pseudocode">Pseudocode</span><span class="mw-editsection"></span></h2>
<p>This algorithm generates a path <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle X=(x_{1},x_{2},\ldots ,x_{T})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>X</mi>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle X=(x_{1},x_{2},\ldots ,x_{T})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle X=(x_{1},x_{2},\ldots ,x_{T})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7b4a7988eca050457fffb7fb10ce63c1c8de3179" style="vertical-align: -0.838ex; width:20.587ex; height:2.843ex;"/></span>, which is a sequence of states <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle x_{n}\in S=\{s_{1},s_{2},\dots ,s_{K}\}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
</mrow>
</msub>
<mo>∈<!-- ∈ --></mo>
<mi>S</mi>
<mo>=</mo>
<mo fence="false" stretchy="false">{</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>K</mi>
</mrow>
</msub>
<mo fence="false" stretchy="false">}</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle x_{n}\in S=\{s_{1},s_{2},\dots ,s_{K}\}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle x_{n}\in S=\{s_{1},s_{2},\dots ,s_{K}\}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2bbae8566b4bcb91b1a82be3957a2906e10dd000" style="vertical-align: -0.838ex; width:25.597ex; height:2.843ex;"/></span> that generate the observations <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{T})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>Y</mi>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{T})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{T})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/508f770c743d4d15ee486bd2a4a31354ac58794e" style="vertical-align: -0.838ex; width:19.809ex; height:2.843ex;"/></span> with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle y_{n}\in O=\{o_{1},o_{2},\dots ,o_{N}\}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>n</mi>
</mrow>
</msub>
<mo>∈<!-- ∈ --></mo>
<mi>O</mi>
<mo>=</mo>
<mo fence="false" stretchy="false">{</mo>
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>N</mi>
</mrow>
</msub>
<mo fence="false" stretchy="false">}</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle y_{n}\in O=\{o_{1},o_{2},\dots ,o_{N}\}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle y_{n}\in O=\{o_{1},o_{2},\dots ,o_{N}\}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c5b91c6ebbba46933fc5fccf75e9b88bf5b5440c" style="vertical-align: -0.838ex; width:25.79ex; height:2.843ex;"/></span>, where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle N}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>N</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle N}</annotation>
</semantics>
</math></span><img alt="N" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f5e3890c981ae85503089652feb48b191b57aae3" style="vertical-align: -0.338ex; width:2.064ex; height:2.176ex;"/></span> is the number of possible observations in the observation space <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O}</annotation>
</semantics>
</math></span><img alt="O" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9d70e1d0d87e2ef1092ea1ffe2923d9933ff18fc" style="vertical-align: -0.338ex; width:1.773ex; height:2.176ex;"/></span>.
</p><p>Two 2-dimensional tables of size <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle K\times T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>K</mi>
<mo>×<!-- × --></mo>
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle K\times T}</annotation>
</semantics>
</math></span><img alt="{\displaystyle K\times T}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/47d34adb50f823118520209baaa814d9ae391265" style="vertical-align: -0.338ex; width:6.543ex; height:2.176ex;"/></span> are constructed:
</p>
<ul><li>Each element <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{1}[i,j]}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>i</mi>
<mo>,</mo>
<mi>j</mi>
<mo stretchy="false">]</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{1}[i,j]}</annotation>
</semantics>
</math></span><img alt="T_{1}[i,j]" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2320b540a1b58f4e19013217fc41277c0f37e72c" style="vertical-align: -0.838ex; width:6.5ex; height:2.843ex;"/></span> of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{1}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{1}}</annotation>
</semantics>
</math></span><img alt="T_{1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2f304724948a3ef606c4a92459e22b87a954d993" style="vertical-align: -0.671ex; width:2.412ex; height:2.509ex;"/></span> stores the probability of the most likely path so far <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\hat {X}}=({\hat {x}}_{1},{\hat {x}}_{2},\ldots ,{\hat {x}}_{j})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>X</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\hat {X}}=({\hat {x}}_{1},{\hat {x}}_{2},\ldots ,{\hat {x}}_{j})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\hat {X}}=({\hat {x}}_{1},{\hat {x}}_{2},\ldots ,{\hat {x}}_{j})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/108ea3676f49e0b224335a5f77ca9193ea576a3a" style="vertical-align: -1.005ex; width:20.107ex; height:3.509ex;"/></span> with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\hat {x}}_{j}=s_{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
<mo>=</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\hat {x}}_{j}=s_{i}}</annotation>
</semantics>
</math></span><img alt="{\hat {x}}_{j}=s_{i}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b3a809e0785d021081b37cb24ebe63adab8af7d2" style="vertical-align: -1.005ex; width:7.228ex; height:2.843ex;"/></span> that generates <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{j})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>Y</mi>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{j})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{j})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9d43b615dcb6f45c79c038eae49797a9eab0f85b" style="vertical-align: -1.005ex; width:19.329ex; height:3.009ex;"/></span>.</li>
<li>Each element <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{2}[i,j]}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>i</mi>
<mo>,</mo>
<mi>j</mi>
<mo stretchy="false">]</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{2}[i,j]}</annotation>
</semantics>
</math></span><img alt="T_{2}[i,j]" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05d50c23560da9a00b27c012a849493ab9600441" style="vertical-align: -0.838ex; width:6.5ex; height:2.843ex;"/></span> of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{2}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{2}}</annotation>
</semantics>
</math></span><img alt="T_{2}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d1ba5f12fbb0ff766aec6e22148b429373608555" style="vertical-align: -0.671ex; width:2.412ex; height:2.509ex;"/></span> stores <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\hat {x}}_{j-1}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\hat {x}}_{j-1}}</annotation>
</semantics>
</math></span><img alt="{\hat {x}}_{j-1}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4391609935af80a6dae59b639f4be7f33dd92399" style="vertical-align: -1.005ex; width:4.34ex; height:2.843ex;"/></span> of the most likely path so far <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\hat {X}}=({\hat {x}}_{1},{\hat {x}}_{2},\ldots ,{\hat {x}}_{j-1},{\hat {x}}_{j}=s_{i})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>X</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mover>
<mi>x</mi>
<mo stretchy="false">^<!-- ^ --></mo>
</mover>
</mrow>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
<mo>=</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\hat {X}}=({\hat {x}}_{1},{\hat {x}}_{2},\ldots ,{\hat {x}}_{j-1},{\hat {x}}_{j}=s_{i})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\hat {X}}=({\hat {x}}_{1},{\hat {x}}_{2},\ldots ,{\hat {x}}_{j-1},{\hat {x}}_{j}=s_{i})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/507d7ff4ee53f35b9a28dc6eb1400d03d557eefd" style="vertical-align: -1.005ex; width:30.47ex; height:3.509ex;"/></span> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \forall j,2\leq j\leq T}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi mathvariant="normal">∀<!-- ∀ --></mi>
<mi>j</mi>
<mo>,</mo>
<mn>2</mn>
<mo>≤<!-- ≤ --></mo>
<mi>j</mi>
<mo>≤<!-- ≤ --></mo>
<mi>T</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \forall j,2\leq j\leq T}</annotation>
</semantics>
</math></span><img alt="\forall j,2\leq j\leq T" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f82ece115aee39d96b4b741afccdadb57b51557a" style="vertical-align: -0.671ex; width:13.238ex; height:2.509ex;"/></span></li></ul>
<p>The table entries <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{1}[i,j],T_{2}[i,j]}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>i</mi>
<mo>,</mo>
<mi>j</mi>
<mo stretchy="false">]</mo>
<mo>,</mo>
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>i</mi>
<mo>,</mo>
<mi>j</mi>
<mo stretchy="false">]</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{1}[i,j],T_{2}[i,j]}</annotation>
</semantics>
</math></span><img alt="T_{1}[i,j],T_{2}[i,j]" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f082ff7d71143f6d54bcd37e7fad77d133ad989d" style="vertical-align: -0.838ex; width:14.034ex; height:2.843ex;"/></span> are filled by increasing order of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle K\cdot j+i}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>K</mi>
<mo>⋅<!-- ⋅ --></mo>
<mi>j</mi>
<mo>+</mo>
<mi>i</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle K\cdot j+i}</annotation>
</semantics>
</math></span><img alt="K\cdot j+i" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2396570fa0cc37f3412ab2518498816acdb9e85e" style="vertical-align: -0.671ex; width:8.346ex; height:2.509ex;"/></span>:
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{1}[i,j]=\max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>i</mi>
<mo>,</mo>
<mi>j</mi>
<mo stretchy="false">]</mo>
<mo>=</mo>
<munder>
<mo form="prefix" movablelimits="true">max</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
</mrow>
</munder>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">(</mo>
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>k</mi>
<mo>,</mo>
<mi>j</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">]</mo>
<mo>⋅<!-- ⋅ --></mo>
<msub>
<mi>A</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
<mi>i</mi>
</mrow>
</msub>
<mo>⋅<!-- ⋅ --></mo>
<msub>
<mi>B</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{1}[i,j]=\max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}</annotation>
</semantics>
</math></span><img alt="T_{1}[i,j]=\max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/824715dbe1d17d0203875dcedebc15322a67f91a" style="vertical-align: -2.005ex; width:37.873ex; height:4.009ex;"/></span>,</dd>
<dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{2}[i,j]=\operatorname {argmax} _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>i</mi>
<mo>,</mo>
<mi>j</mi>
<mo stretchy="false">]</mo>
<mo>=</mo>
<msub>
<mi>argmax</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
</mrow>
</msub>
<mo>⁡<!-- ⁡ --></mo>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">(</mo>
<msub>
<mi>T</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo stretchy="false">[</mo>
<mi>k</mi>
<mo>,</mo>
<mi>j</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo stretchy="false">]</mo>
<mo>⋅<!-- ⋅ --></mo>
<msub>
<mi>A</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
<mi>i</mi>
</mrow>
</msub>
<mo>⋅<!-- ⋅ --></mo>
<msub>
<mi>B</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle T_{2}[i,j]=\operatorname {argmax} _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle T_{2}[i,j]=\operatorname {argmax} _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/13d59ca07a0faf512617351b303d7d0bc9ab3ecb" style="vertical-align: -1.338ex; width:42.198ex; height:3.343ex;"/></span>,</dd></dl>
<p>with <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle A_{ki}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>A</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle A_{ki}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle A_{ki}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/dfec3e13f1e45143b38e8a283b9506bb21f535b5" style="vertical-align: -0.671ex; width:3.399ex; height:2.509ex;"/></span> and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle B_{iy_{j}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>B</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle B_{iy_{j}}}</annotation>
</semantics>
</math></span><img alt="B_{iy_{j}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/80f4caad4333a0276249f07d61743775563f75ed" style="vertical-align: -1.338ex; width:4.083ex; height:3.176ex;"/></span> as defined below. Note that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle B_{iy_{j}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>B</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle B_{iy_{j}}}</annotation>
</semantics>
</math></span><img alt="B_{iy_{j}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/80f4caad4333a0276249f07d61743775563f75ed" style="vertical-align: -1.338ex; width:4.083ex; height:3.176ex;"/></span> does not need to appear in the latter expression, as it's non-negative and independent of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k}</annotation>
</semantics>
</math></span><img alt="k" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;"/></span> and thus does not affect the argmax.
</p>
<dl><dt>Input</dt>
<dd></dd></dl>
<ul><li>The observation space <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O=\{o_{1},o_{2},\dots ,o_{N}\}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo>=</mo>
<mo fence="false" stretchy="false">{</mo>
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>N</mi>
</mrow>
</msub>
<mo fence="false" stretchy="false">}</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O=\{o_{1},o_{2},\dots ,o_{N}\}}</annotation>
</semantics>
</math></span><img alt="O=\{o_{1},o_{2},\dots ,o_{N}\}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/19134607bc8457ff571ae1189d2b8aa38c355d65" style="vertical-align: -0.838ex; width:20.592ex; height:2.843ex;"/></span>,</li>
<li>the state space <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle S=\{s_{1},s_{2},\dots ,s_{K}\}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>S</mi>
<mo>=</mo>
<mo fence="false" stretchy="false">{</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>K</mi>
</mrow>
</msub>
<mo fence="false" stretchy="false">}</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle S=\{s_{1},s_{2},\dots ,s_{K}\}}</annotation>
</semantics>
</math></span><img alt="S=\{s_{1},s_{2},\dots ,s_{K}\}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c96070224a1c01600876b19283092eda719c0680" style="vertical-align: -0.838ex; width:20.208ex; height:2.843ex;"/></span>,</li>
<li>an array of initial probabilities <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \Pi =(\pi _{1},\pi _{2},\dots ,\pi _{K})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi mathvariant="normal">Π<!-- Π --></mi>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mi>π<!-- π --></mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>π<!-- π --></mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>π<!-- π --></mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>K</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \Pi =(\pi _{1},\pi _{2},\dots ,\pi _{K})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \Pi =(\pi _{1},\pi _{2},\dots ,\pi _{K})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f9ef900ed41429a8cc7f364532904a225beffe0b" style="vertical-align: -0.838ex; width:20.64ex; height:2.843ex;"/></span> such that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \pi _{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>π<!-- π --></mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \pi _{i}}</annotation>
</semantics>
</math></span><img alt="\pi _{i}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/51bb06f24c5ba78c53df3a04cb60ba05ef6f08aa" style="vertical-align: -0.671ex; width:2.125ex; height:2.009ex;"/></span> stores the probability that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle x_{1}=s_{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>=</mo>
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle x_{1}=s_{i}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle x_{1}=s_{i}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5d1ad84bd4653eae5f2a7dfa47f0e78b684bedaa" style="vertical-align: -0.671ex; width:7.373ex; height:2.009ex;"/></span>,</li>
<li>a sequence of observations  <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{T})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>Y</mi>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{T})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle Y=(y_{1},y_{2},\ldots ,y_{T})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/508f770c743d4d15ee486bd2a4a31354ac58794e" style="vertical-align: -0.838ex; width:19.809ex; height:2.843ex;"/></span> such that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle y_{t}=o_{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
</mrow>
</msub>
<mo>=</mo>
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle y_{t}=o_{i}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle y_{t}=o_{i}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/29b17e890090fab37dce24ca1a5bea3e32b548a9" style="vertical-align: -0.671ex; width:6.991ex; height:2.009ex;"/></span> if the observation at time <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle t}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>t</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle t}</annotation>
</semantics>
</math></span><img alt="t" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/65658b7b223af9e1acc877d848888ecdb4466560" style="vertical-align: -0.338ex; width:0.84ex; height:2.009ex;"/></span> is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle o_{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle o_{i}}</annotation>
</semantics>
</math></span><img alt="o_{i}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c81b6f1251a0d2e12011a746b586c5fa9a132d48" style="vertical-align: -0.671ex; width:1.927ex; height:2.009ex;"/></span>,</li>
<li>transition matrix <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle A}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>A</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle A}</annotation>
</semantics>
</math></span><img alt="A" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7daff47fa58cdfd29dc333def748ff5fa4c923e3" style="vertical-align: -0.338ex; width:1.743ex; height:2.176ex;"/></span> of size <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle K\times K}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>K</mi>
<mo>×<!-- × --></mo>
<mi>K</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle K\times K}</annotation>
</semantics>
</math></span><img alt=" K\times K " aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/482213ed727088a54983b10499b51dd0e320ba5a" style="vertical-align: -0.338ex; width:6.972ex; height:2.176ex;"/></span> such that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle A_{ij}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>A</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle A_{ij}}</annotation>
</semantics>
</math></span><img alt="A_{ij}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8272b28f5aae6dbb8d6f829d58bab353b21bde20" style="vertical-align: -1.005ex; width:3.22ex; height:2.843ex;"/></span> stores the transition probability of transiting from state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{i}}</annotation>
</semantics>
</math></span><img alt="s_{i}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cfda82668232cbdc0874ed28ab8b6079420d1ffe" style="vertical-align: -0.671ex; width:1.89ex; height:2.009ex;"/></span> to state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{j}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{j}}</annotation>
</semantics>
</math></span><img alt="s_{j}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c6a350c64508aef872d4e72ee677746ef7a20f72" style="vertical-align: -1.005ex; width:2ex; height:2.343ex;"/></span>,</li>
<li>emission matrix <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle B}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>B</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle B}</annotation>
</semantics>
</math></span><img alt="B" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/47136aad860d145f75f3eed3022df827cee94d7a" style="vertical-align: -0.338ex; width:1.764ex; height:2.176ex;"/></span> of size <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle K\times N}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>K</mi>
<mo>×<!-- × --></mo>
<mi>N</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle K\times N}</annotation>
</semantics>
</math></span><img alt=" K\times N " aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e300e402f092212ce0793181707b764cd8dc5ec6" style="vertical-align: -0.338ex; width:6.97ex; height:2.176ex;"/></span> such that <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle B_{ij}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>B</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
<mi>j</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle B_{ij}}</annotation>
</semantics>
</math></span><img alt="B_{ij}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/57c134504644caba8b83f479c9f27dbfa990b79a" style="vertical-align: -1.005ex; width:3.241ex; height:2.843ex;"/></span> stores the probability of observing <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle o_{j}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>o</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>j</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle o_{j}}</annotation>
</semantics>
</math></span><img alt="o_{j}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0229f31d42e856d5af6aa970042abed37bce87f9" style="vertical-align: -1.005ex; width:2.037ex; height:2.343ex;"/></span> from  state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle s_{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>s</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle s_{i}}</annotation>
</semantics>
</math></span><img alt="s_{i}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cfda82668232cbdc0874ed28ab8b6079420d1ffe" style="vertical-align: -0.671ex; width:1.89ex; height:2.009ex;"/></span>.</li></ul>
<dl><dt>Output</dt></dl>
<ul><li>The most likely hidden state sequence <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle X=(x_{1},x_{2},\ldots ,x_{T})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>X</mi>
<mo>=</mo>
<mo stretchy="false">(</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle X=(x_{1},x_{2},\ldots ,x_{T})}</annotation>
</semantics>
</math></span><img alt="{\displaystyle X=(x_{1},x_{2},\ldots ,x_{T})}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7b4a7988eca050457fffb7fb10ce63c1c8de3179" style="vertical-align: -0.838ex; width:20.587ex; height:2.843ex;"/></span></li></ul>
<pre><b>function</b> <i>VITERBI</i><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (O,S,\Pi ,Y,A,B):X}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo stretchy="false">(</mo>
        <mi>O</mi>
        <mo>,</mo>
        <mi>S</mi>
        <mo>,</mo>
        <mi mathvariant="normal">Π<!-- Π --></mi>
        <mo>,</mo>
        <mi>Y</mi>
        <mo>,</mo>
        <mi>A</mi>
        <mo>,</mo>
        <mi>B</mi>
        <mo stretchy="false">)</mo>
        <mo>:</mo>
        <mi>X</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle (O,S,\Pi ,Y,A,B):X}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle (O,S,\Pi ,Y,A,B):X}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8f862713c1b65fae736416618fe4940619c8cc0b" style="vertical-align: -0.838ex; width:21.192ex; height:2.843ex;"/></span>
    <b>for</b> each state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle i=1,2,\ldots ,K}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
        <mo>,</mo>
        <mn>2</mn>
        <mo>,</mo>
        <mo>…<!-- … --></mo>
        <mo>,</mo>
        <mi>K</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle i=1,2,\ldots ,K}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle i=1,2,\ldots ,K}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8fadc079b16275a1f9e88ae77ce735e68218f812" style="vertical-align: -0.671ex; width:14.504ex; height:2.509ex;"/></span> <b>do</b>
        <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{1}[i,1]\leftarrow \pi _{i}\cdot B_{iy_{1}}}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>T</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">[</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mn>1</mn>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">←<!-- ← --></mo>
        <msub>
          <mi>π<!-- π --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
          </mrow>
        </msub>
        <mo>⋅<!-- ⋅ --></mo>
        <msub>
          <mi>B</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <msub>
              <mi>y</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mn>1</mn>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T_{1}[i,1]\leftarrow \pi _{i}\cdot B_{iy_{1}}}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle T_{1}[i,1]\leftarrow \pi _{i}\cdot B_{iy_{1}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8acc5bb635200df19e5af6c19b954d6846fddb54" style="vertical-align: -1.005ex; width:18.323ex; height:3.009ex;"/></span>
        <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{2}[i,1]\leftarrow 0}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>T</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">[</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mn>1</mn>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">←<!-- ← --></mo>
        <mn>0</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T_{2}[i,1]\leftarrow 0}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle T_{2}[i,1]\leftarrow 0}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1dd25e0e6d93d086ff5766a2220ee987e720239d" style="vertical-align: -0.838ex; width:11.481ex; height:2.843ex;"/></span>
    <b>end for</b>
    <b>for</b> each observation <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle j=2,3,\ldots ,T}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>j</mi>
        <mo>=</mo>
        <mn>2</mn>
        <mo>,</mo>
        <mn>3</mn>
        <mo>,</mo>
        <mo>…<!-- … --></mo>
        <mo>,</mo>
        <mi>T</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle j=2,3,\ldots ,T}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle j=2,3,\ldots ,T}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7bb7c7b0f71d7b63de91e48982dd742bfdb635f5" style="vertical-align: -0.671ex; margin-left: -0.027ex; width:14.257ex; height:2.509ex;"/></span> <b>do</b>
        <b>for</b> each state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle i=1,2,\ldots ,K}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
        <mo>,</mo>
        <mn>2</mn>
        <mo>,</mo>
        <mo>…<!-- … --></mo>
        <mo>,</mo>
        <mi>K</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle i=1,2,\ldots ,K}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle i=1,2,\ldots ,K}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8fadc079b16275a1f9e88ae77ce735e68218f812" style="vertical-align: -0.671ex; width:14.504ex; height:2.509ex;"/></span> <b>do</b>
            <span class="nowrap"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{1}[i,j]\gets \max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>T</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">[</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">←<!-- ← --></mo>
        <munder>
          <mo form="prefix" movablelimits="true">max</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">(</mo>
          <msub>
            <mi>T</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mn>1</mn>
            </mrow>
          </msub>
          <mo stretchy="false">[</mo>
          <mi>k</mi>
          <mo>,</mo>
          <mi>j</mi>
          <mo>−<!-- − --></mo>
          <mn>1</mn>
          <mo stretchy="false">]</mo>
          <mo>⋅<!-- ⋅ --></mo>
          <msub>
            <mi>A</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi>k</mi>
              <mi>i</mi>
            </mrow>
          </msub>
          <mo>⋅<!-- ⋅ --></mo>
          <msub>
            <mi>B</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi>i</mi>
              <msub>
                <mi>y</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>j</mi>
                </mrow>
              </msub>
            </mrow>
          </msub>
          <mo stretchy="false">)</mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T_{1}[i,j]\gets \max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle T_{1}[i,j]\gets \max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fb98964b82e1a51525e481e0c8d9e98ba82449a1" style="vertical-align: -2.005ex; width:38.389ex; height:4.009ex;"/></span></span>
            <span class="nowrap"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle T_{2}[i,j]\gets \arg \max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>T</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">[</mo>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>arg</mi>
        <mo>⁡<!-- ⁡ --></mo>
        <munder>
          <mo form="prefix" movablelimits="true">max</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">(</mo>
          <msub>
            <mi>T</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mn>1</mn>
            </mrow>
          </msub>
          <mo stretchy="false">[</mo>
          <mi>k</mi>
          <mo>,</mo>
          <mi>j</mi>
          <mo>−<!-- − --></mo>
          <mn>1</mn>
          <mo stretchy="false">]</mo>
          <mo>⋅<!-- ⋅ --></mo>
          <msub>
            <mi>A</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi>k</mi>
              <mi>i</mi>
            </mrow>
          </msub>
          <mo>⋅<!-- ⋅ --></mo>
          <msub>
            <mi>B</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mi>i</mi>
              <msub>
                <mi>y</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>j</mi>
                </mrow>
              </msub>
            </mrow>
          </msub>
          <mo stretchy="false">)</mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle T_{2}[i,j]\gets \arg \max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle T_{2}[i,j]\gets \arg \max _{k}{(T_{1}[k,j-1]\cdot A_{ki}\cdot B_{iy_{j}})}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/097f8e31a2e36ddb55370571b506a127356c8e18" style="vertical-align: -2.005ex; width:42.012ex; height:4.009ex;"/></span></span>
        <b>end for</b>
    <b>end for</b>
    <span class="nowrap"><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle z_{T}\gets \arg \max _{k}{(T_{1}[k,T])}}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msub>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>arg</mi>
        <mo>⁡<!-- ⁡ --></mo>
        <munder>
          <mo form="prefix" movablelimits="true">max</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </munder>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">(</mo>
          <msub>
            <mi>T</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mn>1</mn>
            </mrow>
          </msub>
          <mo stretchy="false">[</mo>
          <mi>k</mi>
          <mo>,</mo>
          <mi>T</mi>
          <mo stretchy="false">]</mo>
          <mo stretchy="false">)</mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle z_{T}\gets \arg \max _{k}{(T_{1}[k,T])}}</annotation>
  </semantics>
</math></span><img alt="z_{T}\gets \arg \max _{k}{(T_{1}[k,T])}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4f755f12badb37b9ed264f91414153e70d342a64" style="vertical-align: -2.005ex; width:23.817ex; height:4.009ex;"/></span></span>
    <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle x_{T}\leftarrow s_{z_{T}}}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>T</mi>
          </mrow>
        </msub>
        <mo stretchy="false">←<!-- ← --></mo>
        <msub>
          <mi>s</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>z</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>T</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle x_{T}\leftarrow s_{z_{T}}}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle x_{T}\leftarrow s_{z_{T}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/16fd4e0dd3c809d3c259f30c5aa5197f0a559bb8" style="vertical-align: -1.005ex; width:9.524ex; height:2.509ex;"/></span>
    <b>for</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle j=T,T-1,\ldots ,2}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>j</mi>
        <mo>=</mo>
        <mi>T</mi>
        <mo>,</mo>
        <mi>T</mi>
        <mo>−<!-- − --></mo>
        <mn>1</mn>
        <mo>,</mo>
        <mo>…<!-- … --></mo>
        <mo>,</mo>
        <mn>2</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle j=T,T-1,\ldots ,2}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle j=T,T-1,\ldots ,2}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/29210cb503a08e1bb5549045e732bdd02d02814f" style="vertical-align: -0.671ex; margin-left: -0.027ex; width:18.733ex; height:2.509ex;"/></span> <b>do</b>
        <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle z_{j-1}\leftarrow T_{2}[z_{j},j]}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mo>−<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">←<!-- ← --></mo>
        <msub>
          <mi>T</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">[</mo>
        <msub>
          <mi>z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mi>j</mi>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle z_{j-1}\leftarrow T_{2}[z_{j},j]}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle z_{j-1}\leftarrow T_{2}[z_{j},j]}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2fb3292a4c1098f60a4ea69e34b21645da5eaf7d" style="vertical-align: -1.005ex; width:15.394ex; height:3.009ex;"/></span>
        <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle x_{j-1}\leftarrow s_{z_{j-1}}}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mo>−<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">←<!-- ← --></mo>
        <msub>
          <mi>s</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>z</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>j</mi>
                <mo>−<!-- − --></mo>
                <mn>1</mn>
              </mrow>
            </msub>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle x_{j-1}\leftarrow s_{z_{j-1}}}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle x_{j-1}\leftarrow s_{z_{j-1}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f460f11c4c6becc6e9bd08457978fc89deef3bec" style="vertical-align: -1.171ex; width:12.461ex; height:2.676ex;"/></span>
    <b>end for</b>
    <b>return</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle X}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>X</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle X}</annotation>
  </semantics>
</math></span><img alt="X" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/68baa052181f707c662844a465bfeeb135e82bab" style="vertical-align: -0.338ex; width:1.98ex; height:2.176ex;"/></span>
<b>end function</b>
</pre>
<p>Restated in a succinct near-Python:
</p>
<pre><b>function</b> <i>viterbi</i><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle (O,S,\Pi ,Tm,Em):best\_path}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo stretchy="false">(</mo>
        <mi>O</mi>
        <mo>,</mo>
        <mi>S</mi>
        <mo>,</mo>
        <mi mathvariant="normal">Π<!-- Π --></mi>
        <mo>,</mo>
        <mi>T</mi>
        <mi>m</mi>
        <mo>,</mo>
        <mi>E</mi>
        <mi>m</mi>
        <mo stretchy="false">)</mo>
        <mo>:</mo>
        <mi>b</mi>
        <mi>e</mi>
        <mi>s</mi>
        <mi>t</mi>
        <mi mathvariant="normal">_<!-- _ --></mi>
        <mi>p</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mi>h</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle (O,S,\Pi ,Tm,Em):best\_path}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle (O,S,\Pi ,Tm,Em):best\_path}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/70873fd6fc61d7ec8e90453895e3b1f1207720fa" style="vertical-align: -0.838ex; width:30.142ex; height:2.843ex;"/></span>   Tm: transition matrix   Em: emission matrix
    <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle trellis\leftarrow matrix(length(S),length(O))}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>t</mi>
        <mi>r</mi>
        <mi>e</mi>
        <mi>l</mi>
        <mi>l</mi>
        <mi>i</mi>
        <mi>s</mi>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>m</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mi>r</mi>
        <mi>i</mi>
        <mi>x</mi>
        <mo stretchy="false">(</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>O</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle trellis\leftarrow matrix(length(S),length(O))}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle trellis\leftarrow matrix(length(S),length(O))}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7e9f04b766776d32c05dd9f05111e09135a4c961" style="vertical-align: -0.838ex; width:39.822ex; height:2.843ex;"/></span>      To hold probability of each state given each observation
    <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle pointers\leftarrow matrix(length(S),length(O))}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>p</mi>
        <mi>o</mi>
        <mi>i</mi>
        <mi>n</mi>
        <mi>t</mi>
        <mi>e</mi>
        <mi>r</mi>
        <mi>s</mi>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>m</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mi>r</mi>
        <mi>i</mi>
        <mi>x</mi>
        <mo stretchy="false">(</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>O</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle pointers\leftarrow matrix(length(S),length(O))}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle pointers\leftarrow matrix(length(S),length(O))}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2e69b73f32a60b7d2075ce9405451ddd6ac0a0dc" style="vertical-align: -0.838ex; margin-left: -0.089ex; width:42.217ex; height:2.843ex;"/></span>    To hold backpointer to best prior state
    <b>for</b> s <b>in</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle range(length(S))}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>r</mi>
        <mi>a</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>e</mi>
        <mo stretchy="false">(</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle range(length(S))}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle range(length(S))}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/737be4e668afa45ebf207bd3bce0737a28db064e" style="vertical-align: -0.838ex; width:17.457ex; height:2.843ex;"/></span>:                Determine each hidden state's probability at time 0…
        <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle trellis[s,0]\leftarrow \Pi [s]\cdot Em[s,O[0]]}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>t</mi>
        <mi>r</mi>
        <mi>e</mi>
        <mi>l</mi>
        <mi>l</mi>
        <mi>i</mi>
        <mi>s</mi>
        <mo stretchy="false">[</mo>
        <mi>s</mi>
        <mo>,</mo>
        <mn>0</mn>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi mathvariant="normal">Π<!-- Π --></mi>
        <mo stretchy="false">[</mo>
        <mi>s</mi>
        <mo stretchy="false">]</mo>
        <mo>⋅<!-- ⋅ --></mo>
        <mi>E</mi>
        <mi>m</mi>
        <mo stretchy="false">[</mo>
        <mi>s</mi>
        <mo>,</mo>
        <mi>O</mi>
        <mo stretchy="false">[</mo>
        <mn>0</mn>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle trellis[s,0]\leftarrow \Pi [s]\cdot Em[s,O[0]]}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle trellis[s,0]\leftarrow \Pi [s]\cdot Em[s,O[0]]}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d87680260bbaee603744a66cb355c7ad87d1639d" style="vertical-align: -0.838ex; width:31.716ex; height:2.843ex;"/></span>
    <b>for</b> o <b>in</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle range(1,length(O))}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>r</mi>
        <mi>a</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>e</mi>
        <mo stretchy="false">(</mo>
        <mn>1</mn>
        <mo>,</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>O</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle range(1,length(O))}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle range(1,length(O))}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aca9d4622acf6e314deaac13e0e533aab6463ec6" style="vertical-align: -0.838ex; width:19.927ex; height:2.843ex;"/></span>:              …and after, tracking each state's most likely prior state, k
        <b>for</b> s <b>in</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle range(length(S))}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>r</mi>
        <mi>a</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>e</mi>
        <mo stretchy="false">(</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>S</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle range(length(S))}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle range(length(S))}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/737be4e668afa45ebf207bd3bce0737a28db064e" style="vertical-align: -0.838ex; width:17.457ex; height:2.843ex;"/></span>:
            <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k\leftarrow \arg \max(k\ {\mathsf {in}}\ trellis[k,o-1]\cdot Tm[k,s]\cdot Em[s,o])}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>arg</mi>
        <mo>⁡<!-- ⁡ --></mo>
        <mo form="prefix" movablelimits="true">max</mo>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mtext> </mtext>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="sans-serif">i</mi>
            <mi mathvariant="sans-serif">n</mi>
          </mrow>
        </mrow>
        <mtext> </mtext>
        <mi>t</mi>
        <mi>r</mi>
        <mi>e</mi>
        <mi>l</mi>
        <mi>l</mi>
        <mi>i</mi>
        <mi>s</mi>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo>,</mo>
        <mi>o</mi>
        <mo>−<!-- − --></mo>
        <mn>1</mn>
        <mo stretchy="false">]</mo>
        <mo>⋅<!-- ⋅ --></mo>
        <mi>T</mi>
        <mi>m</mi>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo>,</mo>
        <mi>s</mi>
        <mo stretchy="false">]</mo>
        <mo>⋅<!-- ⋅ --></mo>
        <mi>E</mi>
        <mi>m</mi>
        <mo stretchy="false">[</mo>
        <mi>s</mi>
        <mo>,</mo>
        <mi>o</mi>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k\leftarrow \arg \max(k\ {\mathsf {in}}\ trellis[k,o-1]\cdot Tm[k,s]\cdot Em[s,o])}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle k\leftarrow \arg \max(k\ {\mathsf {in}}\ trellis[k,o-1]\cdot Tm[k,s]\cdot Em[s,o])}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ed718cbeaf00678ca11b24d2f78486f7231b2659" style="vertical-align: -0.838ex; width:53.661ex; height:2.843ex;"/></span>
            <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle trellis[s,o]\leftarrow trellis[k,o-1]\cdot Tm[k,s]\cdot Em[s,o]}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>t</mi>
        <mi>r</mi>
        <mi>e</mi>
        <mi>l</mi>
        <mi>l</mi>
        <mi>i</mi>
        <mi>s</mi>
        <mo stretchy="false">[</mo>
        <mi>s</mi>
        <mo>,</mo>
        <mi>o</mi>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>t</mi>
        <mi>r</mi>
        <mi>e</mi>
        <mi>l</mi>
        <mi>l</mi>
        <mi>i</mi>
        <mi>s</mi>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo>,</mo>
        <mi>o</mi>
        <mo>−<!-- − --></mo>
        <mn>1</mn>
        <mo stretchy="false">]</mo>
        <mo>⋅<!-- ⋅ --></mo>
        <mi>T</mi>
        <mi>m</mi>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo>,</mo>
        <mi>s</mi>
        <mo stretchy="false">]</mo>
        <mo>⋅<!-- ⋅ --></mo>
        <mi>E</mi>
        <mi>m</mi>
        <mo stretchy="false">[</mo>
        <mi>s</mi>
        <mo>,</mo>
        <mi>o</mi>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle trellis[s,o]\leftarrow trellis[k,o-1]\cdot Tm[k,s]\cdot Em[s,o]}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle trellis[s,o]\leftarrow trellis[k,o-1]\cdot Tm[k,s]\cdot Em[s,o]}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/692aeacfb7819a0e7a9f2a1897f41d0a3b81f325" style="vertical-align: -0.838ex; width:49.357ex; height:2.843ex;"/></span>
            <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle pointers[s,o]\leftarrow k}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>p</mi>
        <mi>o</mi>
        <mi>i</mi>
        <mi>n</mi>
        <mi>t</mi>
        <mi>e</mi>
        <mi>r</mi>
        <mi>s</mi>
        <mo stretchy="false">[</mo>
        <mi>s</mi>
        <mo>,</mo>
        <mi>o</mi>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>k</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle pointers[s,o]\leftarrow k}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle pointers[s,o]\leftarrow k}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ce8d2b1529430772dcf960945c71b7ee4fbd478a" style="vertical-align: -0.838ex; margin-left: -0.089ex; width:18.017ex; height:2.843ex;"/></span>
    <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle best\_path\leftarrow list()}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>b</mi>
        <mi>e</mi>
        <mi>s</mi>
        <mi>t</mi>
        <mi mathvariant="normal">_<!-- _ --></mi>
        <mi>p</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>l</mi>
        <mi>i</mi>
        <mi>s</mi>
        <mi>t</mi>
        <mo stretchy="false">(</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle best\_path\leftarrow list()}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle best\_path\leftarrow list()}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/665915c3caff4ad8beeb254b89ca4ab6872d623d" style="vertical-align: -0.838ex; width:18.601ex; height:2.843ex;"/></span>
    <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k\leftarrow \arg \max(k\ {\mathsf {in}}\ trellis[k,length(O)-1])}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>arg</mi>
        <mo>⁡<!-- ⁡ --></mo>
        <mo form="prefix" movablelimits="true">max</mo>
        <mo stretchy="false">(</mo>
        <mi>k</mi>
        <mtext> </mtext>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="sans-serif">i</mi>
            <mi mathvariant="sans-serif">n</mi>
          </mrow>
        </mrow>
        <mtext> </mtext>
        <mi>t</mi>
        <mi>r</mi>
        <mi>e</mi>
        <mi>l</mi>
        <mi>l</mi>
        <mi>i</mi>
        <mi>s</mi>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo>,</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>O</mi>
        <mo stretchy="false">)</mo>
        <mo>−<!-- − --></mo>
        <mn>1</mn>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k\leftarrow \arg \max(k\ {\mathsf {in}}\ trellis[k,length(O)-1])}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle k\leftarrow \arg \max(k\ {\mathsf {in}}\ trellis[k,length(O)-1])}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e702e13d3bb7c1d688f1e6a0f62af1e14b1fbc9e" style="vertical-align: -0.838ex; width:42.556ex; height:2.843ex;"/></span>    Find k of best final state
    <b>for</b> o <b>in</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle range(length(O)-1,-1,-1)}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>r</mi>
        <mi>a</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>e</mi>
        <mo stretchy="false">(</mo>
        <mi>l</mi>
        <mi>e</mi>
        <mi>n</mi>
        <mi>g</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo stretchy="false">(</mo>
        <mi>O</mi>
        <mo stretchy="false">)</mo>
        <mo>−<!-- − --></mo>
        <mn>1</mn>
        <mo>,</mo>
        <mo>−<!-- − --></mo>
        <mn>1</mn>
        <mo>,</mo>
        <mo>−<!-- − --></mo>
        <mn>1</mn>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle range(length(O)-1,-1,-1)}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle range(length(O)-1,-1,-1)}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/75cf60c62c2d631f44bf012b2387e787369e41c5" style="vertical-align: -0.838ex; width:29.743ex; height:2.843ex;"/></span>:      Backtrack from last observation
        <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle best\_path.insert(0,S[k])}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>b</mi>
        <mi>e</mi>
        <mi>s</mi>
        <mi>t</mi>
        <mi mathvariant="normal">_<!-- _ --></mi>
        <mi>p</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mi>h</mi>
        <mo>.</mo>
        <mi>i</mi>
        <mi>n</mi>
        <mi>s</mi>
        <mi>e</mi>
        <mi>r</mi>
        <mi>t</mi>
        <mo stretchy="false">(</mo>
        <mn>0</mn>
        <mo>,</mo>
        <mi>S</mi>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo stretchy="false">]</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle best\_path.insert(0,S[k])}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle best\_path.insert(0,S[k])}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2c3865bd32e636e4d0f2f679dd365d657f30127e" style="vertical-align: -0.838ex; width:25.055ex; height:2.843ex;"/></span>                Insert previous state on most likely path
        <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k\leftarrow pointers[k,o]}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo stretchy="false">←<!-- ← --></mo>
        <mi>p</mi>
        <mi>o</mi>
        <mi>i</mi>
        <mi>n</mi>
        <mi>t</mi>
        <mi>e</mi>
        <mi>r</mi>
        <mi>s</mi>
        <mo stretchy="false">[</mo>
        <mi>k</mi>
        <mo>,</mo>
        <mi>o</mi>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k\leftarrow pointers[k,o]}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle k\leftarrow pointers[k,o]}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/db4c7b65bfb62714dc88991bf8dccc1f0f194cdc" style="vertical-align: -0.838ex; width:18.048ex; height:2.843ex;"/></span>                      Use backpointer to find best previous state
    <b>return</b> <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle best\_path}" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>b</mi>
        <mi>e</mi>
        <mi>s</mi>
        <mi>t</mi>
        <mi mathvariant="normal">_<!-- _ --></mi>
        <mi>p</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mi>h</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle best\_path}</annotation>
  </semantics>
</math></span><img alt="{\displaystyle best\_path}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/472c92d71612c5983cc6145d23017f6d36ee099b" style="vertical-align: -0.671ex; width:9.751ex; height:2.509ex;"/></span>
</pre>
<dl><dt>Explanation</dt>
<dd></dd></dl>
<p>Suppose we are given a hidden Markov model (HMM) with state space <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle S}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>S</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle S}</annotation>
</semantics>
</math></span><img alt="S" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4611d85173cd3b508e67077d4a1252c9c05abca2" style="vertical-align: -0.338ex; width:1.499ex; height:2.176ex;"/></span>, initial probabilities <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \pi _{i}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>π<!-- π --></mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \pi _{i}}</annotation>
</semantics>
</math></span><img alt="\pi _{i}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/51bb06f24c5ba78c53df3a04cb60ba05ef6f08aa" style="vertical-align: -0.671ex; width:2.125ex; height:2.009ex;"/></span> of being in state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle i}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>i</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle i}</annotation>
</semantics>
</math></span><img alt="i" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/add78d8608ad86e54951b8c8bd6c8d8416533d20" style="vertical-align: -0.338ex; width:0.802ex; height:2.176ex;"/></span> and transition probabilities <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle a_{i,j}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>a</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>i</mi>
<mo>,</mo>
<mi>j</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle a_{i,j}}</annotation>
</semantics>
</math></span><img alt="a_{i,j}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4bb5a346f58c6568306a02596dd318d1b7e6b2c2" style="vertical-align: -1.005ex; width:3.164ex; height:2.343ex;"/></span> of transitioning from state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle i}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>i</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle i}</annotation>
</semantics>
</math></span><img alt="i" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/add78d8608ad86e54951b8c8bd6c8d8416533d20" style="vertical-align: -0.338ex; width:0.802ex; height:2.176ex;"/></span> to state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle j}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>j</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle j}</annotation>
</semantics>
</math></span><img alt="j" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2f461e54f5c093e92a55547b9764291390f0b5d0" style="vertical-align: -0.671ex; margin-left: -0.027ex; width:0.985ex; height:2.509ex;"/></span>.  Say, we observe outputs <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle y_{1},\dots ,y_{T}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle y_{1},\dots ,y_{T}}</annotation>
</semantics>
</math></span><img alt="y_{1},\dots ,y_{T}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7d24bf8d8b9d716215e5d4576a1ffed79c8e095c" style="vertical-align: -0.671ex; width:9.9ex; height:2.009ex;"/></span>.  The most likely state sequence <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle x_{1},\dots ,x_{T}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle x_{1},\dots ,x_{T}}</annotation>
</semantics>
</math></span><img alt="x_{1},\dots ,x_{T}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/08e2c7bd5aec0a33f7ada1d5ca2787851babbda9" style="vertical-align: -0.671ex; width:10.281ex; height:2.009ex;"/></span> that produces the observations is given by the recurrence relations<sup class="reference" id="cite_ref-10">[10]</sup>
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\begin{aligned}V_{1,k}&amp;=\mathrm {P} {\big (}y_{1}\ |\ k{\big )}\cdot \pi _{k},\\V_{t,k}&amp;=\max _{x\in S}\left(\mathrm {P} {\big (}y_{t}\ |\ k{\big )}\cdot a_{x,k}\cdot V_{t-1,x}\right).\end{aligned}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt">
<mtr>
<mtd>
<msub>
<mi>V</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
<mo>,</mo>
<mi>k</mi>
</mrow>
</msub>
</mtd>
<mtd>
<mi></mi>
<mo>=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="normal">P</mi>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mo maxsize="1.2em" minsize="1.2em">(</mo>
</mrow>
</mrow>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mtext> </mtext>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mtext> </mtext>
<mi>k</mi>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mo maxsize="1.2em" minsize="1.2em">)</mo>
</mrow>
</mrow>
<mo>⋅<!-- ⋅ --></mo>
<msub>
<mi>π<!-- π --></mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>k</mi>
</mrow>
</msub>
<mo>,</mo>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mi>V</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
<mo>,</mo>
<mi>k</mi>
</mrow>
</msub>
</mtd>
<mtd>
<mi></mi>
<mo>=</mo>
<munder>
<mo form="prefix" movablelimits="true">max</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi>x</mi>
<mo>∈<!-- ∈ --></mo>
<mi>S</mi>
</mrow>
</munder>
<mrow>
<mo>(</mo>
<mrow>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="normal">P</mi>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mo maxsize="1.2em" minsize="1.2em">(</mo>
</mrow>
</mrow>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
</mrow>
</msub>
<mtext> </mtext>
<mrow class="MJX-TeXAtom-ORD">
<mo stretchy="false">|</mo>
</mrow>
<mtext> </mtext>
<mi>k</mi>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mo maxsize="1.2em" minsize="1.2em">)</mo>
</mrow>
</mrow>
<mo>⋅<!-- ⋅ --></mo>
<msub>
<mi>a</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>x</mi>
<mo>,</mo>
<mi>k</mi>
</mrow>
</msub>
<mo>⋅<!-- ⋅ --></mo>
<msub>
<mi>V</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
<mo>,</mo>
<mi>x</mi>
</mrow>
</msub>
</mrow>
<mo>)</mo>
</mrow>
<mo>.</mo>
</mtd>
</mtr>
</mtable>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}V_{1,k}&amp;=\mathrm {P} {\big (}y_{1}\ |\ k{\big )}\cdot \pi _{k},\\V_{t,k}&amp;=\max _{x\in S}\left(\mathrm {P} {\big (}y_{t}\ |\ k{\big )}\cdot a_{x,k}\cdot V_{t-1,x}\right).\end{aligned}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\begin{aligned}V_{1,k}&amp;=\mathrm {P} {\big (}y_{1}\ |\ k{\big )}\cdot \pi _{k},\\V_{t,k}&amp;=\max _{x\in S}\left(\mathrm {P} {\big (}y_{t}\ |\ k{\big )}\cdot a_{x,k}\cdot V_{t-1,x}\right).\end{aligned}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c2012f7259918f84847ef9402d73a900efc193c8" style="vertical-align: -3.338ex; width:36.901ex; height:7.843ex;"/></span></dd></dl>
<p>Here <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle V_{t,k}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>V</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
<mo>,</mo>
<mi>k</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle V_{t,k}}</annotation>
</semantics>
</math></span><img alt="V_{t,k}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7be8fa17abc5dd1cb546e5482b36ac793767dad1" style="vertical-align: -1.005ex; width:3.495ex; height:2.843ex;"/></span> is the probability of the most probable state sequence <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \mathrm {P} {\big (}x_{1},\dots ,x_{t},y_{1},\dots ,y_{t}{\big )}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="normal">P</mi>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mo maxsize="1.2em" minsize="1.2em">(</mo>
</mrow>
</mrow>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
</mrow>
</msub>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mn>1</mn>
</mrow>
</msub>
<mo>,</mo>
<mo>…<!-- … --></mo>
<mo>,</mo>
<msub>
<mi>y</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
</mrow>
</msub>
<mrow class="MJX-TeXAtom-ORD">
<mrow class="MJX-TeXAtom-ORD">
<mo maxsize="1.2em" minsize="1.2em">)</mo>
</mrow>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \mathrm {P} {\big (}x_{1},\dots ,x_{t},y_{1},\dots ,y_{t}{\big )}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle \mathrm {P} {\big (}x_{1},\dots ,x_{t},y_{1},\dots ,y_{t}{\big )}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0d7a803d739b769bd8ad5176e53137cc46349939" style="vertical-align: -1.005ex; width:23.801ex; height:3.176ex;"/></span> responsible for the first <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle t}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>t</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle t}</annotation>
</semantics>
</math></span><img alt="t" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/65658b7b223af9e1acc877d848888ecdb4466560" style="vertical-align: -0.338ex; width:0.84ex; height:2.009ex;"/></span> observations that have <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k}</annotation>
</semantics>
</math></span><img alt="k" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;"/></span> as its final state.  The Viterbi path can be retrieved by saving back pointers that remember which state <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle x}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>x</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle x}</annotation>
</semantics>
</math></span><img alt="x" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/87f9e315fd7e2ba406057a97300593c4802b53e4" style="vertical-align: -0.338ex; width:1.33ex; height:1.676ex;"/></span> was used in the second equation.  Let <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle \mathrm {Ptr} (k,t)}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="normal">P</mi>
<mi mathvariant="normal">t</mi>
<mi mathvariant="normal">r</mi>
</mrow>
<mo stretchy="false">(</mo>
<mi>k</mi>
<mo>,</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle \mathrm {Ptr} (k,t)}</annotation>
</semantics>
</math></span><img alt="\mathrm {Ptr} (k,t)" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9f779b4ac247ccd0287e50f2a2a11147f5b94083" style="vertical-align: -0.838ex; width:8.293ex; height:2.843ex;"/></span> be the function that returns the value of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle x}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>x</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle x}</annotation>
</semantics>
</math></span><img alt="x" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/87f9e315fd7e2ba406057a97300593c4802b53e4" style="vertical-align: -0.338ex; width:1.33ex; height:1.676ex;"/></span> used to compute <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle V_{t,k}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<msub>
<mi>V</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
<mo>,</mo>
<mi>k</mi>
</mrow>
</msub>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle V_{t,k}}</annotation>
</semantics>
</math></span><img alt="V_{t,k}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7be8fa17abc5dd1cb546e5482b36ac793767dad1" style="vertical-align: -1.005ex; width:3.495ex; height:2.843ex;"/></span> if <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle t&gt;1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>t</mi>
<mo>&gt;</mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle t&gt;1}</annotation>
</semantics>
</math></span><img alt="t&gt;1" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/730f3de856e6f8850f89a9b990cfc7f7ba7c28bf" style="vertical-align: -0.338ex; width:5.101ex; height:2.176ex;"/></span>, or <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k}</annotation>
</semantics>
</math></span><img alt="k" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;"/></span> if <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle t=1}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>t</mi>
<mo>=</mo>
<mn>1</mn>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle t=1}</annotation>
</semantics>
</math></span><img alt="t=1" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/970dea4a5f5ec5355c4cdd62f6396fbc8b1baaa1" style="vertical-align: -0.338ex; width:5.101ex; height:2.176ex;"/></span>.  Then
</p>
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle {\begin{aligned}x_{T}&amp;=\arg \max _{x\in S}(V_{T,x}),\\x_{t-1}&amp;=\mathrm {Ptr} (x_{t},t).\end{aligned}}}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mrow class="MJX-TeXAtom-ORD">
<mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt">
<mtr>
<mtd>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
</mrow>
</msub>
</mtd>
<mtd>
<mi></mi>
<mo>=</mo>
<mi>arg</mi>
<mo>⁡<!-- ⁡ --></mo>
<munder>
<mo form="prefix" movablelimits="true">max</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi>x</mi>
<mo>∈<!-- ∈ --></mo>
<mi>S</mi>
</mrow>
</munder>
<mo stretchy="false">(</mo>
<msub>
<mi>V</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>T</mi>
<mo>,</mo>
<mi>x</mi>
</mrow>
</msub>
<mo stretchy="false">)</mo>
<mo>,</mo>
</mtd>
</mtr>
<mtr>
<mtd>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
<mo>−<!-- − --></mo>
<mn>1</mn>
</mrow>
</msub>
</mtd>
<mtd>
<mi></mi>
<mo>=</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi mathvariant="normal">P</mi>
<mi mathvariant="normal">t</mi>
<mi mathvariant="normal">r</mi>
</mrow>
<mo stretchy="false">(</mo>
<msub>
<mi>x</mi>
<mrow class="MJX-TeXAtom-ORD">
<mi>t</mi>
</mrow>
</msub>
<mo>,</mo>
<mi>t</mi>
<mo stretchy="false">)</mo>
<mo>.</mo>
</mtd>
</mtr>
</mtable>
</mrow>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}x_{T}&amp;=\arg \max _{x\in S}(V_{T,x}),\\x_{t-1}&amp;=\mathrm {Ptr} (x_{t},t).\end{aligned}}}</annotation>
</semantics>
</math></span><img alt="{\displaystyle {\begin{aligned}x_{T}&amp;=\arg \max _{x\in S}(V_{T,x}),\\x_{t-1}&amp;=\mathrm {Ptr} (x_{t},t).\end{aligned}}}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/064209b2fd203e744942c6b12b57c9b15d0a6b51" style="vertical-align: -3.171ex; width:22.654ex; height:7.509ex;"/></span></dd></dl>
<p>Here we're using the standard definition of arg max.
</p><p>The complexity of this implementation is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(T\times \left|{S}\right|^{2})}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>T</mi>
<mo>×<!-- × --></mo>
<msup>
<mrow>
<mo>|</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi>S</mi>
</mrow>
<mo>|</mo>
</mrow>
<mrow class="MJX-TeXAtom-ORD">
<mn>2</mn>
</mrow>
</msup>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(T\times \left|{S}\right|^{2})}</annotation>
</semantics>
</math></span><img alt="O(T\times \left|{S}\right|^{2})" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/beee12098b9ff184ac5fb053dc61eb322eea6b2f" style="vertical-align: -0.838ex; width:11.906ex; height:3.343ex;"/></span>. A better estimation exists if the maximum in the internal loop is instead found by iterating only over states that directly link to the current state (i.e. there is an edge from <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle k}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>k</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle k}</annotation>
</semantics>
</math></span><img alt="k" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;"/></span> to <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle j}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>j</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle j}</annotation>
</semantics>
</math></span><img alt="j" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2f461e54f5c093e92a55547b9764291390f0b5d0" style="vertical-align: -0.671ex; margin-left: -0.027ex; width:0.985ex; height:2.509ex;"/></span>). Then using amortized analysis one can show that the complexity is <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle O(T\times (\left|{S}\right|+\left|{E}\right|))}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>O</mi>
<mo stretchy="false">(</mo>
<mi>T</mi>
<mo>×<!-- × --></mo>
<mo stretchy="false">(</mo>
<mrow>
<mo>|</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi>S</mi>
</mrow>
<mo>|</mo>
</mrow>
<mo>+</mo>
<mrow>
<mo>|</mo>
<mrow class="MJX-TeXAtom-ORD">
<mi>E</mi>
</mrow>
<mo>|</mo>
</mrow>
<mo stretchy="false">)</mo>
<mo stretchy="false">)</mo>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle O(T\times (\left|{S}\right|+\left|{E}\right|))}</annotation>
</semantics>
</math></span><img alt="{\displaystyle O(T\times (\left|{S}\right|+\left|{E}\right|))}" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3498e4e3a96ef7e9d657f31c3f7bf88aa39bec93" style="vertical-align: -0.838ex; width:18.571ex; height:2.843ex;"/></span>, where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math alttext="{\displaystyle E}" xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow class="MJX-TeXAtom-ORD">
<mstyle displaystyle="true" scriptlevel="0">
<mi>E</mi>
</mstyle>
</mrow>
<annotation encoding="application/x-tex">{\displaystyle E}</annotation>
</semantics>
</math></span><img alt="E" aria-hidden="true" class="mwe-math-fallback-image-inline" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4232c9de2ee3eec0a9c0a19b15ab92daa6223f9b" style="vertical-align: -0.338ex; width:1.776ex; height:2.176ex;"/></span> is the number of edges in the graph.
</p>
<h2><span class="mw-headline" id="Example">Example</span><span class="mw-editsection"></span></h2>
<p>Consider a village where all villagers are either healthy or have a fever, and only the village doctor can determine whether each has a fever. The doctor diagnoses fever by asking patients how they feel. The villagers may only answer that they feel normal, dizzy, or cold.
</p><p>The doctor believes that the health condition of the patients operates as a discrete Markov chain. There are two states, "Healthy" and "Fever", but the doctor cannot observe them directly; they are <i>hidden</i> from the doctor. On each day, there is a certain chance that a patient will tell the doctor "I feel normal", "I feel cold", or "I feel dizzy", depending on the patient's health condition.
</p><p>The <i>observations</i> (normal, cold, dizzy) along with a <i>hidden</i> state (healthy, fever) form a hidden Markov model (HMM), and can be represented as follows in the Python programming language:
</p>

<p>In this piece of code, <code>start_p</code> represents the doctor's belief about which state the HMM is in when the patient first visits (all the doctor knows is that the patient tends to be healthy). The particular probability distribution used here is not the equilibrium one, which is (given the transition probabilities) approximately <code>{'Healthy': 0.57, 'Fever': 0.43}</code>. The <code>transition_p</code> represents the change of the health condition in the underlying Markov chain. In this example, a patient who is healthy today has only a 30% chance of having a fever tomorrow. The <code>emit_p</code> represents how likely each possible observation (normal, cold, or dizzy) is, given the underlying condition (healthy or fever). A patient who is healthy has a 50% chance of feeling normal; one who has a fever has a 60% chance of feeling dizzy.
</p>

<p>A patient visits three days in a row, and the doctor discovers that the patient feels normal on the first day, cold on the second day, and dizzy on the third day. The doctor has a question: what is the most likely sequence of health conditions of the patient that would explain these observations? This is answered by the Viterbi algorithm.
</p>

<p>The function <code>viterbi</code> takes the following arguments: <code>obs</code> is the sequence of observations, e.g. <code>['normal', 'cold', 'dizzy']</code>; <code>states</code> is the set of hidden states; <code>start_p</code> is the start probability; <code>trans_p</code> are the transition probabilities; and <code>emit_p</code> are the emission probabilities.  For simplicity of code, we assume that the observation sequence <code>obs</code> is non-empty and that  <code>trans_p[i] [j]</code> and <code>emit_p[i] [j]</code> is defined for all states i,j.
</p><p>In the running example, the forward/Viterbi algorithm is used as follows:
</p>

<p>The output of the script is
</p>

<p>This reveals that the observations <code>['normal', 'cold', 'dizzy']</code> were most likely generated by states <code>['Healthy', 'Healthy', 'Fever']</code>. In other words, given the observed activities, the patient was most likely to have been healthy on the first day and also on the second day (despite feeling cold that day), and only to have contracted a fever on the third day.
</p><p>The operation of Viterbi's algorithm can be visualized by means of a
trellis diagram. The Viterbi path is essentially the shortest
path through this trellis.
</p>
<h2><span class="mw-headline" id="Soft_output_Viterbi_algorithm">Soft output Viterbi algorithm</span><span class="mw-editsection"></span></h2>
<p>The <b>soft output Viterbi algorithm</b> (<b>SOVA</b>) is a variant of the classical Viterbi algorithm.
</p><p>SOVA differs from the classical Viterbi algorithm in that it uses a modified path metric which takes into account the <i>a priori probabilities</i> of the input symbols, and produces a <i>soft</i> output indicating the <i>reliability</i> of the decision.
</p><p>The first step in the SOVA is the selection of the survivor path, passing through one unique node at each time instant, <i>t</i>. Since each node has 2 branches converging at it (with one branch being chosen to form the <i>Survivor Path</i>, and the other being discarded), the difference in the branch metrics (or <i>cost</i>) between the chosen and discarded branches indicate the <i>amount of error</i> in the choice.
</p><p>This <i>cost</i> is accumulated over the entire sliding window (usually equals <i>at least</i> five constraint lengths), to indicate the <i>soft output</i> measure of reliability of the <i>hard bit decision</i> of the Viterbi algorithm.
</p>
<h2><span class="mw-headline" id="See_also">See also</span><span class="mw-editsection"></span></h2>
<ul><li>Expectation–maximization algorithm</li>
<li>Baum–Welch algorithm</li>
<li>Forward-backward algorithm</li>
<li>Forward algorithm</li>
<li>Error-correcting code</li>
<li>Viterbi decoder</li>
<li>Hidden Markov model</li>
<li>Part-of-speech tagging</li>
<li>A* search algorithm</li></ul>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"></span></h2>
<style data-mw-deduplicate="TemplateStyles:r1011085734">.mw-parser-output .reflist{font-size:90%;margin-bottom:0.5em;list-style-type:decimal}.mw-parser-output .reflist .references{font-size:100%;margin-bottom:0;list-style-type:inherit}.mw-parser-output .reflist-columns-2{column-width:30em}.mw-parser-output .reflist-columns-3{column-width:25em}.mw-parser-output .reflist-columns{margin-top:0.3em}.mw-parser-output .reflist-columns ol{margin-top:0}.mw-parser-output .reflist-columns li{page-break-inside:avoid;break-inside:avoid-column}.mw-parser-output .reflist-upper-alpha{list-style-type:upper-alpha}.mw-parser-output .reflist-upper-roman{list-style-type:upper-roman}.mw-parser-output .reflist-lower-alpha{list-style-type:lower-alpha}.mw-parser-output .reflist-lower-greek{list-style-type:lower-greek}.mw-parser-output .reflist-lower-roman{list-style-type:lower-roman}</style>
<h2><span class="mw-headline" id="General_references">General references</span><span class="mw-editsection"></span></h2>
<ul><li><link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation journal cs1" id="CITEREFViterbi_AJ1967">Viterbi AJ (April 1967). "Error bounds for convolutional codes and an asymptotically optimum decoding algorithm". <i>IEEE Transactions on Information Theory</i>. <b>13</b> (2): 260–269. doi:10.1109/TIT.1967.1054010.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=IEEE+Transactions+on+Information+Theory&amp;rft.atitle=Error+bounds+for+convolutional+codes+and+an+asymptotically+optimum+decoding+algorithm&amp;rft.volume=13&amp;rft.issue=2&amp;rft.pages=260-269&amp;rft.date=1967-04&amp;rft_id=info%3Adoi%2F10.1109%2FTIT.1967.1054010&amp;rft.au=Viterbi+AJ&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AViterbi+algorithm"></span> (note: the Viterbi decoding algorithm is described in section IV.) Subscription required.</li>
<li><link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation book cs1" id="CITEREFFeldmanAbou-FaycalFrigo2002">Feldman J, Abou-Faycal I, Frigo M (2002). "A Fast Maximum-Likelihood Decoder for Convolutional Codes". <i>Proceedings IEEE 56th Vehicular Technology Conference</i>. <i>Vehicular Technology Conference</i>. Vol. 1. pp. 371–375. CiteSeerX <span class="cs1-lock-free" title="Freely accessible">10.1.1.114.1314</span>. doi:10.1109/VETECF.2002.1040367. ISBN <bdi>978-0-7803-7467-6</bdi>. S2CID 9783963.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=bookitem&amp;rft.atitle=A+Fast+Maximum-Likelihood+Decoder+for+Convolutional+Codes&amp;rft.btitle=Proceedings+IEEE+56th+Vehicular+Technology+Conference&amp;rft.pages=371-375&amp;rft.date=2002&amp;rft_id=%2F%2Fciteseerx.ist.psu.edu%2Fviewdoc%2Fsummary%3Fdoi%3D10.1.1.114.1314%23id-name%3DCiteSeerX&amp;rft_id=https%3A%2F%2Fapi.semanticscholar.org%2FCorpusID%3A9783963%23id-name%3DS2CID&amp;rft_id=info%3Adoi%2F10.1109%2FVETECF.2002.1040367&amp;rft.isbn=978-0-7803-7467-6&amp;rft.aulast=Feldman&amp;rft.aufirst=J&amp;rft.au=Abou-Faycal%2C+I&amp;rft.au=Frigo%2C+M&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AViterbi+algorithm"></span></li>
<li><link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation journal cs1" id="CITEREFForney_GD1973">Forney GD (March 1973). "The Viterbi algorithm". <i>Proceedings of the IEEE</i>. <b>61</b> (3): 268–278. doi:10.1109/PROC.1973.9030.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Proceedings+of+the+IEEE&amp;rft.atitle=The+Viterbi+algorithm&amp;rft.volume=61&amp;rft.issue=3&amp;rft.pages=268-278&amp;rft.date=1973-03&amp;rft_id=info%3Adoi%2F10.1109%2FPROC.1973.9030&amp;rft.au=Forney+GD&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AViterbi+algorithm"></span> Subscription required.</li>
<li><link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation book cs1" id="CITEREFPressTeukolskyVetterlingFlannery2007">Press, WH; Teukolsky, SA; Vetterling, WT; Flannery, BP (2007). "Section 16.2. Viterbi Decoding". <i>Numerical Recipes: The Art of Scientific Computing</i> (3rd ed.). New York: Cambridge University Press. ISBN <bdi>978-0-521-88068-8</bdi>.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=bookitem&amp;rft.atitle=Section+16.2.+Viterbi+Decoding&amp;rft.btitle=Numerical+Recipes%3A+The+Art+of+Scientific+Computing&amp;rft.place=New+York&amp;rft.edition=3rd&amp;rft.pub=Cambridge+University+Press&amp;rft.date=2007&amp;rft.isbn=978-0-521-88068-8&amp;rft.aulast=Press&amp;rft.aufirst=WH&amp;rft.au=Teukolsky%2C+SA&amp;rft.au=Vetterling%2C+WT&amp;rft.au=Flannery%2C+BP&amp;rft_id=http%3A%2F%2Fapps.nrbook.com%2Fempanel%2Findex.html%23pg%3D850&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AViterbi+algorithm"></span></li>
<li><link href="mw-data:TemplateStyles:r1067248974" rel="mw-deduplicated-inline-style"/><cite class="citation journal cs1" id="CITEREFRabiner_LR1989">Rabiner LR (February 1989). "A tutorial on hidden Markov models and selected applications in speech recognition". <i>Proceedings of the IEEE</i>. <b>77</b> (2): 257–286. CiteSeerX <span class="cs1-lock-free" title="Freely accessible">10.1.1.381.3454</span>. doi:10.1109/5.18626. S2CID 13618539.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Proceedings+of+the+IEEE&amp;rft.atitle=A+tutorial+on+hidden+Markov+models+and+selected+applications+in+speech+recognition&amp;rft.volume=77&amp;rft.issue=2&amp;rft.pages=257-286&amp;rft.date=1989-02&amp;rft_id=%2F%2Fciteseerx.ist.psu.edu%2Fviewdoc%2Fsummary%3Fdoi%3D10.1.1.381.3454%23id-name%3DCiteSeerX&amp;rft_id=https%3A%2F%2Fapi.semanticscholar.org%2FCorpusID%3A13618539%23id-name%3DS2CID&amp;rft_id=info%3Adoi%2F10.1109%2F5.18626&amp;rft.au=Rabiner+LR&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AViterbi+algorithm"></span> (Describes the forward algorithm and Viterbi algorithm for HMMs).</li>
<li>Shinghal, R. and Godfried T. Toussaint, "Experiments in text recognition with the modified Viterbi algorithm," <i>IEEE Transactions on Pattern Analysis and Machine Intelligence</i>, Vol. PAMI-l, April 1979, pp. 184–193.</li>
<li>Shinghal, R. and Godfried T. Toussaint, "The sensitivity of the modified Viterbi algorithm to the source statistics," <i>IEEE Transactions on Pattern Analysis and Machine Intelligence</i>, vol. PAMI-2, March 1980, pp. 181–185.</li></ul>
<h2><span class="mw-headline" id="External_links">External links</span><span class="mw-editsection"></span></h2>
<ul><li>Implementations in Java, F#, Clojure, C# on Wikibooks</li>
<li>Tutorial on convolutional coding with viterbi decoding, by Chip Fleming</li>
<li>A tutorial for a Hidden Markov Model toolkit (implemented in C) that contains a description of the Viterbi algorithm</li>
<li>Viterbi algorithm by Dr. Andrew J. Viterbi (scholarpedia.org).</li></ul>
<h3><span class="mw-headline" id="Implementations">Implementations</span><span class="mw-editsection"></span></h3>
<ul><li>Mathematica has an implementation as part of its support for stochastic processes</li>
<li>Susa signal processing framework provides the C++ implementation for Forward error correction codes and channel equalization here.</li>
<li>C++</li>
<li>C#</li>
<li>Java</li>
<li>Java 8</li>
<li>Julia (HMMBase.jl)</li>
<li>Perl</li>
<li>Prolog</li>
<li>Haskell</li>
<li>Go</li>
<li>SFIHMM includes code for Viterbi decoding.</li></ul>
<!-- 
NewPP limit report
Parsed by mw2363
Cached time: 20221215224217
Cache expiry: 1814400
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.296 seconds
Real time usage: 0.457 seconds
Preprocessor visited node count: 1502/1000000
Post‐expand include size: 28001/2097152 bytes
Template argument size: 1315/2097152 bytes
Highest expansion depth: 12/100
Expensive parser function count: 5/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 53196/5000000 bytes
Lua time usage: 0.107/10.000 seconds
Lua memory usage: 5798907/52428800 bytes
Number of Wikibase entities loaded: 0/400
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  220.582      1 -total
 48.81%  107.666      1 Template:Reflist
 31.68%   69.881      3 Template:Cite_book
 24.31%   53.618      1 Template:Short_description
 14.54%   32.062      2 Template:Pagetype
 13.52%   29.827      1 Template:Clarify
 11.81%   26.054      1 Template:Fix-span
 10.26%   22.640      5 Template:Cite_journal
  7.68%   16.942      4 Template:Cite_conference
  7.15%   15.770      2 Template:Category_handler
-->
<!-- Saved in parser cache with key enwiki:pcache:idhash:228015-0!canonical and timestamp 20221215224216 and revision id 1126969506.
 -->
</div></body>
</html>