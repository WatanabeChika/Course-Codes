Stirling's_formulaIn mathematics, Stirling's approximation (or Stirling's formula) is an approximation for factorials. It is a good approximation, leading to accurate results even for small values of . It is named after James Stirling, though a related but less precise result was first stated by Abraham de Moivre.[1][2][3]One way of stating the approximation involves the logarithm of the factorial:where the big O notation means that, for all sufficiently large values of , the difference between  and  will be at most proportional to the logarithm. In computer science applications such as the worst-case lower bound for comparison sorting, it is convenient to use instead the binary logarithm, giving the equivalent form The error term in either base can be expressed more precisely as , corresponding to an approximate formula for the factorial itself,Here the sign  means that the two quantities are asymptotic, that is, that their ratio tends to 1 as  tends to infinity. The following version of the bound holds for all , rather than only asymptotically:Roughly speaking, the simplest version of Stirling's formula can be quickly obtained by approximating the sumwith an integral:The full formula, together with precise estimates of its error, can be derived as follows. Instead of approximating , one considers its natural logarithm, as this is a slowly varying function:The right-hand side of this equation minusis the approximation by the trapezoid rule of the integraland the error in this approximation is given by the Euler–Maclaurin formula:where  is a Bernoulli number, and  is the remainder term in the Euler–Maclaurin formula. Take limits to find thatDenote this limit as .  Because the remainder  in the Euler–Maclaurin formula satisfieswhere big-O notation is used, combining the equations above yields the approximation formula in its logarithmic form:Taking the exponential of both sides and choosing any positive integer , one obtains a formula involving an unknown quantity . For , the formula isThe quantity  can be found by taking the limit on both sides as  tends to infinity and using Wallis' product, which shows that . Therefore, one obtains Stirling's formula:An alternative formula for  using the gamma function is(as can be seen by repeated integration by parts). Rewriting and changing variables , one obtainsApplying Laplace's method one haswhich recovers Stirling's formula:In fact, further corrections can also be obtained using Laplace's method. For example, computing two-order expansion using Laplace's method yields (using little-o notation)and gives Stirling's formula to two orders:A complex-analysis version of this method[4] is to consider  as a Taylor coefficient of the exponential function , computed by Cauchy's integral formula asThis line integral can then be approximated using the saddle-point method with an appropriate choice of countour radius . The dominant portion of the integral near the saddle point is then approximated by a real integral and Laplace's method, while the remaining portion of the integral can be bounded above to give an error term.Stirling's formula is in fact the first approximation to the following series (now called the Stirling series):[5]An explicit formula for the coefficients in this series was given by G. Nemes.[6] Further terms are listed in the On-Line Encyclopedia of Integer Sequences as A001163 and A001164. The first graph in this section shows the relative error vs. , for 1 through all 5 terms listed above.As , the error in the truncated series is asymptotically equal to the first omitted term. This is an example of an asymptotic expansion. It is not a convergent series; for any particular value of  there are only so many terms of the series that improve accuracy, after which accuracy worsens.  This is shown in the next graph, which shows the relative error versus the number of terms in the series, for larger numbers of terms. More precisely, let  be the Stirling series to  terms evaluated at .  The graphs show which, when small, is essentially the relative error.Writing Stirling's series in the formit is known that the error in truncating the series is always of the opposite sign and at most the same magnitude as the first omitted term.More precise bounds, due to Robbins,[7] valid for all positive integers  areA looser version of this bound is that  for all .For all positive integers,where  denotes the gamma function.However, the gamma function, unlike the factorial, is more broadly defined for all complex numbers other than non-positive integers; nevertheless, Stirling's formula may still be applied. If , thenRepeated integration by parts giveswhere  is the th Bernoulli number (note that the limit of the sum as  is not convergent, so this formula is just an asymptotic expansion). The formula is valid for  large enough in absolute value, when | &lt; π − ε, where  is positive, with an error term of . The corresponding approximation may now be written:where the expansion is identical to that of Stirling's series above for , except that  is replaced with .[8]A further application of this asymptotic expansion is for complex argument  with constant . See for example the Stirling formula applied in  of the Riemann–Siegel theta function on the straight line  + it.For any positive integer , the following notation is introduced:andThen[9][10]For further information and other error bounds, see the cited papers.Thomas Bayes showed, in a letter to John Canton published by the Royal Society in 1763, that Stirling's formula did not give a convergent series.[11]  Obtaining a convergent version of Stirling's formula entails evaluating Binet's formula:One way to do this is by means of a convergent series of inverted rising exponentials. Ifthenwherewhere  denotes the Stirling numbers of the first kind. From this one obtains a version of Stirling's serieswhich converges when .The approximationand its equivalent formcan be obtained by rearranging Stirling's extended formula and observing a coincidence between the resultant power series and the Taylor series expansion of the hyperbolic sine function. This approximation is good to more than 8 decimal digits for  with a real part greater than 8. Robert H. Windschitl suggested it in 2002 for computing the gamma function with fair accuracy on calculators with limited program or register memory.[12]Gergő Nemes proposed in 2007 an approximation which gives the same number of exact digits as the Windschitl approximation but is much simpler:[13]or equivalently,An alternative approximation for the gamma function stated by Srinivasa Ramanujan (Ramanujan 1988[]) isfor . The equivalent approximation for  has an asymptotic error of  and is given byThe approximation may be made precise by giving paired upper and lower bounds; one such inequality is[14][15][16][17]The formula was first discovered by Abraham de Moivre[2] in the formDe Moivre gave an approximate rational-number expression for the natural logarithm of the constant. Stirling's contribution consisted of showing that the constant is precisely .[3]Lanczos approximationSpouge's approximationAbramowitz, M. &amp; Stegun, I. (2002), Handbook of Mathematical Functions [DEAD LINK]Paris, R. B. &amp; Kaminski, D. (2001), , New York: Cambridge University Press, ISBN 978-0-521-79001-7Whittaker, E. T. &amp; Watson, G. N. (1996), A Course in Modern Analysis (4th ed.), New York: Cambridge University Press, ISBN 978-0-521-58807-2Romik, Dan (2000), "Stirling's approximation for : the ultimate short proof?", The American Mathematical Monthly, 107 (6): 556–557, doi:10.2307/2589351, MR 1767064Li, Yuan-Chuan (July 2006), "A note on an identity of the gamma function and Stirling's formula", Real Analysis Exchange, 32 (1): 267–271, MR 2329236"Stirling_formula", Encyclopedia of Mathematics, EMS Press, 2001 [1994]Peter Luschny, Approximation formulas for the factorial function n!Stirling's approximation at PlanetMath.